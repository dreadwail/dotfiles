"use strict";function _interopDefault(t){return t&&"object"==typeof t&&"default"in t?t.default:t}Object.defineProperty(exports,"__esModule",{value:!0});var vscode=require("vscode"),child_process=_interopDefault(require("child_process")),path$1=require("path"),path$1__default=_interopDefault(path$1),fs=_interopDefault(require("fs")),invariant=_interopDefault(require("assert")),url=_interopDefault(require("url")),EventEmitter=_interopDefault(require("events")),module$1=_interopDefault(require("module")),util=_interopDefault(require("util")),crypto=_interopDefault(require("crypto")),constants=_interopDefault(require("constants")),os=_interopDefault(require("os")),prettier=_interopDefault(require("prettier/standalone")),parserFlow=_interopDefault(require("prettier/parser-flow")),src=function(t){try{return t()}catch(t){}},commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function createCommonjsModule(t,e){return t(e={exports:{}},e.exports),e.exports}var windows=isexe;function checkPathExt(t,e){var r=void 0!==e.pathExt?e.pathExt:process.env.PATHEXT;if(!r)return!0;if(-1!==(r=r.split(";")).indexOf(""))return!0;for(var n=0;n<r.length;n++){var i=r[n].toLowerCase();if(i&&t.substr(-i.length).toLowerCase()===i)return!0}return!1}function checkStat(t,e,r){return!(!t.isSymbolicLink()&&!t.isFile())&&checkPathExt(e,r)}function isexe(t,e,r){fs.stat(t,function(n,i){r(n,!n&&checkStat(i,t,e))})}function sync(t,e){return checkStat(fs.statSync(t),t,e)}isexe.sync=sync;var core,mode=isexe$1;function isexe$1(t,e,r){fs.stat(t,function(t,n){r(t,!t&&checkStat$1(n,e))})}function sync$1(t,e){return checkStat$1(fs.statSync(t),e)}function checkStat$1(t,e){return t.isFile()&&checkMode(t,e)}function checkMode(t,e){var r=t.mode,n=t.uid,i=t.gid,o=void 0!==e.uid?e.uid:process.getuid&&process.getuid(),s=void 0!==e.gid?e.gid:process.getgid&&process.getgid(),a=parseInt("100",8),c=parseInt("010",8);return r&parseInt("001",8)||r&c&&i===s||r&a&&n===o||r&(a|c)&&0===o}isexe$1.sync=sync$1,core="win32"===process.platform||commonjsGlobal.TESTING_WINDOWS?windows:mode;var isexe_1=isexe$2;function isexe$2(t,e,r){if("function"==typeof e&&(r=e,e={}),!r){if("function"!=typeof Promise)throw new TypeError("callback not provided");return new Promise(function(r,n){isexe$2(t,e||{},function(t,e){t?n(t):r(e)})})}core(t,e||{},function(t,n){t&&("EACCES"===t.code||e&&e.ignoreErrors)&&(t=null,n=!1),r(t,n)})}function sync$2(t,e){try{return core.sync(t,e||{})}catch(t){if(e&&e.ignoreErrors||"EACCES"===t.code)return!1;throw t}}isexe$2.sync=sync$2;var which_1=which;which.sync=whichSync;var isWindows="win32"===process.platform||"cygwin"===process.env.OSTYPE||"msys"===process.env.OSTYPE,COLON=isWindows?";":":";function getNotFoundError(t){var e=new Error("not found: "+t);return e.code="ENOENT",e}function getPathInfo(t,e){var r=e.colon||COLON,n=e.path||process.env.PATH||"",i=[""];n=n.split(r);var o="";return isWindows&&(n.unshift(process.cwd()),i=(o=e.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM").split(r),-1!==t.indexOf(".")&&""!==i[0]&&i.unshift("")),(t.match(/\//)||isWindows&&t.match(/\\/))&&(n=[""]),{env:n,ext:i,extExe:o}}function which(t,e,r){"function"==typeof e&&(r=e,e={});var n=getPathInfo(t,e),i=n.env,o=n.ext,s=n.extExe,a=[];!function n(c,u){if(c===u)return e.all&&a.length?r(null,a):r(getNotFoundError(t));var l=i[c];'"'===l.charAt(0)&&'"'===l.slice(-1)&&(l=l.slice(1,-1));var h=path$1__default.join(l,t);!l&&/^\.[\\\/]/.test(t)&&(h=t.slice(0,2)+h),function t(i,l){if(i===l)return n(c+1,u);var p=o[i];isexe_1(h+p,{pathExt:s},function(n,o){if(!n&&o){if(!e.all)return r(null,h+p);a.push(h+p)}return t(i+1,l)})}(0,o.length)}(0,i.length)}function whichSync(t,e){for(var r=getPathInfo(t,e=e||{}),n=r.env,i=r.ext,o=r.extExe,s=[],a=0,c=n.length;a<c;a++){var u=n[a];'"'===u.charAt(0)&&'"'===u.slice(-1)&&(u=u.slice(1,-1));var l=path$1__default.join(u,t);!u&&/^\.[\\\/]/.test(t)&&(l=t.slice(0,2)+l);for(var h=0,p=i.length;h<p;h++){var f=l+i[h];try{if(isexe_1.sync(f,{pathExt:o})){if(!e.all)return f;s.push(f)}}catch(t){}}}if(e.all&&s.length)return s;if(e.nothrow)return null;throw getNotFoundError(t)}var pathKey=t=>{const e=(t=t||{}).env||process.env;return"win32"!==(t.platform||process.platform)?"PATH":Object.keys(e).find(t=>"PATH"===t.toUpperCase())||"Path"};const pathKey$1=pathKey();function resolveCommandAttempt(t,e){const r=process.cwd(),n=null!=t.options.cwd;if(n)try{process.chdir(t.options.cwd)}catch(t){}let i;try{i=which_1.sync(t.command,{path:(t.options.env||process.env)[pathKey$1],pathExt:e?path$1__default.delimiter:void 0})}catch(t){}finally{process.chdir(r)}return i&&(i=path$1__default.resolve(n?t.options.cwd:"",i)),i}function resolveCommand(t){return resolveCommandAttempt(t)||resolveCommandAttempt(t,!0)}var resolveCommand_1=resolveCommand;const metaCharsRegExp=/([()\][%!^"`<>&|;, *?])/g;function escapeCommand(t){return t=t.replace(metaCharsRegExp,"^$1")}function escapeArgument(t,e){return t=(t=`"${t=(t=(t=`${t}`).replace(/(\\*)"/g,'$1$1\\"')).replace(/(\\*)$/,"$1$1")}"`).replace(metaCharsRegExp,"^$1"),e&&(t=t.replace(metaCharsRegExp,"^$1")),t}var command=escapeCommand,argument=escapeArgument,_escape={command:command,argument:argument},shebangRegex=/^#!.*/,shebangCommand=function(t){var e=t.match(shebangRegex);if(!e)return null;var r=e[0].replace(/#! ?/,"").split(" "),n=r[0].split("/").pop(),i=r[1];return"env"===n?i:n+(i?" "+i:"")};function readShebang(t){let e,r;Buffer.alloc?e=Buffer.alloc(150):(e=new Buffer(150)).fill(0);try{r=fs.openSync(t,"r"),fs.readSync(r,e,0,150,0),fs.closeSync(r)}catch(t){}return shebangCommand(e.toString())}var readShebang_1=readShebang,semver=createCommonjsModule(function(t,e){var r;e=t.exports=H,r="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){var t=Array.prototype.slice.call(arguments,0);t.unshift("SEMVER"),console.log.apply(console,t)}:function(){},e.SEMVER_SPEC_VERSION="2.0.0";var n=256,i=Number.MAX_SAFE_INTEGER||9007199254740991,o=e.re=[],s=e.src=[],a=0,c=a++;s[c]="0|[1-9]\\d*";var u=a++;s[u]="[0-9]+";var l=a++;s[l]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var h=a++;s[h]="("+s[c]+")\\.("+s[c]+")\\.("+s[c]+")";var p=a++;s[p]="("+s[u]+")\\.("+s[u]+")\\.("+s[u]+")";var f=a++;s[f]="(?:"+s[c]+"|"+s[l]+")";var b=a++;s[b]="(?:"+s[u]+"|"+s[l]+")";var d=a++;s[d]="(?:-("+s[f]+"(?:\\."+s[f]+")*))";var m=a++;s[m]="(?:-?("+s[b]+"(?:\\."+s[b]+")*))";var v=a++;s[v]="[0-9A-Za-z-]+";var y=a++;s[y]="(?:\\+("+s[v]+"(?:\\."+s[v]+")*))";var _=a++,g="v?"+s[h]+s[d]+"?"+s[y]+"?";s[_]="^"+g+"$";var w="[v=\\s]*"+s[p]+s[m]+"?"+s[y]+"?",S=a++;s[S]="^"+w+"$";var O=a++;s[O]="((?:<|>)?=?)";var x=a++;s[x]=s[u]+"|x|X|\\*";var j=a++;s[j]=s[c]+"|x|X|\\*";var E=a++;s[E]="[v=\\s]*("+s[j]+")(?:\\.("+s[j]+")(?:\\.("+s[j]+")(?:"+s[d]+")?"+s[y]+"?)?)?";var T=a++;s[T]="[v=\\s]*("+s[x]+")(?:\\.("+s[x]+")(?:\\.("+s[x]+")(?:"+s[m]+")?"+s[y]+"?)?)?";var A=a++;s[A]="^"+s[O]+"\\s*"+s[E]+"$";var C=a++;s[C]="^"+s[O]+"\\s*"+s[T]+"$";var k=a++;s[k]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var P=a++;s[P]="(?:~>?)";var R=a++;s[R]="(\\s*)"+s[P]+"\\s+",o[R]=new RegExp(s[R],"g");var $=a++;s[$]="^"+s[P]+s[E]+"$";var N=a++;s[N]="^"+s[P]+s[T]+"$";var I=a++;s[I]="(?:\\^)";var F=a++;s[F]="(\\s*)"+s[I]+"\\s+",o[F]=new RegExp(s[F],"g");var M=a++;s[M]="^"+s[I]+s[E]+"$";var G=a++;s[G]="^"+s[I]+s[T]+"$";var L=a++;s[L]="^"+s[O]+"\\s*("+w+")$|^$";var D=a++;s[D]="^"+s[O]+"\\s*("+g+")$|^$";var U=a++;s[U]="(\\s*)"+s[O]+"\\s*("+w+"|"+s[E]+")",o[U]=new RegExp(s[U],"g");var W=a++;s[W]="^\\s*("+s[E]+")\\s+-\\s+("+s[E]+")\\s*$";var V=a++;s[V]="^\\s*("+s[T]+")\\s+-\\s+("+s[T]+")\\s*$";var B=a++;s[B]="(<|>)?=?\\s*\\*";for(var q=0;q<35;q++)r(q,s[q]),o[q]||(o[q]=new RegExp(s[q]));function z(t,e){if(e&&"object"==typeof e||(e={loose:!!e,includePrerelease:!1}),t instanceof H)return t;if("string"!=typeof t)return null;if(t.length>n)return null;if(!(e.loose?o[S]:o[_]).test(t))return null;try{return new H(t,e)}catch(t){return null}}function H(t,e){if(e&&"object"==typeof e||(e={loose:!!e,includePrerelease:!1}),t instanceof H){if(t.loose===e.loose)return t;t=t.version}else if("string"!=typeof t)throw new TypeError("Invalid Version: "+t);if(t.length>n)throw new TypeError("version is longer than "+n+" characters");if(!(this instanceof H))return new H(t,e);r("SemVer",t,e),this.options=e,this.loose=!!e.loose;var s=t.trim().match(e.loose?o[S]:o[_]);if(!s)throw new TypeError("Invalid Version: "+t);if(this.raw=t,this.major=+s[1],this.minor=+s[2],this.patch=+s[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");s[4]?this.prerelease=s[4].split(".").map(function(t){if(/^[0-9]+$/.test(t)){var e=+t;if(e>=0&&e<i)return e}return t}):this.prerelease=[],this.build=s[5]?s[5].split("."):[],this.format()}e.parse=z,e.valid=function(t,e){var r=z(t,e);return r?r.version:null},e.clean=function(t,e){var r=z(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null},e.SemVer=H,H.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},H.prototype.toString=function(){return this.version},H.prototype.compare=function(t){return r("SemVer.compare",this.version,this.options,t),t instanceof H||(t=new H(t,this.options)),this.compareMain(t)||this.comparePre(t)},H.prototype.compareMain=function(t){return t instanceof H||(t=new H(t,this.options)),K(this.major,t.major)||K(this.minor,t.minor)||K(this.patch,t.patch)},H.prototype.comparePre=function(t){if(t instanceof H||(t=new H(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;var e=0;do{var n=this.prerelease[e],i=t.prerelease[e];if(r("prerelease compare",e,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return K(n,i)}while(++e)},H.prototype.inc=function(t,e){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",e),this.inc("pre",e);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);-1===r&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: "+t)}return this.format(),this.raw=this.version,this},e.inc=function(t,e,r,n){"string"==typeof r&&(n=r,r=void 0);try{return new H(t,r).inc(e,n).version}catch(t){return null}},e.diff=function(t,e){if(Z(t,e))return null;var r=z(t),n=z(e),i="";if(r.prerelease.length||n.prerelease.length){i="pre";var o="prerelease"}for(var s in r)if(("major"===s||"minor"===s||"patch"===s)&&r[s]!==n[s])return i+s;return o},e.compareIdentifiers=K;var Y=/^[0-9]+$/;function K(t,e){var r=Y.test(t),n=Y.test(e);return r&&n&&(t=+t,e=+e),t===e?0:r&&!n?-1:n&&!r?1:t<e?-1:1}function X(t,e,r){return new H(t,r).compare(new H(e,r))}function J(t,e,r){return X(t,e,r)>0}function Q(t,e,r){return X(t,e,r)<0}function Z(t,e,r){return 0===X(t,e,r)}function tt(t,e,r){return 0!==X(t,e,r)}function et(t,e,r){return X(t,e,r)>=0}function rt(t,e,r){return X(t,e,r)<=0}function nt(t,e,r,n){switch(e){case"===":return"object"==typeof t&&(t=t.version),"object"==typeof r&&(r=r.version),t===r;case"!==":return"object"==typeof t&&(t=t.version),"object"==typeof r&&(r=r.version),t!==r;case"":case"=":case"==":return Z(t,r,n);case"!=":return tt(t,r,n);case">":return J(t,r,n);case">=":return et(t,r,n);case"<":return Q(t,r,n);case"<=":return rt(t,r,n);default:throw new TypeError("Invalid operator: "+e)}}function it(t,e){if(e&&"object"==typeof e||(e={loose:!!e,includePrerelease:!1}),t instanceof it){if(t.loose===!!e.loose)return t;t=t.value}if(!(this instanceof it))return new it(t,e);r("comparator",t,e),this.options=e,this.loose=!!e.loose,this.parse(t),this.semver===ot?this.value="":this.value=this.operator+this.semver.version,r("comp",this)}e.rcompareIdentifiers=function(t,e){return K(e,t)},e.major=function(t,e){return new H(t,e).major},e.minor=function(t,e){return new H(t,e).minor},e.patch=function(t,e){return new H(t,e).patch},e.compare=X,e.compareLoose=function(t,e){return X(t,e,!0)},e.rcompare=function(t,e,r){return X(e,t,r)},e.sort=function(t,r){return t.sort(function(t,n){return e.compare(t,n,r)})},e.rsort=function(t,r){return t.sort(function(t,n){return e.rcompare(t,n,r)})},e.gt=J,e.lt=Q,e.eq=Z,e.neq=tt,e.gte=et,e.lte=rt,e.cmp=nt,e.Comparator=it;var ot={};function st(t,e){if(e&&"object"==typeof e||(e={loose:!!e,includePrerelease:!1}),t instanceof st)return t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease?t:new st(t.raw,e);if(t instanceof it)return new st(t.value,e);if(!(this instanceof st))return new st(t,e);if(this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(function(t){return this.parseRange(t.trim())},this).filter(function(t){return t.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+t);this.format()}function at(t){return!t||"x"===t.toLowerCase()||"*"===t}function ct(t,e,r,n,i,o,s,a,c,u,l,h,p){return((e=at(r)?"":at(n)?">="+r+".0.0":at(i)?">="+r+"."+n+".0":">="+e)+" "+(a=at(c)?"":at(u)?"<"+(+c+1)+".0.0":at(l)?"<"+c+"."+(+u+1)+".0":h?"<="+c+"."+u+"."+l+"-"+h:"<="+a)).trim()}function ut(t,e,n){for(var i=0;i<t.length;i++)if(!t[i].test(e))return!1;if(e.prerelease.length&&!n.includePrerelease){for(i=0;i<t.length;i++)if(r(t[i].semver),t[i].semver!==ot&&t[i].semver.prerelease.length>0){var o=t[i].semver;if(o.major===e.major&&o.minor===e.minor&&o.patch===e.patch)return!0}return!1}return!0}function lt(t,e,r){try{e=new st(e,r)}catch(t){return!1}return e.test(t)}function ht(t,e,r,n){var i,o,s,a,c;switch(t=new H(t,n),e=new st(e,n),r){case">":i=J,o=rt,s=Q,a=">",c=">=";break;case"<":i=Q,o=et,s=J,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(lt(t,e,n))return!1;for(var u=0;u<e.set.length;++u){var l=e.set[u],h=null,p=null;if(l.forEach(function(t){t.semver===ot&&(t=new it(">=0.0.0")),h=h||t,p=p||t,i(t.semver,h.semver,n)?h=t:s(t.semver,p.semver,n)&&(p=t)}),h.operator===a||h.operator===c)return!1;if((!p.operator||p.operator===a)&&o(t,p.semver))return!1;if(p.operator===c&&s(t,p.semver))return!1}return!0}it.prototype.parse=function(t){var e=this.options.loose?o[L]:o[D],r=t.match(e);if(!r)throw new TypeError("Invalid comparator: "+t);this.operator=r[1],"="===this.operator&&(this.operator=""),r[2]?this.semver=new H(r[2],this.options.loose):this.semver=ot},it.prototype.toString=function(){return this.value},it.prototype.test=function(t){return r("Comparator.test",t,this.options.loose),this.semver===ot||("string"==typeof t&&(t=new H(t,this.options)),nt(t,this.operator,this.semver,this.options))},it.prototype.intersects=function(t,e){if(!(t instanceof it))throw new TypeError("a Comparator is required");var r;if(e&&"object"==typeof e||(e={loose:!!e,includePrerelease:!1}),""===this.operator)return r=new st(t.value,e),lt(this.value,r,e);if(""===t.operator)return r=new st(this.value,e),lt(t.semver,r,e);var n=!(">="!==this.operator&&">"!==this.operator||">="!==t.operator&&">"!==t.operator),i=!("<="!==this.operator&&"<"!==this.operator||"<="!==t.operator&&"<"!==t.operator),o=this.semver.version===t.semver.version,s=!(">="!==this.operator&&"<="!==this.operator||">="!==t.operator&&"<="!==t.operator),a=nt(this.semver,"<",t.semver,e)&&(">="===this.operator||">"===this.operator)&&("<="===t.operator||"<"===t.operator),c=nt(this.semver,">",t.semver,e)&&("<="===this.operator||"<"===this.operator)&&(">="===t.operator||">"===t.operator);return n||i||o&&s||a||c},e.Range=st,st.prototype.format=function(){return this.range=this.set.map(function(t){return t.join(" ").trim()}).join("||").trim(),this.range},st.prototype.toString=function(){return this.range},st.prototype.parseRange=function(t){var e=this.options.loose;t=t.trim();var n=e?o[V]:o[W];t=t.replace(n,ct),r("hyphen replace",t),t=t.replace(o[U],"$1$2$3"),r("comparator trim",t,o[U]),t=(t=(t=t.replace(o[R],"$1~")).replace(o[F],"$1^")).split(/\s+/).join(" ");var i=e?o[L]:o[D],s=t.split(" ").map(function(t){return function(t,e){return r("comp",t,e),t=function(t,e){return t.trim().split(/\s+/).map(function(t){return function(t,e){r("caret",t,e);var n=e.loose?o[G]:o[M];return t.replace(n,function(e,n,i,o,s){var a;return r("caret",t,e,n,i,o,s),at(n)?a="":at(i)?a=">="+n+".0.0 <"+(+n+1)+".0.0":at(o)?a="0"===n?">="+n+"."+i+".0 <"+n+"."+(+i+1)+".0":">="+n+"."+i+".0 <"+(+n+1)+".0.0":s?(r("replaceCaret pr",s),a="0"===n?"0"===i?">="+n+"."+i+"."+o+"-"+s+" <"+n+"."+i+"."+(+o+1):">="+n+"."+i+"."+o+"-"+s+" <"+n+"."+(+i+1)+".0":">="+n+"."+i+"."+o+"-"+s+" <"+(+n+1)+".0.0"):(r("no pr"),a="0"===n?"0"===i?">="+n+"."+i+"."+o+" <"+n+"."+i+"."+(+o+1):">="+n+"."+i+"."+o+" <"+n+"."+(+i+1)+".0":">="+n+"."+i+"."+o+" <"+(+n+1)+".0.0"),r("caret return",a),a})}(t,e)}).join(" ")}(t,e),r("caret",t),t=function(t,e){return t.trim().split(/\s+/).map(function(t){return function(t,e){var n=e.loose?o[N]:o[$];return t.replace(n,function(e,n,i,o,s){var a;return r("tilde",t,e,n,i,o,s),at(n)?a="":at(i)?a=">="+n+".0.0 <"+(+n+1)+".0.0":at(o)?a=">="+n+"."+i+".0 <"+n+"."+(+i+1)+".0":s?(r("replaceTilde pr",s),a=">="+n+"."+i+"."+o+"-"+s+" <"+n+"."+(+i+1)+".0"):a=">="+n+"."+i+"."+o+" <"+n+"."+(+i+1)+".0",r("tilde return",a),a})}(t,e)}).join(" ")}(t,e),r("tildes",t),t=function(t,e){return r("replaceXRanges",t,e),t.split(/\s+/).map(function(t){return function(t,e){t=t.trim();var n=e.loose?o[C]:o[A];return t.replace(n,function(e,n,i,o,s,a){r("xRange",t,e,n,i,o,s,a);var c=at(i),u=c||at(o),l=u||at(s),h=l;return"="===n&&h&&(n=""),c?e=">"===n||"<"===n?"<0.0.0":"*":n&&h?(u&&(o=0),s=0,">"===n?(n=">=",u?(i=+i+1,o=0,s=0):(o=+o+1,s=0)):"<="===n&&(n="<",u?i=+i+1:o=+o+1),e=n+i+"."+o+"."+s):u?e=">="+i+".0.0 <"+(+i+1)+".0.0":l&&(e=">="+i+"."+o+".0 <"+i+"."+(+o+1)+".0"),r("xRange return",e),e})}(t,e)}).join(" ")}(t,e),r("xrange",t),t=function(t,e){return r("replaceStars",t,e),t.trim().replace(o[B],"")}(t,e),r("stars",t),t}(t,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(s=s.filter(function(t){return!!t.match(i)})),s=s.map(function(t){return new it(t,this.options)},this)},st.prototype.intersects=function(t,e){if(!(t instanceof st))throw new TypeError("a Range is required");return this.set.some(function(r){return r.every(function(r){return t.set.some(function(t){return t.every(function(t){return r.intersects(t,e)})})})})},e.toComparators=function(t,e){return new st(t,e).set.map(function(t){return t.map(function(t){return t.value}).join(" ").trim().split(" ")})},st.prototype.test=function(t){if(!t)return!1;"string"==typeof t&&(t=new H(t,this.options));for(var e=0;e<this.set.length;e++)if(ut(this.set[e],t,this.options))return!0;return!1},e.satisfies=lt,e.maxSatisfying=function(t,e,r){var n=null,i=null;try{var o=new st(e,r)}catch(t){return null}return t.forEach(function(t){o.test(t)&&(n&&-1!==i.compare(t)||(i=new H(n=t,r)))}),n},e.minSatisfying=function(t,e,r){var n=null,i=null;try{var o=new st(e,r)}catch(t){return null}return t.forEach(function(t){o.test(t)&&(n&&1!==i.compare(t)||(i=new H(n=t,r)))}),n},e.minVersion=function(t,e){t=new st(t,e);var r=new H("0.0.0");if(t.test(r))return r;if(r=new H("0.0.0-0"),t.test(r))return r;r=null;for(var n=0;n<t.set.length;++n){var i=t.set[n];i.forEach(function(t){var e=new H(t.semver.version);switch(t.operator){case">":0===e.prerelease.length?e.patch++:e.prerelease.push(0),e.raw=e.format();case"":case">=":r&&!J(r,e)||(r=e);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+t.operator)}})}if(r&&t.test(r))return r;return null},e.validRange=function(t,e){try{return new st(t,e).range||"*"}catch(t){return null}},e.ltr=function(t,e,r){return ht(t,e,"<",r)},e.gtr=function(t,e,r){return ht(t,e,">",r)},e.outside=ht,e.prerelease=function(t,e){var r=z(t,e);return r&&r.prerelease.length?r.prerelease:null},e.intersects=function(t,e,r){return t=new st(t,r),e=new st(e,r),t.intersects(e)},e.coerce=function(t){if(t instanceof H)return t;if("string"!=typeof t)return null;var e=t.match(o[k]);if(null==e)return null;return z(e[1]+"."+(e[2]||"0")+"."+(e[3]||"0"))}}),semver_1=semver.SEMVER_SPEC_VERSION,semver_2=semver.re,semver_3=semver.src,semver_4=semver.parse,semver_5=semver.valid,semver_6=semver.clean,semver_7=semver.SemVer,semver_8=semver.inc,semver_9=semver.diff,semver_10=semver.compareIdentifiers,semver_11=semver.rcompareIdentifiers,semver_12=semver.major,semver_13=semver.minor,semver_14=semver.patch,semver_15=semver.compare,semver_16=semver.compareLoose,semver_17=semver.rcompare,semver_18=semver.sort,semver_19=semver.rsort,semver_20=semver.gt,semver_21=semver.lt,semver_22=semver.eq,semver_23=semver.neq,semver_24=semver.gte,semver_25=semver.lte,semver_26=semver.cmp,semver_27=semver.Comparator,semver_28=semver.Range,semver_29=semver.toComparators,semver_30=semver.satisfies,semver_31=semver.maxSatisfying,semver_32=semver.minSatisfying,semver_33=semver.minVersion,semver_34=semver.validRange,semver_35=semver.ltr,semver_36=semver.gtr,semver_37=semver.outside,semver_38=semver.prerelease,semver_39=semver.intersects,semver_40=semver.coerce;const isWin="win32"===process.platform,isExecutableRegExp=/\.(?:com|exe)$/i,isCmdShimRegExp=/node_modules[\\\/].bin[\\\/][^\\\/]+\.cmd$/i,supportsShellOption=src(()=>semver.satisfies(process.version,"^4.8.0 || ^5.7.0 || >= 6.0.0",!0))||!1;function detectShebang(t){t.file=resolveCommand_1(t);const e=t.file&&readShebang_1(t.file);return e?(t.args.unshift(t.file),t.command=e,resolveCommand_1(t)):t.file}function parseNonShell(t){if(!isWin)return t;const e=detectShebang(t),r=!isExecutableRegExp.test(e);if(t.options.forceShell||r){const r=isCmdShimRegExp.test(e);t.command=path$1__default.normalize(t.command),t.command=_escape.command(t.command),t.args=t.args.map(t=>_escape.argument(t,r));const n=[t.command].concat(t.args).join(" ");t.args=["/d","/s","/c",`"${n}"`],t.command=process.env.comspec||"cmd.exe",t.options.windowsVerbatimArguments=!0}return t}function parseShell(t){if(supportsShellOption)return t;const e=[t.command].concat(t.args).join(" ");return isWin?(t.command="string"==typeof t.options.shell?t.options.shell:process.env.comspec||"cmd.exe",t.args=["/d","/s","/c",`"${e}"`],t.options.windowsVerbatimArguments=!0):("string"==typeof t.options.shell?t.command=t.options.shell:"android"===process.platform?t.command="/system/bin/sh":t.command="/bin/sh",t.args=["-c",e]),t}function parse(t,e,r){e&&!Array.isArray(e)&&(r=e,e=null);const n={command:t,args:e=e?e.slice(0):[],options:r=Object.assign({},r),file:void 0,original:{command:t,args:e}};return r.shell?parseShell(n):parseNonShell(n)}var parse_1=parse;const isWin$1="win32"===process.platform;function notFoundError(t,e){return Object.assign(new Error(`${e} ${t.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${e} ${t.command}`,path:t.command,spawnargs:t.args})}function hookChildProcess(t,e){if(!isWin$1)return;const r=t.emit;t.emit=function(n,i){if("exit"===n){const n=verifyENOENT(i,e);if(n)return r.call(t,"error",n)}return r.apply(t,arguments)}}function verifyENOENT(t,e){return isWin$1&&1===t&&!e.file?notFoundError(e.original,"spawn"):null}function verifyENOENTSync(t,e){return isWin$1&&1===t&&!e.file?notFoundError(e.original,"spawnSync"):null}var enoent={hookChildProcess:hookChildProcess,verifyENOENT:verifyENOENT,verifyENOENTSync:verifyENOENTSync,notFoundError:notFoundError};function spawn(t,e,r){const n=parse_1(t,e,r),i=child_process.spawn(n.command,n.args,n.options);return enoent.hookChildProcess(i,n),i}function spawnSync(t,e,r){const n=parse_1(t,e,r),i=child_process.spawnSync(n.command,n.args,n.options);return i.error=i.error||enoent.verifyENOENTSync(i.status,n),i}var crossSpawn=spawn,spawn_1=spawn,sync$3=spawnSync,_parse=parse_1,_enoent=enoent;crossSpawn.spawn=spawn_1,crossSpawn.sync=sync$3,crossSpawn._parse=_parse,crossSpawn._enoent=_enoent;const REMOTE_PATH_URI_PREFIX="nuclide://";function isRemote(t){return t.startsWith(REMOTE_PATH_URI_PREFIX)}function isLocal(t){return!isRemote(t)}function createRemoteUri(t,e){return`nuclide://${t}${e}`}function parse$1(t){if(isLocal(t))return{auth:null,host:null,hostname:null,href:t,path:t,pathname:t,protocol:null,query:null,search:null,slashes:null};const e=url.parse(_escapeBackslashes(t));invariant(e.path,`Nuclide URIs must contain paths, '${String(e.path)}' found while parsing '${t}'`);let r=e.path;null!=e.hash&&(r+=e.hash),invariant(e.pathname,`Nuclide URIs must contain pathnamess, '${String(e.pathname)}' found while parsing '${t}'`);let n=e.pathname;return null!=e.hash&&(n+=e.hash),{auth:e.auth,host:e.host,hostname:e.hostname,href:decodeURI(e.href),path:decodeURI(r),pathname:decodeURI(n),protocol:e.protocol,query:e.query,search:e.search,slashes:e.slashes}}function parseRemoteUri(t){if(!isRemote(t))throw new Error("Expected remote uri. Got "+t);const e=parse$1(t);return invariant(e.hostname,`Remote Nuclide URIs must contain hostnames, '${String(e.hostname)}' found `+`while parsing '${t}'`),{auth:e.auth,host:e.host,hostname:e.hostname,href:e.href,path:e.path,pathname:e.pathname,protocol:e.protocol,query:e.query,search:e.search,slashes:e.slashes}}function getPath(t){return parse$1(t).path}function getHostname(t){return parseRemoteUri(t).hostname}function getHostnameOpt(t){return null==t||isLocal(t)?null:getHostname(t)}function join(t,...e){const r=_pathModuleFor(t);if(isRemote(t)){const{hostname:n,path:i}=parseRemoteUri(t);return e.splice(0,0,i),createRemoteUri(n,r.join.apply(null,e))}return e.splice(0,0,t),r.join.apply(null,e)}function normalize(t){const e=_pathModuleFor(t);if(isRemote(t)){const{hostname:r,path:n}=parseRemoteUri(t);return createRemoteUri(r,e.normalize(n))}return e.normalize(t)}function normalizeDir(t){return ensureTrailingSeparator(normalize(t))}function getParent(t){return normalize(join(t,".."))}function relative(t,e){const r=_pathModuleFor(t),n=isRemote(t);if(n!==isRemote(e)||n&&getHostname(t)!==getHostname(e))throw new Error(`Cannot relative urls on different hosts: ${t} and ${e}`);return n?r.relative(getPath(t),getPath(e)):r.relative(t,e)}function basename(t,e=""){return _pathModuleFor(t).basename(getPath(t),e)}function dirname(t){const e=_pathModuleFor(t);if(isRemote(t)){const{hostname:r,path:n}=parseRemoteUri(t);return createRemoteUri(r,e.dirname(n))}return e.dirname(t)}function extname(t){return _pathModuleFor(t).extname(getPath(t))}function stripExtension(t){const e=extname(t);return 0===e.length?t:t.slice(0,-1*e.length)}function uriToNuclideUri(t){const e=url.parse(_escapeBackslashes(t),!1);return"file:"===e.protocol&&e.path?e.path:isRemote(t)?t:null}function nuclideUriToUri(t){return isRemote(t)?t:"file://"+t}function contains(t,e){if(e.length<t.length)return!(e.length<t.length-1)&&(endsWithSeparator(t)&&t.startsWith(e));if(!e.startsWith(t))return!1;if(endsWithSeparator(t)||t.length===e.length)return!0;const r=_pathModuleFor(e);return e.slice(t.length).startsWith(r.sep)}function collapse(t){return t.filter(e=>!t.some(t=>contains(t,e)&&t!==e))}const hostFormatters=[];function registerHostnameFormatter(t){return hostFormatters.push(t),{dispose:()=>{const e=hostFormatters.indexOf(t);e>=0&&hostFormatters.splice(e,1)}}}function nuclideUriToDisplayString(t){if(isRemote(t)){let e=getHostname(t);for(const t of hostFormatters){const r=t(e);if(r){e=r;break}}return`${e}/${getPath(t)}`}return t}function ensureTrailingSeparator(t){const e=_pathModuleFor(t);return t.endsWith(e.sep)?t:t+e.sep}function trimTrailingSeparator(t){const e=_pathModuleFor(t);let r=t;for(;r.endsWith(e.sep)&&!isRoot(r);)r=r.slice(0,-1*e.sep.length);return r}function endsWithSeparator(t){const e=_pathModuleFor(t);return t.endsWith(e.sep)}function isAbsolute(t){return!!isRemote(t)||_pathModuleFor(t).isAbsolute(t)}function resolve(t,...e){const r=_pathModuleFor(t);if(isRemote(t)){const{hostname:n,path:i}=parseRemoteUri(t);return e.splice(0,0,i),createRemoteUri(n,r.resolve.apply(null,e))}return e.splice(0,0,t),r.resolve.apply(null,e)}function expandHomeDir(t){if(!t.startsWith("~"))return t;const{HOME:e}=process.env;return invariant(null!=e),"~"===t?e:t.startsWith("~/")?path$1__default.posix.resolve(e,t.replace("~",".")):t}function splitPathList(t){invariant(t.indexOf(REMOTE_PATH_URI_PREFIX)<0,"Splitting remote URIs is not supported");const e=_pathModuleFor(t);return t.split(e.delimiter)}function joinPathList(t){if(0===t.length)return"";invariant(t.every(t=>!isRemote(t)),"Joining of remote URIs is not supported");const e=_pathModuleFor(t[0]);return t.join(e.delimiter)}function ensureLocalPrefix(t){const e=_pathModuleFor(t);invariant(!isRemote(t),"Local prefix can not be added to a remote path"),invariant(!isAbsolute(t),"Local prefix can not be added to an absolute path");const r=`.${e.sep}`;return t.startsWith(r)?t:r+t}function isRoot(t){return dirname(t)===t}function parsePath(t){return _pathModuleFor(t).parse(getPath(t))}function split(t){const e=[];let r=t,n=dirname(r);for(;r!==n;)e.push(basename(r)),n=dirname(r=n);return isAbsolute(t)&&e.push(n),e.reverse(),e}function _pathModuleFor(t){const e=path$1__default.posix,r=path$1__default.win32;return t.startsWith(e.sep)?e:t.indexOf("://")>-1?e:":"===t[1]&&t[2]===r.sep?r:t.split(r.sep).length>t.split(e.sep).length?r:e}function _escapeBackslashes(t){return t.replace(/\\/g,"%5C")}var nuclideUri={basename:basename,dirname:dirname,extname:extname,stripExtension:stripExtension,isRemote:isRemote,isLocal:isLocal,createRemoteUri:createRemoteUri,parse:parse$1,parseRemoteUri:parseRemoteUri,getPath:getPath,getHostname:getHostname,getHostnameOpt:getHostnameOpt,join:join,relative:relative,normalize:normalize,normalizeDir:normalizeDir,getParent:getParent,uriToNuclideUri:uriToNuclideUri,nuclideUriToUri:nuclideUriToUri,contains:contains,collapse:collapse,nuclideUriToDisplayString:nuclideUriToDisplayString,registerHostnameFormatter:registerHostnameFormatter,ensureTrailingSeparator:ensureTrailingSeparator,trimTrailingSeparator:trimTrailingSeparator,endsWithSeparator:endsWithSeparator,isAbsolute:isAbsolute,resolve:resolve,expandHomeDir:expandHomeDir,splitPathList:splitPathList,joinPathList:joinPathList,ensureLocalPrefix:ensureLocalPrefix,isRoot:isRoot,parsePath:parsePath,split:split,_pathModuleFor:_pathModuleFor};function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var disposable=createCommonjsModule(function(t){(function(){t.exports=function(){function t(t){this.disposalAction=t}return t.prototype.disposed=!1,t.isDisposable=function(t){return"function"==typeof(null!=t?t.dispose:void 0)},t.prototype.dispose=function(){this.disposed||(this.disposed=!0,"function"==typeof this.disposalAction&&this.disposalAction(),this.disposalAction=null)},t}()}).call(commonjsGlobal)}),emitter=createCommonjsModule(function(t){(function(){var e;e=disposable,t.exports=function(){function t(){this.clear()}return t.exceptionHandlers=[],t.onEventHandlerException=function(t){return 0===this.exceptionHandlers.length&&(this.dispatch=this.exceptionHandlingDispatch),this.exceptionHandlers.push(t),new e((r=this,function(){if(r.exceptionHandlers.splice(r.exceptionHandlers.indexOf(t),1),0===r.exceptionHandlers.length)return r.dispatch=r.simpleDispatch}));var r},t.simpleDispatch=function(t,e){return t(e)},t.exceptionHandlingDispatch=function(t,e){var r,n,i,o,s,a;try{return t(e)}catch(t){for(r=t,a=[],i=0,o=(s=this.exceptionHandlers).length;i<o;i++)n=s[i],a.push(n(r));return a}},t.dispatch=t.simpleDispatch,t.prototype.disposed=!1,t.prototype.clear=function(){return this.handlersByEventName={}},t.prototype.dispose=function(){return this.handlersByEventName=null,this.disposed=!0},t.prototype.on=function(t,r,n){var i;if(null==n&&(n=!1),this.disposed)throw new Error("Emitter has been disposed");if("function"!=typeof r)throw new Error("Handler must be a function");return(i=this.handlersByEventName[t])?this.handlersByEventName[t]=n?[r].concat(i):i.concat(r):this.handlersByEventName[t]=[r],new e(this.off.bind(this,t,r))},t.prototype.once=function(t,e,r){var n,i;return null==r&&(r=!1),i=function(t){return n.dispose(),e(t)},n=this.on(t,i,r)},t.prototype.preempt=function(t,e){return this.on(t,e,!0)},t.prototype.off=function(t,e){var r,n,i,o,s;if(!this.disposed&&(i=this.handlersByEventName[t])){for(n=[],o=0,s=i.length;o<s;o++)(r=i[o])!==e&&n.push(r);n.length>0?this.handlersByEventName[t]=n:delete this.handlersByEventName[t]}},t.prototype.emit=function(t,e){var r,n,i,o,s;if(n=null!=(s=this.handlersByEventName)?s[t]:void 0)for(i=0,o=n.length;i<o;i++)r=n[i],this.constructor.dispatch(r,e)},t.prototype.getEventNames=function(){return Object.keys(this.handlersByEventName)},t.prototype.listenerCountForEventName=function(t){var e,r;return null!=(e=null!=(r=this.handlersByEventName[t])?r.length:void 0)?e:0},t.prototype.getTotalListenerCount=function(){var t,e,r,n,i;for(e=0,r=0,n=(i=Object.keys(this.handlersByEventName)).length;r<n;r++)t=i[r],e+=this.handlersByEventName[t].length;return e},t}()}).call(commonjsGlobal)}),compositeDisposable=createCommonjsModule(function(t){(function(){var e,r;e=null,t.exports=function(){function t(){var t,e,r;for(this.disposables=new Set,e=0,r=arguments.length;e<r;e++)t=arguments[e],this.add(t)}return t.prototype.disposed=!1,t.prototype.dispose=function(){this.disposed||(this.disposed=!0,this.disposables.forEach(function(t){return t.dispose()}),this.disposables=null)},t.prototype.add=function(){var t,e,n;if(!this.disposed)for(e=0,n=arguments.length;e<n;e+=1)t=arguments[e],r(t),this.disposables.add(t)},t.prototype.remove=function(t){this.disposed||this.disposables.delete(t)},t.prototype.delete=function(t){this.remove(t)},t.prototype.clear=function(){this.disposed||this.disposables.clear()},t}(),r=function(t){if(null==e&&(e=disposable),!e.isDisposable(t))throw new TypeError("Arguments to CompositeDisposable.add must have a .dispose() method")}}).call(commonjsGlobal)}),eventKit=createCommonjsModule(function(t,e){(function(){e.Emitter=emitter,e.Disposable=disposable,e.CompositeDisposable=compositeDisposable}).call(commonjsGlobal)}),eventKit_1=eventKit.Emitter,eventKit_2=eventKit.Disposable,eventKit_3=eventKit.CompositeDisposable,__window="undefined"!=typeof window&&window,__self="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,__global=void 0!==commonjsGlobal&&commonjsGlobal,_root=__window||__global||__self,root_1=_root;!function(){if(!_root)throw new Error("RxJS could not find any global context (window, self, global)")}();var root={root:root_1};function isFunction(t){return"function"==typeof t}var isFunction_2=isFunction,isFunction_1={isFunction:isFunction_2},isArray_1=Array.isArray||function(t){return t&&"number"==typeof t.length},isArray={isArray:isArray_1};function isObject(t){return null!=t&&"object"==typeof t}var tryCatchTarget,isObject_2=isObject,isObject_1={isObject:isObject_2},errorObject_1={e:{}},errorObject={errorObject:errorObject_1};function tryCatcher(){try{return tryCatchTarget.apply(this,arguments)}catch(t){return errorObject.errorObject.e=t,errorObject.errorObject}}function tryCatch(t){return tryCatchTarget=t,tryCatcher}var tryCatch_2=tryCatch,tryCatch_1={tryCatch:tryCatch_2},__extends=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},UnsubscriptionError=function(t){function e(e){t.call(this),this.errors=e;var r=Error.call(this,e?e.length+" errors occurred during unsubscription:\n  "+e.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"");this.name=r.name="UnsubscriptionError",this.stack=r.stack,this.message=r.message}return __extends(e,t),e}(Error),UnsubscriptionError_2=UnsubscriptionError,UnsubscriptionError_1={UnsubscriptionError:UnsubscriptionError_2},Subscription=function(){function t(t){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}return t.prototype.unsubscribe=function(){var t,e=!1;if(!this.closed){var r=this._parent,n=this._parents,i=this._unsubscribe,o=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var s=-1,a=n?n.length:0;r;)r.remove(this),r=++s<a&&n[s]||null;if(isFunction_1.isFunction(i))tryCatch_1.tryCatch(i).call(this)===errorObject.errorObject&&(e=!0,t=t||(errorObject.errorObject.e instanceof UnsubscriptionError_1.UnsubscriptionError?flattenUnsubscriptionErrors(errorObject.errorObject.e.errors):[errorObject.errorObject.e]));if(isArray.isArray(o))for(s=-1,a=o.length;++s<a;){var c=o[s];if(isObject_1.isObject(c))if(tryCatch_1.tryCatch(c.unsubscribe).call(c)===errorObject.errorObject){e=!0,t=t||[];var u=errorObject.errorObject.e;u instanceof UnsubscriptionError_1.UnsubscriptionError?t=t.concat(flattenUnsubscriptionErrors(u.errors)):t.push(u)}}if(e)throw new UnsubscriptionError_1.UnsubscriptionError(t)}},t.prototype.add=function(e){if(!e||e===t.EMPTY)return t.EMPTY;if(e===this)return this;var r=e;switch(typeof e){case"function":r=new t(e);case"object":if(r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if("function"!=typeof r._addParent){var n=r;(r=new t)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(r),r._addParent(this),r},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}},t.prototype._addParent=function(t){var e=this._parent,r=this._parents;e&&e!==t?r?-1===r.indexOf(t)&&r.push(t):this._parents=[t]:this._parent=t},t.EMPTY=function(t){return t.closed=!0,t}(new t),t}(),Subscription_2=Subscription;function flattenUnsubscriptionErrors(t){return t.reduce(function(t,e){return t.concat(e instanceof UnsubscriptionError_1.UnsubscriptionError?e.errors:e)},[])}var Subscription_1={Subscription:Subscription_2},empty={closed:!0,next:function(t){},error:function(t){throw t},complete:function(){}},Observer={empty:empty},rxSubscriber=createCommonjsModule(function(t,e){var r=root.root.Symbol;e.rxSubscriber="function"==typeof r&&"function"==typeof r.for?r.for("rxSubscriber"):"@@rxSubscriber",e.$$rxSubscriber=e.rxSubscriber}),rxSubscriber_1=rxSubscriber.rxSubscriber,rxSubscriber_2=rxSubscriber.$$rxSubscriber,__extends$1=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},Subscriber=function(t){function e(r,n,i){switch(t.call(this),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=Observer.empty;break;case 1:if(!r){this.destination=Observer.empty;break}if("object"==typeof r){r instanceof e?(this.destination=r,this.destination.add(this)):(this.syncErrorThrowable=!0,this.destination=new SafeSubscriber(this,r));break}default:this.syncErrorThrowable=!0,this.destination=new SafeSubscriber(this,r,n,i)}}return __extends$1(e,t),e.prototype[rxSubscriber.rxSubscriber]=function(){return this},e.create=function(t,r,n){var i=new e(t,r,n);return i.syncErrorThrowable=!1,i},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parent,e=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=e,this},e}(Subscription_1.Subscription),Subscriber_2=Subscriber,SafeSubscriber=function(t){function e(e,r,n,i){var o;t.call(this),this._parentSubscriber=e;var s=this;isFunction_1.isFunction(r)?o=r:r&&(o=r.next,n=r.error,i=r.complete,r!==Observer.empty&&(s=Object.create(r),isFunction_1.isFunction(s.unsubscribe)&&this.add(s.unsubscribe.bind(s)),s.unsubscribe=this.unsubscribe.bind(this))),this._context=s,this._next=o,this._error=n,this._complete=i}return __extends$1(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber;if(this._error)e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else{if(!e.syncErrorThrowable)throw this.unsubscribe(),t;e.syncErrorValue=t,e.syncErrorThrown=!0,this.unsubscribe()}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var r=function(){return t._complete.call(t._context)};e.syncErrorThrowable?(this.__tryOrSetError(e,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){throw this.unsubscribe(),t}},e.prototype.__tryOrSetError=function(t,e,r){try{e.call(this._context,r)}catch(e){return t.syncErrorValue=e,t.syncErrorThrown=!0,!0}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(Subscriber),Subscriber_1={Subscriber:Subscriber_2};function toSubscriber(t,e,r){if(t){if(t instanceof Subscriber_1.Subscriber)return t;if(t[rxSubscriber.rxSubscriber])return t[rxSubscriber.rxSubscriber]()}return t||e||r?new Subscriber_1.Subscriber(t,e,r):new Subscriber_1.Subscriber(Observer.empty)}var toSubscriber_2=toSubscriber,toSubscriber_1={toSubscriber:toSubscriber_2},observable=createCommonjsModule(function(t,e){function r(t){var e,r=t.Symbol;return"function"==typeof r?r.observable?e=r.observable:(e=r("observable"),r.observable=e):e="@@observable",e}e.getSymbolObservable=r,e.observable=r(root.root),e.$$observable=e.observable}),observable_1=observable.getSymbolObservable,observable_2=observable.observable,observable_3=observable.$$observable,Observable=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(t,e,r){var n=this.operator,i=toSubscriber_1.toSubscriber(t,e,r);if(n?n.call(i,this.source):i.add(this._trySubscribe(i)),i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){t.syncErrorThrown=!0,t.syncErrorValue=e,t.error(e)}},t.prototype.forEach=function(t,e){var r=this;if(e||(root.root.Rx&&root.root.Rx.config&&root.root.Rx.config.Promise?e=root.root.Rx.config.Promise:root.root.Promise&&(e=root.root.Promise)),!e)throw new Error("no Promise impl found");return new e(function(e,n){var i;i=r.subscribe(function(e){if(i)try{t(e)}catch(t){n(t),i.unsubscribe()}else t(e)},n,e)})},t.prototype._subscribe=function(t){return this.source.subscribe(t)},t.prototype[observable.observable]=function(){return this},t.create=function(e){return new t(e)},t}(),Observable_2=Observable,Observable_1={Observable:Observable_2},__extends$2=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},ObjectUnsubscribedError=function(t){function e(){var e=t.call(this,"object unsubscribed");this.name=e.name="ObjectUnsubscribedError",this.stack=e.stack,this.message=e.message}return __extends$2(e,t),e}(Error),ObjectUnsubscribedError_2=ObjectUnsubscribedError,ObjectUnsubscribedError_1={ObjectUnsubscribedError:ObjectUnsubscribedError_2},__extends$3=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},SubjectSubscription=function(t){function e(e,r){t.call(this),this.subject=e,this.subscriber=r,this.closed=!1}return __extends$3(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var r=e.indexOf(this.subscriber);-1!==r&&e.splice(r,1)}}},e}(Subscription_1.Subscription),SubjectSubscription_2=SubjectSubscription,SubjectSubscription_1={SubjectSubscription:SubjectSubscription_2},__extends$4=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},SubjectSubscriber=function(t){function e(e){t.call(this,e),this.destination=e}return __extends$4(e,t),e}(Subscriber_1.Subscriber),SubjectSubscriber_1=SubjectSubscriber,Subject=function(t){function e(){t.call(this),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}return __extends$4(e,t),e.prototype[rxSubscriber.rxSubscriber]=function(){return new SubjectSubscriber(this)},e.prototype.lift=function(t){var e=new AnonymousSubject(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new ObjectUnsubscribedError_1.ObjectUnsubscribedError;if(!this.isStopped)for(var e=this.observers,r=e.length,n=e.slice(),i=0;i<r;i++)n[i].next(t)},e.prototype.error=function(t){if(this.closed)throw new ObjectUnsubscribedError_1.ObjectUnsubscribedError;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,r=e.length,n=e.slice(),i=0;i<r;i++)n[i].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new ObjectUnsubscribedError_1.ObjectUnsubscribedError;this.isStopped=!0;for(var t=this.observers,e=t.length,r=t.slice(),n=0;n<e;n++)r[n].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new ObjectUnsubscribedError_1.ObjectUnsubscribedError;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new ObjectUnsubscribedError_1.ObjectUnsubscribedError;return this.hasError?(t.error(this.thrownError),Subscription_1.Subscription.EMPTY):this.isStopped?(t.complete(),Subscription_1.Subscription.EMPTY):(this.observers.push(t),new SubjectSubscription_1.SubjectSubscription(this,t))},e.prototype.asObservable=function(){var t=new Observable_1.Observable;return t.source=this,t},e.create=function(t,e){return new AnonymousSubject(t,e)},e}(Observable_1.Observable),Subject_2=Subject,AnonymousSubject=function(t){function e(e,r){t.call(this),this.destination=e,this.source=r}return __extends$4(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):Subscription_1.Subscription.EMPTY},e}(Subject),AnonymousSubject_1=AnonymousSubject,Subject_1={SubjectSubscriber:SubjectSubscriber_1,Subject:Subject_2,AnonymousSubject:AnonymousSubject_1},__extends$5=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},AsyncSubject=function(t){function e(){t.apply(this,arguments),this.value=null,this.hasNext=!1,this.hasCompleted=!1}return __extends$5(e,t),e.prototype._subscribe=function(e){return this.hasError?(e.error(this.thrownError),Subscription_1.Subscription.EMPTY):this.hasCompleted&&this.hasNext?(e.next(this.value),e.complete(),Subscription_1.Subscription.EMPTY):t.prototype._subscribe.call(this,e)},e.prototype.next=function(t){this.hasCompleted||(this.value=t,this.hasNext=!0)},e.prototype.error=function(e){this.hasCompleted||t.prototype.error.call(this,e)},e.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&t.prototype.next.call(this,this.value),t.prototype.complete.call(this)},e}(Subject_1.Subject),AsyncSubject_2=AsyncSubject,AsyncSubject_1={AsyncSubject:AsyncSubject_2},__extends$6=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},BoundCallbackObservable=function(t){function e(e,r,n,i,o){t.call(this),this.callbackFunc=e,this.selector=r,this.args=n,this.context=i,this.scheduler=o}return __extends$6(e,t),e.create=function(t,r,n){return void 0===r&&(r=void 0),function(){for(var i=[],o=0;o<arguments.length;o++)i[o-0]=arguments[o];return new e(t,r,i,this,n)}},e.prototype._subscribe=function(t){var r=this.callbackFunc,n=this.args,i=this.scheduler,o=this.subject;if(i)return i.schedule(e.dispatch,0,{source:this,subscriber:t,context:this.context});if(!o){o=this.subject=new AsyncSubject_1.AsyncSubject;var s=function t(){for(var e=[],r=0;r<arguments.length;r++)e[r-0]=arguments[r];var n=t.source,i=n.selector,o=n.subject;if(i){var s=tryCatch_1.tryCatch(i).apply(this,e);s===errorObject.errorObject?o.error(errorObject.errorObject.e):(o.next(s),o.complete())}else o.next(e.length<=1?e[0]:e),o.complete()};s.source=this,tryCatch_1.tryCatch(r).apply(this.context,n.concat(s))===errorObject.errorObject&&o.error(errorObject.errorObject.e)}return o.subscribe(t)},e.dispatch=function(t){var e=this,r=t.source,n=t.subscriber,i=t.context,o=r.callbackFunc,s=r.args,a=r.scheduler,c=r.subject;if(!c){c=r.subject=new AsyncSubject_1.AsyncSubject;var u=function t(){for(var r=[],n=0;n<arguments.length;n++)r[n-0]=arguments[n];var i=t.source,o=i.selector,s=i.subject;if(o){var c=tryCatch_1.tryCatch(o).apply(this,r);c===errorObject.errorObject?e.add(a.schedule(dispatchError,0,{err:errorObject.errorObject.e,subject:s})):e.add(a.schedule(dispatchNext,0,{value:c,subject:s}))}else{var u=r.length<=1?r[0]:r;e.add(a.schedule(dispatchNext,0,{value:u,subject:s}))}};u.source=r,tryCatch_1.tryCatch(o).apply(i,s.concat(u))===errorObject.errorObject&&c.error(errorObject.errorObject.e)}e.add(c.subscribe(n))},e}(Observable_1.Observable),BoundCallbackObservable_2=BoundCallbackObservable;function dispatchNext(t){var e=t.value,r=t.subject;r.next(e),r.complete()}function dispatchError(t){var e=t.err;t.subject.error(e)}var BoundCallbackObservable_1={BoundCallbackObservable:BoundCallbackObservable_2},bindCallback_1=BoundCallbackObservable_1.BoundCallbackObservable.create,bindCallback={bindCallback:bindCallback_1};Observable_1.Observable.bindCallback=bindCallback.bindCallback;var __extends$7=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},BoundNodeCallbackObservable=function(t){function e(e,r,n,i,o){t.call(this),this.callbackFunc=e,this.selector=r,this.args=n,this.context=i,this.scheduler=o}return __extends$7(e,t),e.create=function(t,r,n){return void 0===r&&(r=void 0),function(){for(var i=[],o=0;o<arguments.length;o++)i[o-0]=arguments[o];return new e(t,r,i,this,n)}},e.prototype._subscribe=function(t){var e=this.callbackFunc,r=this.args,n=this.scheduler,i=this.subject;if(n)return n.schedule(dispatch,0,{source:this,subscriber:t,context:this.context});if(!i){i=this.subject=new AsyncSubject_1.AsyncSubject;var o=function t(){for(var e=[],r=0;r<arguments.length;r++)e[r-0]=arguments[r];var n=t.source,i=n.selector,o=n.subject,s=e.shift();if(s)o.error(s);else if(i){var a=tryCatch_1.tryCatch(i).apply(this,e);a===errorObject.errorObject?o.error(errorObject.errorObject.e):(o.next(a),o.complete())}else o.next(e.length<=1?e[0]:e),o.complete()};o.source=this,tryCatch_1.tryCatch(e).apply(this.context,r.concat(o))===errorObject.errorObject&&i.error(errorObject.errorObject.e)}return i.subscribe(t)},e}(Observable_1.Observable),BoundNodeCallbackObservable_2=BoundNodeCallbackObservable;function dispatch(t){var e=this,r=t.source,n=t.subscriber,i=t.context,o=r,s=o.callbackFunc,a=o.args,c=o.scheduler,u=r.subject;if(!u){u=r.subject=new AsyncSubject_1.AsyncSubject;var l=function t(){for(var r=[],n=0;n<arguments.length;n++)r[n-0]=arguments[n];var i=t.source,o=i.selector,s=i.subject,a=r.shift();if(a)e.add(c.schedule(dispatchError$1,0,{err:a,subject:s}));else if(o){var u=tryCatch_1.tryCatch(o).apply(this,r);u===errorObject.errorObject?e.add(c.schedule(dispatchError$1,0,{err:errorObject.errorObject.e,subject:s})):e.add(c.schedule(dispatchNext$1,0,{value:u,subject:s}))}else{var l=r.length<=1?r[0]:r;e.add(c.schedule(dispatchNext$1,0,{value:l,subject:s}))}};l.source=r,tryCatch_1.tryCatch(s).apply(i,a.concat(l))===errorObject.errorObject&&e.add(c.schedule(dispatchError$1,0,{err:errorObject.errorObject.e,subject:u}))}e.add(u.subscribe(n))}function dispatchNext$1(t){var e=t.value,r=t.subject;r.next(e),r.complete()}function dispatchError$1(t){var e=t.err;t.subject.error(e)}var BoundNodeCallbackObservable_1={BoundNodeCallbackObservable:BoundNodeCallbackObservable_2},bindNodeCallback_1=BoundNodeCallbackObservable_1.BoundNodeCallbackObservable.create,bindNodeCallback={bindNodeCallback:bindNodeCallback_1};function isScheduler(t){return t&&"function"==typeof t.schedule}Observable_1.Observable.bindNodeCallback=bindNodeCallback.bindNodeCallback;var isScheduler_2=isScheduler,isScheduler_1={isScheduler:isScheduler_2},__extends$8=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},ScalarObservable=function(t){function e(e,r){t.call(this),this.value=e,this.scheduler=r,this._isScalar=!0,r&&(this._isScalar=!1)}return __extends$8(e,t),e.create=function(t,r){return new e(t,r)},e.dispatch=function(t){var e=t.done,r=t.value,n=t.subscriber;e?n.complete():(n.next(r),n.closed||(t.done=!0,this.schedule(t)))},e.prototype._subscribe=function(t){var r=this.value,n=this.scheduler;if(n)return n.schedule(e.dispatch,0,{done:!1,value:r,subscriber:t});t.next(r),t.closed||t.complete()},e}(Observable_1.Observable),ScalarObservable_2=ScalarObservable,ScalarObservable_1={ScalarObservable:ScalarObservable_2},__extends$9=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},EmptyObservable=function(t){function e(e){t.call(this),this.scheduler=e}return __extends$9(e,t),e.create=function(t){return new e(t)},e.dispatch=function(t){t.subscriber.complete()},e.prototype._subscribe=function(t){var r=this.scheduler;if(r)return r.schedule(e.dispatch,0,{subscriber:t});t.complete()},e}(Observable_1.Observable),EmptyObservable_2=EmptyObservable,EmptyObservable_1={EmptyObservable:EmptyObservable_2},__extends$a=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},ArrayObservable=function(t){function e(e,r){t.call(this),this.array=e,this.scheduler=r,r||1!==e.length||(this._isScalar=!0,this.value=e[0])}return __extends$a(e,t),e.create=function(t,r){return new e(t,r)},e.of=function(){for(var t=[],r=0;r<arguments.length;r++)t[r-0]=arguments[r];var n=t[t.length-1];isScheduler_1.isScheduler(n)?t.pop():n=null;var i=t.length;return i>1?new e(t,n):1===i?new ScalarObservable_1.ScalarObservable(t[0],n):new EmptyObservable_1.EmptyObservable(n)},e.dispatch=function(t){var e=t.array,r=t.index,n=t.count,i=t.subscriber;r>=n?i.complete():(i.next(e[r]),i.closed||(t.index=r+1,this.schedule(t)))},e.prototype._subscribe=function(t){var r=this.array,n=r.length,i=this.scheduler;if(i)return i.schedule(e.dispatch,0,{array:r,index:0,count:n,subscriber:t});for(var o=0;o<n&&!t.closed;o++)t.next(r[o]);t.complete()},e}(Observable_1.Observable),ArrayObservable_2=ArrayObservable,ArrayObservable_1={ArrayObservable:ArrayObservable_2},__extends$b=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},OuterSubscriber=function(t){function e(){t.apply(this,arguments)}return __extends$b(e,t),e.prototype.notifyNext=function(t,e,r,n,i){this.destination.next(e)},e.prototype.notifyError=function(t,e){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.complete()},e}(Subscriber_1.Subscriber),OuterSubscriber_2=OuterSubscriber,OuterSubscriber_1={OuterSubscriber:OuterSubscriber_2},isArrayLike_1=function(t){return t&&"number"==typeof t.length},isArrayLike={isArrayLike:isArrayLike_1};function isPromise(t){return t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}var isPromise_2=isPromise,isPromise_1={isPromise:isPromise_2},iterator=createCommonjsModule(function(t,e){function r(t){var e=t.Symbol;if("function"==typeof e)return e.iterator||(e.iterator=e("iterator polyfill")),e.iterator;var r=t.Set;if(r&&"function"==typeof(new r)["@@iterator"])return"@@iterator";var n=t.Map;if(n)for(var i=Object.getOwnPropertyNames(n.prototype),o=0;o<i.length;++o){var s=i[o];if("entries"!==s&&"size"!==s&&n.prototype[s]===n.prototype.entries)return s}return"@@iterator"}e.symbolIteratorPonyfill=r,e.iterator=r(root.root),e.$$iterator=e.iterator}),iterator_1=iterator.symbolIteratorPonyfill,iterator_2=iterator.iterator,iterator_3=iterator.$$iterator,__extends$c=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},InnerSubscriber=function(t){function e(e,r,n){t.call(this),this.parent=e,this.outerValue=r,this.outerIndex=n,this.index=0}return __extends$c(e,t),e.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},e.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(Subscriber_1.Subscriber),InnerSubscriber_2=InnerSubscriber,InnerSubscriber_1={InnerSubscriber:InnerSubscriber_2};function subscribeToResult(t,e,r,n){var i=new InnerSubscriber_1.InnerSubscriber(t,r,n);if(i.closed)return null;if(e instanceof Observable_1.Observable)return e._isScalar?(i.next(e.value),i.complete(),null):e.subscribe(i);if(isArrayLike.isArrayLike(e)){for(var o=0,s=e.length;o<s&&!i.closed;o++)i.next(e[o]);i.closed||i.complete()}else{if(isPromise_1.isPromise(e))return e.then(function(t){i.closed||(i.next(t),i.complete())},function(t){return i.error(t)}).then(null,function(t){root.root.setTimeout(function(){throw t})}),i;if(e&&"function"==typeof e[iterator.iterator])for(var a=e[iterator.iterator]();;){var c=a.next();if(c.done){i.complete();break}if(i.next(c.value),i.closed)break}else if(e&&"function"==typeof e[observable.observable]){var u=e[observable.observable]();if("function"==typeof u.subscribe)return u.subscribe(new InnerSubscriber_1.InnerSubscriber(t,r,n));i.error(new TypeError("Provided object does not correctly implement Symbol.observable"))}else{var l="You provided "+(isObject_1.isObject(e)?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.";i.error(new TypeError(l))}}return null}var subscribeToResult_2=subscribeToResult,subscribeToResult_1={subscribeToResult:subscribeToResult_2},__extends$d=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},none={};function combineLatest(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=null;return"function"==typeof t[t.length-1]&&(r=t.pop()),1===t.length&&isArray.isArray(t[0])&&(t=t[0].slice()),t.unshift(this),this.lift.call(new ArrayObservable_1.ArrayObservable(t),new CombineLatestOperator(r))}var combineLatest_2=combineLatest,CombineLatestOperator=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new CombineLatestSubscriber(t,this.project))},t}(),CombineLatestOperator_1=CombineLatestOperator,CombineLatestSubscriber=function(t){function e(e,r){t.call(this,e),this.project=r,this.active=0,this.values=[],this.observables=[]}return __extends$d(e,t),e.prototype._next=function(t){this.values.push(none),this.observables.push(t)},e.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(var r=0;r<e;r++){var n=t[r];this.add(subscribeToResult_1.subscribeToResult(this,n,n,r))}}},e.prototype.notifyComplete=function(t){0==(this.active-=1)&&this.destination.complete()},e.prototype.notifyNext=function(t,e,r,n,i){var o=this.values,s=o[r],a=this.toRespond?s===none?--this.toRespond:this.toRespond:0;o[r]=e,0===a&&(this.project?this._tryProject(o):this.destination.next(o.slice()))},e.prototype._tryProject=function(t){var e;try{e=this.project.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(OuterSubscriber_1.OuterSubscriber),CombineLatestSubscriber_1=CombineLatestSubscriber,combineLatest_1={combineLatest:combineLatest_2,CombineLatestOperator:CombineLatestOperator_1,CombineLatestSubscriber:CombineLatestSubscriber_1};function combineLatest$1(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=null,n=null;return isScheduler_1.isScheduler(t[t.length-1])&&(n=t.pop()),"function"==typeof t[t.length-1]&&(r=t.pop()),1===t.length&&isArray.isArray(t[0])&&(t=t[0]),new ArrayObservable_1.ArrayObservable(t,n).lift(new combineLatest_1.CombineLatestOperator(r))}var combineLatest_3=combineLatest$1,combineLatest_2$1={combineLatest:combineLatest_3};Observable_1.Observable.combineLatest=combineLatest_2$1.combineLatest;var __extends$e=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function mergeAll(t){return void 0===t&&(t=Number.POSITIVE_INFINITY),this.lift(new MergeAllOperator(t))}var mergeAll_2=mergeAll,MergeAllOperator=function(){function t(t){this.concurrent=t}return t.prototype.call=function(t,e){return e.subscribe(new MergeAllSubscriber(t,this.concurrent))},t}(),MergeAllOperator_1=MergeAllOperator,MergeAllSubscriber=function(t){function e(e,r){t.call(this,e),this.concurrent=r,this.hasCompleted=!1,this.buffer=[],this.active=0}return __extends$e(e,t),e.prototype._next=function(t){this.active<this.concurrent?(this.active++,this.add(subscribeToResult_1.subscribeToResult(this,t))):this.buffer.push(t)},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete()},e.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(OuterSubscriber_1.OuterSubscriber),MergeAllSubscriber_1=MergeAllSubscriber,mergeAll_1={mergeAll:mergeAll_2,MergeAllOperator:MergeAllOperator_1,MergeAllSubscriber:MergeAllSubscriber_1};function concat(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return this.lift.call(concatStatic.apply(void 0,[this].concat(t)))}var concat_2=concat;function concatStatic(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=null,n=t;return isScheduler_1.isScheduler(n[t.length-1])&&(r=n.pop()),null===r&&1===t.length&&t[0]instanceof Observable_1.Observable?t[0]:new ArrayObservable_1.ArrayObservable(t,r).lift(new mergeAll_1.MergeAllOperator(1))}var concatStatic_1=concatStatic,concat_1={concat:concat_2,concatStatic:concatStatic_1},concat_2$1=concat_1.concatStatic,concat$1={concat:concat_2$1};Observable_1.Observable.concat=concat$1.concat;var __extends$f=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},DeferObservable=function(t){function e(e){t.call(this),this.observableFactory=e}return __extends$f(e,t),e.create=function(t){return new e(t)},e.prototype._subscribe=function(t){return new DeferSubscriber(t,this.observableFactory)},e}(Observable_1.Observable),DeferObservable_2=DeferObservable,DeferSubscriber=function(t){function e(e,r){t.call(this,e),this.factory=r,this.tryDefer()}return __extends$f(e,t),e.prototype.tryDefer=function(){try{this._callFactory()}catch(t){this._error(t)}},e.prototype._callFactory=function(){var t=this.factory();t&&this.add(subscribeToResult_1.subscribeToResult(this,t))},e}(OuterSubscriber_1.OuterSubscriber),DeferObservable_1={DeferObservable:DeferObservable_2},defer_1=DeferObservable_1.DeferObservable.create,defer={defer:defer_1};Observable_1.Observable.defer=defer.defer;var empty_1=EmptyObservable_1.EmptyObservable.create,empty$1={empty:empty_1};Observable_1.Observable.empty=empty$1.empty;var __extends$g=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},ForkJoinObservable=function(t){function e(e,r){t.call(this),this.sources=e,this.resultSelector=r}return __extends$g(e,t),e.create=function(){for(var t=[],r=0;r<arguments.length;r++)t[r-0]=arguments[r];if(null===t||0===arguments.length)return new EmptyObservable_1.EmptyObservable;var n=null;return"function"==typeof t[t.length-1]&&(n=t.pop()),1===t.length&&isArray.isArray(t[0])&&(t=t[0]),0===t.length?new EmptyObservable_1.EmptyObservable:new e(t,n)},e.prototype._subscribe=function(t){return new ForkJoinSubscriber(t,this.sources,this.resultSelector)},e}(Observable_1.Observable),ForkJoinObservable_2=ForkJoinObservable,ForkJoinSubscriber=function(t){function e(e,r,n){t.call(this,e),this.sources=r,this.resultSelector=n,this.completed=0,this.haveValues=0;var i=r.length;this.total=i,this.values=new Array(i);for(var o=0;o<i;o++){var s=r[o],a=subscribeToResult_1.subscribeToResult(this,s,null,o);a&&(a.outerIndex=o,this.add(a))}}return __extends$g(e,t),e.prototype.notifyNext=function(t,e,r,n,i){this.values[r]=e,i._hasValue||(i._hasValue=!0,this.haveValues++)},e.prototype.notifyComplete=function(t){var e=this.destination,r=this.haveValues,n=this.resultSelector,i=this.values,o=i.length;if(t._hasValue){if(this.completed++,this.completed===o){if(r===o){var s=n?n.apply(this,i):i;e.next(s)}e.complete()}}else e.complete()},e}(OuterSubscriber_1.OuterSubscriber),ForkJoinObservable_1={ForkJoinObservable:ForkJoinObservable_2},forkJoin_1=ForkJoinObservable_1.ForkJoinObservable.create,forkJoin={forkJoin:forkJoin_1};Observable_1.Observable.forkJoin=forkJoin.forkJoin;var __extends$h=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},PromiseObservable=function(t){function e(e,r){t.call(this),this.promise=e,this.scheduler=r}return __extends$h(e,t),e.create=function(t,r){return new e(t,r)},e.prototype._subscribe=function(t){var e=this,r=this.promise,n=this.scheduler;if(null==n)this._isScalar?t.closed||(t.next(this.value),t.complete()):r.then(function(r){e.value=r,e._isScalar=!0,t.closed||(t.next(r),t.complete())},function(e){t.closed||t.error(e)}).then(null,function(t){root.root.setTimeout(function(){throw t})});else if(this._isScalar){if(!t.closed)return n.schedule(dispatchNext$2,0,{value:this.value,subscriber:t})}else r.then(function(r){e.value=r,e._isScalar=!0,t.closed||t.add(n.schedule(dispatchNext$2,0,{value:r,subscriber:t}))},function(e){t.closed||t.add(n.schedule(dispatchError$2,0,{err:e,subscriber:t}))}).then(null,function(t){root.root.setTimeout(function(){throw t})})},e}(Observable_1.Observable),PromiseObservable_2=PromiseObservable;function dispatchNext$2(t){var e=t.value,r=t.subscriber;r.closed||(r.next(e),r.complete())}function dispatchError$2(t){var e=t.err,r=t.subscriber;r.closed||r.error(e)}var PromiseObservable_1={PromiseObservable:PromiseObservable_2},__extends$i=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},IteratorObservable=function(t){function e(e,r){if(t.call(this),this.scheduler=r,null==e)throw new Error("iterator cannot be null.");this.iterator=getIterator(e)}return __extends$i(e,t),e.create=function(t,r){return new e(t,r)},e.dispatch=function(t){var e=t.index,r=t.hasError,n=t.iterator,i=t.subscriber;if(r)i.error(t.error);else{var o=n.next();o.done?i.complete():(i.next(o.value),t.index=e+1,i.closed?"function"==typeof n.return&&n.return():this.schedule(t))}},e.prototype._subscribe=function(t){var r=this.iterator,n=this.scheduler;if(n)return n.schedule(e.dispatch,0,{index:0,iterator:r,subscriber:t});for(;;){var i=r.next();if(i.done){t.complete();break}if(t.next(i.value),t.closed){"function"==typeof r.return&&r.return();break}}},e}(Observable_1.Observable),IteratorObservable_2=IteratorObservable,StringIterator=function(){function t(t,e,r){void 0===e&&(e=0),void 0===r&&(r=t.length),this.str=t,this.idx=e,this.len=r}return t.prototype[iterator.iterator]=function(){return this},t.prototype.next=function(){return this.idx<this.len?{done:!1,value:this.str.charAt(this.idx++)}:{done:!0,value:void 0}},t}(),ArrayIterator=function(){function t(t,e,r){void 0===e&&(e=0),void 0===r&&(r=toLength(t)),this.arr=t,this.idx=e,this.len=r}return t.prototype[iterator.iterator]=function(){return this},t.prototype.next=function(){return this.idx<this.len?{done:!1,value:this.arr[this.idx++]}:{done:!0,value:void 0}},t}();function getIterator(t){var e=t[iterator.iterator];if(!e&&"string"==typeof t)return new StringIterator(t);if(!e&&void 0!==t.length)return new ArrayIterator(t);if(!e)throw new TypeError("object is not iterable");return t[iterator.iterator]()}var maxSafeInteger=Math.pow(2,53)-1;function toLength(t){var e=+t.length;return isNaN(e)?0:0!==e&&numberIsFinite(e)?(e=sign(e)*Math.floor(Math.abs(e)))<=0?0:e>maxSafeInteger?maxSafeInteger:e:e}function numberIsFinite(t){return"number"==typeof t&&root.root.isFinite(t)}function sign(t){var e=+t;return 0===e?e:isNaN(e)?e:e<0?-1:1}var IteratorObservable_1={IteratorObservable:IteratorObservable_2},__extends$j=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},ArrayLikeObservable=function(t){function e(e,r){t.call(this),this.arrayLike=e,this.scheduler=r,r||1!==e.length||(this._isScalar=!0,this.value=e[0])}return __extends$j(e,t),e.create=function(t,r){var n=t.length;return 0===n?new EmptyObservable_1.EmptyObservable:1===n?new ScalarObservable_1.ScalarObservable(t[0],r):new e(t,r)},e.dispatch=function(t){var e=t.arrayLike,r=t.index,n=t.length,i=t.subscriber;i.closed||(r>=n?i.complete():(i.next(e[r]),t.index=r+1,this.schedule(t)))},e.prototype._subscribe=function(t){var r=this.arrayLike,n=this.scheduler,i=r.length;if(n)return n.schedule(e.dispatch,0,{arrayLike:r,index:0,length:i,subscriber:t});for(var o=0;o<i&&!t.closed;o++)t.next(r[o]);t.complete()},e}(Observable_1.Observable),ArrayLikeObservable_2=ArrayLikeObservable,ArrayLikeObservable_1={ArrayLikeObservable:ArrayLikeObservable_2},Notification=function(){function t(t,e,r){this.kind=t,this.value=e,this.error=r,this.hasValue="N"===t}return t.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},t.prototype.do=function(t,e,r){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return r&&r()}},t.prototype.accept=function(t,e,r){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,r)},t.prototype.toObservable=function(){switch(this.kind){case"N":return Observable_1.Observable.of(this.value);case"E":return Observable_1.Observable.throw(this.error);case"C":return Observable_1.Observable.empty()}throw new Error("unexpected notification kind value")},t.createNext=function(e){return void 0!==e?new t("N",e):this.undefinedValueNotification},t.createError=function(e){return new t("E",void 0,e)},t.createComplete=function(){return this.completeNotification},t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t}(),Notification_2=Notification,Notification_1={Notification:Notification_2},__extends$k=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function observeOn(t,e){return void 0===e&&(e=0),this.lift(new ObserveOnOperator(t,e))}var observeOn_2=observeOn,ObserveOnOperator=function(){function t(t,e){void 0===e&&(e=0),this.scheduler=t,this.delay=e}return t.prototype.call=function(t,e){return e.subscribe(new ObserveOnSubscriber(t,this.scheduler,this.delay))},t}(),ObserveOnOperator_1=ObserveOnOperator,ObserveOnSubscriber=function(t){function e(e,r,n){void 0===n&&(n=0),t.call(this,e),this.scheduler=r,this.delay=n}return __extends$k(e,t),e.dispatch=function(t){var e=t.notification,r=t.destination;e.observe(r),this.unsubscribe()},e.prototype.scheduleMessage=function(t){this.add(this.scheduler.schedule(e.dispatch,this.delay,new ObserveOnMessage(t,this.destination)))},e.prototype._next=function(t){this.scheduleMessage(Notification_1.Notification.createNext(t))},e.prototype._error=function(t){this.scheduleMessage(Notification_1.Notification.createError(t))},e.prototype._complete=function(){this.scheduleMessage(Notification_1.Notification.createComplete())},e}(Subscriber_1.Subscriber),ObserveOnSubscriber_1=ObserveOnSubscriber,ObserveOnMessage=function(){return function(t,e){this.notification=t,this.destination=e}}(),ObserveOnMessage_1=ObserveOnMessage,observeOn_1={observeOn:observeOn_2,ObserveOnOperator:ObserveOnOperator_1,ObserveOnSubscriber:ObserveOnSubscriber_1,ObserveOnMessage:ObserveOnMessage_1},__extends$l=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},FromObservable=function(t){function e(e,r){t.call(this,null),this.ish=e,this.scheduler=r}return __extends$l(e,t),e.create=function(t,r){if(null!=t){if("function"==typeof t[observable.observable])return t instanceof Observable_1.Observable&&!r?t:new e(t,r);if(isArray.isArray(t))return new ArrayObservable_1.ArrayObservable(t,r);if(isPromise_1.isPromise(t))return new PromiseObservable_1.PromiseObservable(t,r);if("function"==typeof t[iterator.iterator]||"string"==typeof t)return new IteratorObservable_1.IteratorObservable(t,r);if(isArrayLike.isArrayLike(t))return new ArrayLikeObservable_1.ArrayLikeObservable(t,r)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")},e.prototype._subscribe=function(t){var e=this.ish,r=this.scheduler;return null==r?e[observable.observable]().subscribe(t):e[observable.observable]().subscribe(new observeOn_1.ObserveOnSubscriber(t,r,0))},e}(Observable_1.Observable),FromObservable_2=FromObservable,FromObservable_1={FromObservable:FromObservable_2},from_2=FromObservable_1.FromObservable.create,from_1={from:from_2};Observable_1.Observable.from=from_1.from;var __extends$m=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},toString=Object.prototype.toString;function isNodeStyleEventEmitter(t){return!!t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}function isJQueryStyleEventEmitter(t){return!!t&&"function"==typeof t.on&&"function"==typeof t.off}function isNodeList(t){return!!t&&"[object NodeList]"===toString.call(t)}function isHTMLCollection(t){return!!t&&"[object HTMLCollection]"===toString.call(t)}function isEventTarget(t){return!!t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}var FromEventObservable=function(t){function e(e,r,n,i){t.call(this),this.sourceObj=e,this.eventName=r,this.selector=n,this.options=i}return __extends$m(e,t),e.create=function(t,r,n,i){return isFunction_1.isFunction(n)&&(i=n,n=void 0),new e(t,r,i,n)},e.setupSubscription=function(t,r,n,i,o){var s;if(isNodeList(t)||isHTMLCollection(t))for(var a=0,c=t.length;a<c;a++)e.setupSubscription(t[a],r,n,i,o);else if(isEventTarget(t)){var u=t;t.addEventListener(r,n,o),s=function(){return u.removeEventListener(r,n)}}else if(isJQueryStyleEventEmitter(t)){var l=t;t.on(r,n),s=function(){return l.off(r,n)}}else{if(!isNodeStyleEventEmitter(t))throw new TypeError("Invalid event target");var h=t;t.addListener(r,n),s=function(){return h.removeListener(r,n)}}i.add(new Subscription_1.Subscription(s))},e.prototype._subscribe=function(t){var r=this.sourceObj,n=this.eventName,i=this.options,o=this.selector,s=o?function(){for(var e=[],r=0;r<arguments.length;r++)e[r-0]=arguments[r];var n=tryCatch_1.tryCatch(o).apply(void 0,e);n===errorObject.errorObject?t.error(errorObject.errorObject.e):t.next(n)}:function(e){return t.next(e)};e.setupSubscription(r,n,s,t,i)},e}(Observable_1.Observable),FromEventObservable_2=FromEventObservable,FromEventObservable_1={FromEventObservable:FromEventObservable_2},fromEvent_1=FromEventObservable_1.FromEventObservable.create,fromEvent={fromEvent:fromEvent_1};Observable_1.Observable.fromEvent=fromEvent.fromEvent;var __extends$n=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},FromEventPatternObservable=function(t){function e(e,r,n){t.call(this),this.addHandler=e,this.removeHandler=r,this.selector=n}return __extends$n(e,t),e.create=function(t,r,n){return new e(t,r,n)},e.prototype._subscribe=function(t){var e=this,r=this.removeHandler,n=this.selector?function(){for(var r=[],n=0;n<arguments.length;n++)r[n-0]=arguments[n];e._callSelector(t,r)}:function(e){t.next(e)},i=this._callAddHandler(n,t);isFunction_1.isFunction(r)&&t.add(new Subscription_1.Subscription(function(){r(n,i)}))},e.prototype._callSelector=function(t,e){try{var r=this.selector.apply(this,e);t.next(r)}catch(e){t.error(e)}},e.prototype._callAddHandler=function(t,e){try{return this.addHandler(t)||null}catch(t){e.error(t)}},e}(Observable_1.Observable),FromEventPatternObservable_2=FromEventPatternObservable,FromEventPatternObservable_1={FromEventPatternObservable:FromEventPatternObservable_2},fromEventPattern_1=FromEventPatternObservable_1.FromEventPatternObservable.create,fromEventPattern={fromEventPattern:fromEventPattern_1};Observable_1.Observable.fromEventPattern=fromEventPattern.fromEventPattern;var fromPromise_1=PromiseObservable_1.PromiseObservable.create,fromPromise={fromPromise:fromPromise_1};Observable_1.Observable.fromPromise=fromPromise.fromPromise;var __extends$o=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},selfSelector=function(t){return t},GenerateObservable=function(t){function e(e,r,n,i,o){t.call(this),this.initialState=e,this.condition=r,this.iterate=n,this.resultSelector=i,this.scheduler=o}return __extends$o(e,t),e.create=function(t,r,n,i,o){return 1==arguments.length?new e(t.initialState,t.condition,t.iterate,t.resultSelector||selfSelector,t.scheduler):void 0===i||isScheduler_1.isScheduler(i)?new e(t,r,n,selfSelector,i):new e(t,r,n,i,o)},e.prototype._subscribe=function(t){var r=this.initialState;if(this.scheduler)return this.scheduler.schedule(e.dispatch,0,{subscriber:t,iterate:this.iterate,condition:this.condition,resultSelector:this.resultSelector,state:r});for(var n=this.condition,i=this.resultSelector,o=this.iterate;;){if(n){var s=void 0;try{s=n(r)}catch(e){return void t.error(e)}if(!s){t.complete();break}}var a=void 0;try{a=i(r)}catch(e){return void t.error(e)}if(t.next(a),t.closed)break;try{r=o(r)}catch(e){return void t.error(e)}}},e.dispatch=function(t){var e=t.subscriber,r=t.condition;if(!e.closed){if(t.needIterate)try{t.state=t.iterate(t.state)}catch(t){return void e.error(t)}else t.needIterate=!0;if(r){var n=void 0;try{n=r(t.state)}catch(t){return void e.error(t)}if(!n)return void e.complete();if(e.closed)return}var i;try{i=t.resultSelector(t.state)}catch(t){return void e.error(t)}if(!e.closed&&(e.next(i),!e.closed))return this.schedule(t)}},e}(Observable_1.Observable),GenerateObservable_2=GenerateObservable,GenerateObservable_1={GenerateObservable:GenerateObservable_2};Observable_1.Observable.generate=GenerateObservable_1.GenerateObservable.create;var __extends$p=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},IfObservable=function(t){function e(e,r,n){t.call(this),this.condition=e,this.thenSource=r,this.elseSource=n}return __extends$p(e,t),e.create=function(t,r,n){return new e(t,r,n)},e.prototype._subscribe=function(t){var e=this.condition,r=this.thenSource,n=this.elseSource;return new IfSubscriber(t,e,r,n)},e}(Observable_1.Observable),IfObservable_2=IfObservable,IfSubscriber=function(t){function e(e,r,n,i){t.call(this,e),this.condition=r,this.thenSource=n,this.elseSource=i,this.tryIf()}return __extends$p(e,t),e.prototype.tryIf=function(){var t=this.condition,e=this.thenSource,r=this.elseSource;try{var n=t()?e:r;n?this.add(subscribeToResult_1.subscribeToResult(this,n)):this._complete()}catch(t){this._error(t)}},e}(OuterSubscriber_1.OuterSubscriber),IfObservable_1={IfObservable:IfObservable_2},_if_1=IfObservable_1.IfObservable.create,_if={_if:_if_1};function isNumeric(t){return!isArray.isArray(t)&&t-parseFloat(t)+1>=0}Observable_1.Observable.if=_if._if;var isNumeric_2=isNumeric,isNumeric_1={isNumeric:isNumeric_2},__extends$q=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},Action=function(t){function e(e,r){t.call(this)}return __extends$q(e,t),e.prototype.schedule=function(t,e){return this},e}(Subscription_1.Subscription),Action_2=Action,Action_1={Action:Action_2},__extends$r=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},AsyncAction=function(t){function e(e,r){t.call(this,e,r),this.scheduler=e,this.work=r,this.pending=!1}return __extends$r(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t,this.pending=!0;var r=this.id,n=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(n,r,e)),this.delay=e,this.id=this.id||this.requestAsyncId(n,this.id,e),this},e.prototype.requestAsyncId=function(t,e,r){return void 0===r&&(r=0),root.root.setInterval(t.flush.bind(t,this),r)},e.prototype.recycleAsyncId=function(t,e,r){if(void 0===r&&(r=0),null!==r&&this.delay===r&&!1===this.pending)return e;root.root.clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(t,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var r=!1,n=void 0;try{this.work(t)}catch(t){r=!0,n=!!t&&t||new Error(t)}if(r)return this.unsubscribe(),n},e.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,r=e.actions,n=r.indexOf(this);this.work=null,this.delay=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==n&&r.splice(n,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null))},e}(Action_1.Action),AsyncAction_2=AsyncAction,AsyncAction_1={AsyncAction:AsyncAction_2},Scheduler=function(){function t(e,r){void 0===r&&(r=t.now),this.SchedulerAction=e,this.now=r}return t.prototype.schedule=function(t,e,r){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(r,e)},t.now=Date.now?Date.now:function(){return+new Date},t}(),Scheduler_2=Scheduler,Scheduler_1={Scheduler:Scheduler_2},__extends$s=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},AsyncScheduler=function(t){function e(){t.apply(this,arguments),this.actions=[],this.active=!1,this.scheduled=void 0}return __extends$s(e,t),e.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var r;this.active=!0;do{if(r=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,r){for(;t=e.shift();)t.unsubscribe();throw r}}},e}(Scheduler_1.Scheduler),AsyncScheduler_2=AsyncScheduler,AsyncScheduler_1={AsyncScheduler:AsyncScheduler_2},async_1=new AsyncScheduler_1.AsyncScheduler(AsyncAction_1.AsyncAction),async={async:async_1},__extends$t=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},IntervalObservable=function(t){function e(e,r){void 0===e&&(e=0),void 0===r&&(r=async.async),t.call(this),this.period=e,this.scheduler=r,(!isNumeric_1.isNumeric(e)||e<0)&&(this.period=0),r&&"function"==typeof r.schedule||(this.scheduler=async.async)}return __extends$t(e,t),e.create=function(t,r){return void 0===t&&(t=0),void 0===r&&(r=async.async),new e(t,r)},e.dispatch=function(t){var e=t.index,r=t.subscriber,n=t.period;r.next(e),r.closed||(t.index+=1,this.schedule(t,n))},e.prototype._subscribe=function(t){var r=this.period,n=this.scheduler;t.add(n.schedule(e.dispatch,r,{index:0,subscriber:t,period:r}))},e}(Observable_1.Observable),IntervalObservable_2=IntervalObservable,IntervalObservable_1={IntervalObservable:IntervalObservable_2},interval_1=IntervalObservable_1.IntervalObservable.create,interval={interval:interval_1};function merge(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return this.lift.call(mergeStatic.apply(void 0,[this].concat(t)))}Observable_1.Observable.interval=interval.interval;var merge_2=merge;function mergeStatic(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=Number.POSITIVE_INFINITY,n=null,i=t[t.length-1];return isScheduler_1.isScheduler(i)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(r=t.pop())):"number"==typeof i&&(r=t.pop()),null===n&&1===t.length&&t[0]instanceof Observable_1.Observable?t[0]:new ArrayObservable_1.ArrayObservable(t,n).lift(new mergeAll_1.MergeAllOperator(r))}var mergeStatic_1=mergeStatic,merge_1={merge:merge_2,mergeStatic:mergeStatic_1},merge_2$1=merge_1.mergeStatic,merge$1={merge:merge_2$1};Observable_1.Observable.merge=merge$1.merge;var __extends$u=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function race(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return 1===t.length&&isArray.isArray(t[0])&&(t=t[0]),this.lift.call(raceStatic.apply(void 0,[this].concat(t)))}var race_2=race;function raceStatic(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];if(1===t.length){if(!isArray.isArray(t[0]))return t[0];t=t[0]}return new ArrayObservable_1.ArrayObservable(t).lift(new RaceOperator)}var raceStatic_1=raceStatic,RaceOperator=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new RaceSubscriber(t))},t}(),RaceOperator_1=RaceOperator,RaceSubscriber=function(t){function e(e){t.call(this,e),this.hasFirst=!1,this.observables=[],this.subscriptions=[]}return __extends$u(e,t),e.prototype._next=function(t){this.observables.push(t)},e.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{for(var r=0;r<e&&!this.hasFirst;r++){var n=t[r],i=subscribeToResult_1.subscribeToResult(this,n,n,r);this.subscriptions&&this.subscriptions.push(i),this.add(i)}this.observables=null}},e.prototype.notifyNext=function(t,e,r,n,i){if(!this.hasFirst){this.hasFirst=!0;for(var o=0;o<this.subscriptions.length;o++)if(o!==r){var s=this.subscriptions[o];s.unsubscribe(),this.remove(s)}this.subscriptions=null}this.destination.next(e)},e}(OuterSubscriber_1.OuterSubscriber),RaceSubscriber_1=RaceSubscriber,race_1={race:race_2,raceStatic:raceStatic_1,RaceOperator:RaceOperator_1,RaceSubscriber:RaceSubscriber_1};Observable_1.Observable.race=race_1.raceStatic;var __extends$v=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},NeverObservable=function(t){function e(){t.call(this)}return __extends$v(e,t),e.create=function(){return new e},e.prototype._subscribe=function(t){},e}(Observable_1.Observable),NeverObservable_2=NeverObservable,NeverObservable_1={NeverObservable:NeverObservable_2},never_1=NeverObservable_1.NeverObservable.create,never={never:never_1};Observable_1.Observable.never=never.never;var of_1=ArrayObservable_1.ArrayObservable.of,of={of:of_1};Observable_1.Observable.of=of.of;var __extends$w=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function onErrorResumeNext(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return 1===t.length&&isArray.isArray(t[0])&&(t=t[0]),this.lift(new OnErrorResumeNextOperator(t))}var onErrorResumeNext_2=onErrorResumeNext;function onErrorResumeNextStatic(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r;return 1===t.length&&isArray.isArray(t[0])&&(t=t[0]),r=t.shift(),new FromObservable_1.FromObservable(r,null).lift(new OnErrorResumeNextOperator(t))}var onErrorResumeNextStatic_1=onErrorResumeNextStatic,OnErrorResumeNextOperator=function(){function t(t){this.nextSources=t}return t.prototype.call=function(t,e){return e.subscribe(new OnErrorResumeNextSubscriber(t,this.nextSources))},t}(),OnErrorResumeNextSubscriber=function(t){function e(e,r){t.call(this,e),this.destination=e,this.nextSources=r}return __extends$w(e,t),e.prototype.notifyError=function(t,e){this.subscribeToNextSource()},e.prototype.notifyComplete=function(t){this.subscribeToNextSource()},e.prototype._error=function(t){this.subscribeToNextSource()},e.prototype._complete=function(){this.subscribeToNextSource()},e.prototype.subscribeToNextSource=function(){var t=this.nextSources.shift();t?this.add(subscribeToResult_1.subscribeToResult(this,t)):this.destination.complete()},e}(OuterSubscriber_1.OuterSubscriber),onErrorResumeNext_1={onErrorResumeNext:onErrorResumeNext_2,onErrorResumeNextStatic:onErrorResumeNextStatic_1};Observable_1.Observable.onErrorResumeNext=onErrorResumeNext_1.onErrorResumeNextStatic;var __extends$x=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function dispatch$1(t){var e=t.obj,r=t.keys,n=t.length,i=t.index,o=t.subscriber;if(i!==n){var s=r[i];o.next([s,e[s]]),t.index=i+1,this.schedule(t)}else o.complete()}var PairsObservable=function(t){function e(e,r){t.call(this),this.obj=e,this.scheduler=r,this.keys=Object.keys(e)}return __extends$x(e,t),e.create=function(t,r){return new e(t,r)},e.prototype._subscribe=function(t){var e=this.keys,r=this.scheduler,n=e.length;if(r)return r.schedule(dispatch$1,0,{obj:this.obj,keys:e,length:n,index:0,subscriber:t});for(var i=0;i<n;i++){var o=e[i];t.next([o,this.obj[o]])}t.complete()},e}(Observable_1.Observable),PairsObservable_2=PairsObservable,PairsObservable_1={PairsObservable:PairsObservable_2},pairs_1=PairsObservable_1.PairsObservable.create,pairs={pairs:pairs_1};Observable_1.Observable.pairs=pairs.pairs;var __extends$y=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},RangeObservable=function(t){function e(e,r,n){t.call(this),this.start=e,this._count=r,this.scheduler=n}return __extends$y(e,t),e.create=function(t,r,n){return void 0===t&&(t=0),void 0===r&&(r=0),new e(t,r,n)},e.dispatch=function(t){var e=t.start,r=t.index,n=t.count,i=t.subscriber;r>=n?i.complete():(i.next(e),i.closed||(t.index=r+1,t.start=e+1,this.schedule(t)))},e.prototype._subscribe=function(t){var r=0,n=this.start,i=this._count,o=this.scheduler;if(o)return o.schedule(e.dispatch,0,{index:r,count:i,start:n,subscriber:t});for(;;){if(r++>=i){t.complete();break}if(t.next(n++),t.closed)break}},e}(Observable_1.Observable),RangeObservable_2=RangeObservable,RangeObservable_1={RangeObservable:RangeObservable_2},range_1=RangeObservable_1.RangeObservable.create,range={range:range_1};Observable_1.Observable.range=range.range;var __extends$z=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},UsingObservable=function(t){function e(e,r){t.call(this),this.resourceFactory=e,this.observableFactory=r}return __extends$z(e,t),e.create=function(t,r){return new e(t,r)},e.prototype._subscribe=function(t){var e,r=this.resourceFactory,n=this.observableFactory;try{return e=r(),new UsingSubscriber(t,e,n)}catch(e){t.error(e)}},e}(Observable_1.Observable),UsingObservable_2=UsingObservable,UsingSubscriber=function(t){function e(e,r,n){t.call(this,e),this.resource=r,this.observableFactory=n,e.add(r),this.tryUse()}return __extends$z(e,t),e.prototype.tryUse=function(){try{var t=this.observableFactory.call(this,this.resource);t&&this.add(subscribeToResult_1.subscribeToResult(this,t))}catch(t){this._error(t)}},e}(OuterSubscriber_1.OuterSubscriber),UsingObservable_1={UsingObservable:UsingObservable_2},using_1=UsingObservable_1.UsingObservable.create,using={using:using_1};Observable_1.Observable.using=using.using;var __extends$A=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},ErrorObservable=function(t){function e(e,r){t.call(this),this.error=e,this.scheduler=r}return __extends$A(e,t),e.create=function(t,r){return new e(t,r)},e.dispatch=function(t){var e=t.error;t.subscriber.error(e)},e.prototype._subscribe=function(t){var r=this.error,n=this.scheduler;if(n)return n.schedule(e.dispatch,0,{error:r,subscriber:t});t.error(r)},e}(Observable_1.Observable),ErrorObservable_2=ErrorObservable,ErrorObservable_1={ErrorObservable:ErrorObservable_2},_throw_1=ErrorObservable_1.ErrorObservable.create,_throw={_throw:_throw_1};function isDate(t){return t instanceof Date&&!isNaN(+t)}Observable_1.Observable.throw=_throw._throw;var isDate_2=isDate,isDate_1={isDate:isDate_2},__extends$B=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},TimerObservable=function(t){function e(e,r,n){void 0===e&&(e=0),t.call(this),this.period=-1,this.dueTime=0,isNumeric_1.isNumeric(r)?this.period=Number(r)<1?1:Number(r):isScheduler_1.isScheduler(r)&&(n=r),isScheduler_1.isScheduler(n)||(n=async.async),this.scheduler=n,this.dueTime=isDate_1.isDate(e)?+e-this.scheduler.now():e}return __extends$B(e,t),e.create=function(t,r,n){return void 0===t&&(t=0),new e(t,r,n)},e.dispatch=function(t){var e=t.index,r=t.period,n=t.subscriber;if(n.next(e),!n.closed){if(-1===r)return n.complete();t.index=e+1,this.schedule(t,r)}},e.prototype._subscribe=function(t){var r=this.period,n=this.dueTime;return this.scheduler.schedule(e.dispatch,n,{index:0,period:r,subscriber:t})},e}(Observable_1.Observable),TimerObservable_2=TimerObservable,TimerObservable_1={TimerObservable:TimerObservable_2},timer_1=TimerObservable_1.TimerObservable.create,timer={timer:timer_1};Observable_1.Observable.timer=timer.timer;var __extends$C=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function zipProto(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return this.lift.call(zipStatic.apply(void 0,[this].concat(t)))}var zipProto_1=zipProto;function zipStatic(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=t[t.length-1];return"function"==typeof r&&t.pop(),new ArrayObservable_1.ArrayObservable(t).lift(new ZipOperator(r))}var zipStatic_1=zipStatic,ZipOperator=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new ZipSubscriber(t,this.project))},t}(),ZipOperator_1=ZipOperator,ZipSubscriber=function(t){function e(e,r,n){void 0===n&&(n=Object.create(null)),t.call(this,e),this.iterators=[],this.active=0,this.project="function"==typeof r?r:null,this.values=n}return __extends$C(e,t),e.prototype._next=function(t){var e=this.iterators;isArray.isArray(t)?e.push(new StaticArrayIterator(t)):"function"==typeof t[iterator.iterator]?e.push(new StaticIterator(t[iterator.iterator]())):e.push(new ZipBufferIterator(this.destination,this,t))},e.prototype._complete=function(){var t=this.iterators,e=t.length;if(0!==e){this.active=e;for(var r=0;r<e;r++){var n=t[r];n.stillUnsubscribed?this.add(n.subscribe(n,r)):this.active--}}else this.destination.complete()},e.prototype.notifyInactive=function(){this.active--,0===this.active&&this.destination.complete()},e.prototype.checkIterators=function(){for(var t=this.iterators,e=t.length,r=this.destination,n=0;n<e;n++){if("function"==typeof(s=t[n]).hasValue&&!s.hasValue())return}var i=!1,o=[];for(n=0;n<e;n++){var s,a=(s=t[n]).next();if(s.hasCompleted()&&(i=!0),a.done)return void r.complete();o.push(a.value)}this.project?this._tryProject(o):r.next(o),i&&r.complete()},e.prototype._tryProject=function(t){var e;try{e=this.project.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(Subscriber_1.Subscriber),ZipSubscriber_1=ZipSubscriber,StaticIterator=function(){function t(t){this.iterator=t,this.nextResult=t.next()}return t.prototype.hasValue=function(){return!0},t.prototype.next=function(){var t=this.nextResult;return this.nextResult=this.iterator.next(),t},t.prototype.hasCompleted=function(){var t=this.nextResult;return t&&t.done},t}(),StaticArrayIterator=function(){function t(t){this.array=t,this.index=0,this.length=0,this.length=t.length}return t.prototype[iterator.iterator]=function(){return this},t.prototype.next=function(t){var e=this.index++,r=this.array;return e<this.length?{value:r[e],done:!1}:{value:null,done:!0}},t.prototype.hasValue=function(){return this.array.length>this.index},t.prototype.hasCompleted=function(){return this.array.length===this.index},t}(),ZipBufferIterator=function(t){function e(e,r,n){t.call(this,e),this.parent=r,this.observable=n,this.stillUnsubscribed=!0,this.buffer=[],this.isComplete=!1}return __extends$C(e,t),e.prototype[iterator.iterator]=function(){return this},e.prototype.next=function(){var t=this.buffer;return 0===t.length&&this.isComplete?{value:null,done:!0}:{value:t.shift(),done:!1}},e.prototype.hasValue=function(){return this.buffer.length>0},e.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete},e.prototype.notifyComplete=function(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},e.prototype.notifyNext=function(t,e,r,n,i){this.buffer.push(e),this.parent.checkIterators()},e.prototype.subscribe=function(t,e){return subscribeToResult_1.subscribeToResult(this,this.observable,this,e)},e}(OuterSubscriber_1.OuterSubscriber),zip={zipProto:zipProto_1,zipStatic:zipStatic_1,ZipOperator:ZipOperator_1,ZipSubscriber:ZipSubscriber_1},zip_2=zip.zipStatic,zip$1={zip:zip_2};Observable_1.Observable.zip=zip$1.zip;var __extends$D=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function map(t,e){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return this.lift(new MapOperator(t,e))}var map_2=map,MapOperator=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new MapSubscriber(t,this.project,this.thisArg))},t}(),MapOperator_1=MapOperator,MapSubscriber=function(t){function e(e,r,n){t.call(this,e),this.project=r,this.count=0,this.thisArg=n||this}return __extends$D(e,t),e.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(Subscriber_1.Subscriber),map_1={map:map_2,MapOperator:MapOperator_1},__extends$E=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function getCORSRequest(){if(root.root.XMLHttpRequest)return new root.root.XMLHttpRequest;if(root.root.XDomainRequest)return new root.root.XDomainRequest;throw new Error("CORS is not supported by your browser")}function getXMLHttpRequest(){if(root.root.XMLHttpRequest)return new root.root.XMLHttpRequest;var t=void 0;try{for(var e=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],r=0;r<3;r++)try{if(t=e[r],new root.root.ActiveXObject(t))break}catch(t){}return new root.root.ActiveXObject(t)}catch(t){throw new Error("XMLHttpRequest is not supported by your browser")}}function ajaxGet(t,e){return void 0===e&&(e=null),new AjaxObservable({method:"GET",url:t,headers:e})}var ajaxGet_1=ajaxGet;function ajaxPost(t,e,r){return new AjaxObservable({method:"POST",url:t,body:e,headers:r})}var ajaxPost_1=ajaxPost;function ajaxDelete(t,e){return new AjaxObservable({method:"DELETE",url:t,headers:e})}var ajaxDelete_1=ajaxDelete;function ajaxPut(t,e,r){return new AjaxObservable({method:"PUT",url:t,body:e,headers:r})}var ajaxPut_1=ajaxPut;function ajaxPatch(t,e,r){return new AjaxObservable({method:"PATCH",url:t,body:e,headers:r})}var ajaxPatch_1=ajaxPatch;function ajaxGetJSON(t,e){return new AjaxObservable({method:"GET",url:t,responseType:"json",headers:e}).lift(new map_1.MapOperator(function(t,e){return t.response},null))}var ajaxGetJSON_1=ajaxGetJSON,AjaxObservable=function(t){function e(e){t.call(this);var r={async:!0,createXHR:function(){return this.crossDomain?getCORSRequest.call(this):getXMLHttpRequest()},crossDomain:!1,withCredentials:!1,headers:{},method:"GET",responseType:"json",timeout:0};if("string"==typeof e)r.url=e;else for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);this.request=r}var r;return __extends$E(e,t),e.prototype._subscribe=function(t){return new AjaxSubscriber(t,this.request)},e.create=((r=function(t){return new e(t)}).get=ajaxGet,r.post=ajaxPost,r.delete=ajaxDelete,r.put=ajaxPut,r.patch=ajaxPatch,r.getJSON=ajaxGetJSON,r),e}(Observable_1.Observable),AjaxObservable_2=AjaxObservable,AjaxSubscriber=function(t){function e(e,r){t.call(this,e),this.request=r,this.done=!1;var n=r.headers=r.headers||{};r.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest"),"Content-Type"in n||root.root.FormData&&r.body instanceof root.root.FormData||void 0===r.body||(n["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8"),r.body=this.serializeBody(r.body,r.headers["Content-Type"]),this.send()}return __extends$E(e,t),e.prototype.next=function(t){this.done=!0;var e=this.xhr,r=this.request,n=this.destination,i=new AjaxResponse(t,e,r);n.next(i)},e.prototype.send=function(){var t=this.request,e=this.request,r=e.user,n=e.method,i=e.url,o=e.async,s=e.password,a=e.headers,c=e.body,u=t.createXHR,l=tryCatch_1.tryCatch(u).call(t);if(l===errorObject.errorObject)this.error(errorObject.errorObject.e);else{this.xhr=l,this.setupEvents(l,t);if((r?tryCatch_1.tryCatch(l.open).call(l,n,i,o,r,s):tryCatch_1.tryCatch(l.open).call(l,n,i,o))===errorObject.errorObject)return this.error(errorObject.errorObject.e),null;if(l.timeout=t.timeout,l.responseType=t.responseType,"withCredentials"in l&&(l.withCredentials=!!t.withCredentials),this.setHeaders(l,a),(c?tryCatch_1.tryCatch(l.send).call(l,c):tryCatch_1.tryCatch(l.send).call(l))===errorObject.errorObject)return this.error(errorObject.errorObject.e),null}return l},e.prototype.serializeBody=function(t,e){if(!t||"string"==typeof t)return t;if(root.root.FormData&&t instanceof root.root.FormData)return t;if(e){var r=e.indexOf(";");-1!==r&&(e=e.substring(0,r))}switch(e){case"application/x-www-form-urlencoded":return Object.keys(t).map(function(e){return encodeURI(e)+"="+encodeURI(t[e])}).join("&");case"application/json":return JSON.stringify(t);default:return t}},e.prototype.setHeaders=function(t,e){for(var r in e)e.hasOwnProperty(r)&&t.setRequestHeader(r,e[r])},e.prototype.setupEvents=function(t,e){var r=e.progressSubscriber;function n(t){var e=n,r=e.subscriber,i=e.progressSubscriber,o=e.request;i&&i.error(t),r.error(new AjaxTimeoutError(this,o))}if(t.ontimeout=n,n.request=e,n.subscriber=this,n.progressSubscriber=r,t.upload&&"withCredentials"in t){var i,o;if(r)i=function(t){i.progressSubscriber.next(t)},root.root.XDomainRequest?t.onprogress=i:t.upload.onprogress=i,i.progressSubscriber=r;o=function(t){var e=o,r=e.progressSubscriber,n=e.subscriber,i=e.request;r&&r.error(t),n.error(new AjaxError("ajax error",this,i))},t.onerror=o,o.request=e,o.subscriber=this,o.progressSubscriber=r}function s(t){var e=s,r=e.subscriber,n=e.progressSubscriber,i=e.request;if(4===this.readyState){var o=1223===this.status?204:this.status,a="text"===this.responseType?this.response||this.responseText:this.response;0===o&&(o=a?200:0),200<=o&&o<300?(n&&n.complete(),r.next(t),r.complete()):(n&&n.error(t),r.error(new AjaxError("ajax error "+o,this,i)))}}t.onreadystatechange=s,s.subscriber=this,s.progressSubscriber=r,s.request=e},e.prototype.unsubscribe=function(){var e=this.done,r=this.xhr;!e&&r&&4!==r.readyState&&"function"==typeof r.abort&&r.abort(),t.prototype.unsubscribe.call(this)},e}(Subscriber_1.Subscriber),AjaxSubscriber_1=AjaxSubscriber,AjaxResponse=function(){return function(t,e,r){switch(this.originalEvent=t,this.xhr=e,this.request=r,this.status=e.status,this.responseType=e.responseType||r.responseType,this.responseType){case"json":this.response="response"in e?e.responseType?e.response:JSON.parse(e.response||e.responseText||"null"):JSON.parse(e.responseText||"null");break;case"xml":this.response=e.responseXML;break;case"text":default:this.response="response"in e?e.response:e.responseText}}}(),AjaxResponse_1=AjaxResponse,AjaxError=function(t){function e(e,r,n){t.call(this,e),this.message=e,this.xhr=r,this.request=n,this.status=r.status}return __extends$E(e,t),e}(Error),AjaxError_1=AjaxError,AjaxTimeoutError=function(t){function e(e,r){t.call(this,"ajax timeout",e,r)}return __extends$E(e,t),e}(AjaxError),AjaxTimeoutError_1=AjaxTimeoutError,AjaxObservable_1={ajaxGet:ajaxGet_1,ajaxPost:ajaxPost_1,ajaxDelete:ajaxDelete_1,ajaxPut:ajaxPut_1,ajaxPatch:ajaxPatch_1,ajaxGetJSON:ajaxGetJSON_1,AjaxObservable:AjaxObservable_2,AjaxSubscriber:AjaxSubscriber_1,AjaxResponse:AjaxResponse_1,AjaxError:AjaxError_1,AjaxTimeoutError:AjaxTimeoutError_1},ajax_1=AjaxObservable_1.AjaxObservable.create,ajax={ajax:ajax_1};Observable_1.Observable.ajax=ajax.ajax;var __extends$F=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},QueueAction=function(t){function e(e,r){t.call(this,e,r),this.scheduler=e,this.work=r}return __extends$F(e,t),e.prototype.schedule=function(e,r){return void 0===r&&(r=0),r>0?t.prototype.schedule.call(this,e,r):(this.delay=r,this.state=e,this.scheduler.flush(this),this)},e.prototype.execute=function(e,r){return r>0||this.closed?t.prototype.execute.call(this,e,r):this._execute(e,r)},e.prototype.requestAsyncId=function(e,r,n){return void 0===n&&(n=0),null!==n&&n>0||null===n&&this.delay>0?t.prototype.requestAsyncId.call(this,e,r,n):e.flush(this)},e}(AsyncAction_1.AsyncAction),QueueAction_2=QueueAction,QueueAction_1={QueueAction:QueueAction_2},__extends$G=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},QueueScheduler=function(t){function e(){t.apply(this,arguments)}return __extends$G(e,t),e}(AsyncScheduler_1.AsyncScheduler),QueueScheduler_2=QueueScheduler,QueueScheduler_1={QueueScheduler:QueueScheduler_2},queue_1=new QueueScheduler_1.QueueScheduler(QueueAction_1.QueueAction),queue={queue:queue_1},__extends$H=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},ReplaySubject=function(t){function e(e,r,n){void 0===e&&(e=Number.POSITIVE_INFINITY),void 0===r&&(r=Number.POSITIVE_INFINITY),t.call(this),this.scheduler=n,this._events=[],this._bufferSize=e<1?1:e,this._windowTime=r<1?1:r}return __extends$H(e,t),e.prototype.next=function(e){var r=this._getNow();this._events.push(new ReplayEvent(r,e)),this._trimBufferThenGetEvents(),t.prototype.next.call(this,e)},e.prototype._subscribe=function(t){var e,r=this._trimBufferThenGetEvents(),n=this.scheduler;if(this.closed)throw new ObjectUnsubscribedError_1.ObjectUnsubscribedError;this.hasError?e=Subscription_1.Subscription.EMPTY:this.isStopped?e=Subscription_1.Subscription.EMPTY:(this.observers.push(t),e=new SubjectSubscription_1.SubjectSubscription(this,t)),n&&t.add(t=new observeOn_1.ObserveOnSubscriber(t,n));for(var i=r.length,o=0;o<i&&!t.closed;o++)t.next(r[o].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),e},e.prototype._getNow=function(){return(this.scheduler||queue.queue).now()},e.prototype._trimBufferThenGetEvents=function(){for(var t=this._getNow(),e=this._bufferSize,r=this._windowTime,n=this._events,i=n.length,o=0;o<i&&!(t-n[o].time<r);)o++;return i>e&&(o=Math.max(o,i-e)),o>0&&n.splice(0,o),n},e}(Subject_1.Subject),ReplaySubject_2=ReplaySubject,ReplayEvent=function(){return function(t,e){this.time=t,this.value=e}}(),ReplaySubject_1={ReplaySubject:ReplaySubject_2};function assignImpl(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var n=e.length,i=0;i<n;i++){var o=e[i];for(var s in o)o.hasOwnProperty(s)&&(t[s]=o[s])}return t}var assignImpl_1=assignImpl;function getAssign(t){return t.Object.assign||assignImpl}var getAssign_1=getAssign,assign_1=getAssign(root.root),assign={assignImpl:assignImpl_1,getAssign:getAssign_1,assign:assign_1},__extends$I=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},WebSocketSubject=function(t){function e(e,r){if(e instanceof Observable_1.Observable)t.call(this,r,e);else{if(t.call(this),this.WebSocketCtor=root.root.WebSocket,this._output=new Subject_1.Subject,"string"==typeof e?this.url=e:assign.assign(this,e),!this.WebSocketCtor)throw new Error("no WebSocket constructor can be found");this.destination=new ReplaySubject_1.ReplaySubject}}return __extends$I(e,t),e.prototype.resultSelector=function(t){return JSON.parse(t.data)},e.create=function(t){return new e(t)},e.prototype.lift=function(t){var r=new e(this,this.destination);return r.operator=t,r},e.prototype._resetState=function(){this.socket=null,this.source||(this.destination=new ReplaySubject_1.ReplaySubject),this._output=new Subject_1.Subject},e.prototype.multiplex=function(t,e,r){var n=this;return new Observable_1.Observable(function(i){var o=tryCatch_1.tryCatch(t)();o===errorObject.errorObject?i.error(errorObject.errorObject.e):n.next(o);var s=n.subscribe(function(t){var e=tryCatch_1.tryCatch(r)(t);e===errorObject.errorObject?i.error(errorObject.errorObject.e):e&&i.next(t)},function(t){return i.error(t)},function(){return i.complete()});return function(){var t=tryCatch_1.tryCatch(e)();t===errorObject.errorObject?i.error(errorObject.errorObject.e):n.next(t),s.unsubscribe()}})},e.prototype._connectSocket=function(){var t=this,e=this.WebSocketCtor,r=this._output,n=null;try{n=this.protocol?new e(this.url,this.protocol):new e(this.url),this.socket=n,this.binaryType&&(this.socket.binaryType=this.binaryType)}catch(t){return void r.error(t)}var i=new Subscription_1.Subscription(function(){t.socket=null,n&&1===n.readyState&&n.close()});n.onopen=function(e){var o=t.openObserver;o&&o.next(e);var s=t.destination;t.destination=Subscriber_1.Subscriber.create(function(t){return 1===n.readyState&&n.send(t)},function(e){var i=t.closingObserver;i&&i.next(void 0),e&&e.code?n.close(e.code,e.reason):r.error(new TypeError("WebSocketSubject.error must be called with an object with an error code, and an optional reason: { code: number, reason: string }")),t._resetState()},function(){var e=t.closingObserver;e&&e.next(void 0),n.close(),t._resetState()}),s&&s instanceof ReplaySubject_1.ReplaySubject&&i.add(s.subscribe(t.destination))},n.onerror=function(e){t._resetState(),r.error(e)},n.onclose=function(e){t._resetState();var n=t.closeObserver;n&&n.next(e),e.wasClean?r.complete():r.error(e)},n.onmessage=function(e){var n=tryCatch_1.tryCatch(t.resultSelector)(e);n===errorObject.errorObject?r.error(errorObject.errorObject.e):r.next(n)}},e.prototype._subscribe=function(t){var e=this,r=this.source;if(r)return r.subscribe(t);this.socket||this._connectSocket();var n=new Subscription_1.Subscription;return n.add(this._output.subscribe(t)),n.add(function(){var t=e.socket;0===e._output.observers.length&&(t&&1===t.readyState&&t.close(),e._resetState())}),n},e.prototype.unsubscribe=function(){var e=this.source,r=this.socket;r&&1===r.readyState&&(r.close(),this._resetState()),t.prototype.unsubscribe.call(this),e||(this.destination=new ReplaySubject_1.ReplaySubject)},e}(Subject_1.AnonymousSubject),WebSocketSubject_2=WebSocketSubject,WebSocketSubject_1={WebSocketSubject:WebSocketSubject_2},webSocket_1=WebSocketSubject_1.WebSocketSubject.create,webSocket={webSocket:webSocket_1};Observable_1.Observable.webSocket=webSocket.webSocket;var __extends$J=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function buffer(t){return this.lift(new BufferOperator(t))}var buffer_2=buffer,BufferOperator=function(){function t(t){this.closingNotifier=t}return t.prototype.call=function(t,e){return e.subscribe(new BufferSubscriber(t,this.closingNotifier))},t}(),BufferSubscriber=function(t){function e(e,r){t.call(this,e),this.buffer=[],this.add(subscribeToResult_1.subscribeToResult(this,r))}return __extends$J(e,t),e.prototype._next=function(t){this.buffer.push(t)},e.prototype.notifyNext=function(t,e,r,n,i){var o=this.buffer;this.buffer=[],this.destination.next(o)},e}(OuterSubscriber_1.OuterSubscriber),buffer_1={buffer:buffer_2};Observable_1.Observable.prototype.buffer=buffer_1.buffer;var __extends$K=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function bufferCount(t,e){return void 0===e&&(e=null),this.lift(new BufferCountOperator(t,e))}var bufferCount_2=bufferCount,BufferCountOperator=function(){function t(t,e){this.bufferSize=t,this.startBufferEvery=e,this.subscriberClass=e&&t!==e?BufferSkipCountSubscriber:BufferCountSubscriber}return t.prototype.call=function(t,e){return e.subscribe(new this.subscriberClass(t,this.bufferSize,this.startBufferEvery))},t}(),BufferCountSubscriber=function(t){function e(e,r){t.call(this,e),this.bufferSize=r,this.buffer=[]}return __extends$K(e,t),e.prototype._next=function(t){var e=this.buffer;e.push(t),e.length==this.bufferSize&&(this.destination.next(e),this.buffer=[])},e.prototype._complete=function(){var e=this.buffer;e.length>0&&this.destination.next(e),t.prototype._complete.call(this)},e}(Subscriber_1.Subscriber),BufferSkipCountSubscriber=function(t){function e(e,r,n){t.call(this,e),this.bufferSize=r,this.startBufferEvery=n,this.buffers=[],this.count=0}return __extends$K(e,t),e.prototype._next=function(t){var e=this.bufferSize,r=this.startBufferEvery,n=this.buffers,i=this.count;this.count++,i%r==0&&n.push([]);for(var o=n.length;o--;){var s=n[o];s.push(t),s.length===e&&(n.splice(o,1),this.destination.next(s))}},e.prototype._complete=function(){for(var e=this.buffers,r=this.destination;e.length>0;){var n=e.shift();n.length>0&&r.next(n)}t.prototype._complete.call(this)},e}(Subscriber_1.Subscriber),bufferCount_1={bufferCount:bufferCount_2};Observable_1.Observable.prototype.bufferCount=bufferCount_1.bufferCount;var __extends$L=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function bufferTime(t){var e=arguments.length,r=async.async;isScheduler_1.isScheduler(arguments[arguments.length-1])&&(r=arguments[arguments.length-1],e--);var n=null;e>=2&&(n=arguments[1]);var i=Number.POSITIVE_INFINITY;return e>=3&&(i=arguments[2]),this.lift(new BufferTimeOperator(t,n,i,r))}var bufferTime_2=bufferTime,BufferTimeOperator=function(){function t(t,e,r,n){this.bufferTimeSpan=t,this.bufferCreationInterval=e,this.maxBufferSize=r,this.scheduler=n}return t.prototype.call=function(t,e){return e.subscribe(new BufferTimeSubscriber(t,this.bufferTimeSpan,this.bufferCreationInterval,this.maxBufferSize,this.scheduler))},t}(),Context=function(){return function(){this.buffer=[]}}(),BufferTimeSubscriber=function(t){function e(e,r,n,i,o){t.call(this,e),this.bufferTimeSpan=r,this.bufferCreationInterval=n,this.maxBufferSize=i,this.scheduler=o,this.contexts=[];var s=this.openContext();if(this.timespanOnly=null==n||n<0,this.timespanOnly){var a={subscriber:this,context:s,bufferTimeSpan:r};this.add(s.closeAction=o.schedule(dispatchBufferTimeSpanOnly,r,a))}else{var c={subscriber:this,context:s},u={bufferTimeSpan:r,bufferCreationInterval:n,subscriber:this,scheduler:o};this.add(s.closeAction=o.schedule(dispatchBufferClose,r,c)),this.add(o.schedule(dispatchBufferCreation,n,u))}}return __extends$L(e,t),e.prototype._next=function(t){for(var e,r=this.contexts,n=r.length,i=0;i<n;i++){var o=r[i],s=o.buffer;s.push(t),s.length==this.maxBufferSize&&(e=o)}e&&this.onBufferFull(e)},e.prototype._error=function(e){this.contexts.length=0,t.prototype._error.call(this,e)},e.prototype._complete=function(){for(var e=this.contexts,r=this.destination;e.length>0;){var n=e.shift();r.next(n.buffer)}t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){this.contexts=null},e.prototype.onBufferFull=function(t){this.closeContext(t);var e=t.closeAction;if(e.unsubscribe(),this.remove(e),!this.closed&&this.timespanOnly){t=this.openContext();var r=this.bufferTimeSpan,n={subscriber:this,context:t,bufferTimeSpan:r};this.add(t.closeAction=this.scheduler.schedule(dispatchBufferTimeSpanOnly,r,n))}},e.prototype.openContext=function(){var t=new Context;return this.contexts.push(t),t},e.prototype.closeContext=function(t){this.destination.next(t.buffer);var e=this.contexts;(e?e.indexOf(t):-1)>=0&&e.splice(e.indexOf(t),1)},e}(Subscriber_1.Subscriber);function dispatchBufferTimeSpanOnly(t){var e=t.subscriber,r=t.context;r&&e.closeContext(r),e.closed||(t.context=e.openContext(),t.context.closeAction=this.schedule(t,t.bufferTimeSpan))}function dispatchBufferCreation(t){var e=t.bufferCreationInterval,r=t.bufferTimeSpan,n=t.subscriber,i=t.scheduler,o=n.openContext();n.closed||(n.add(o.closeAction=i.schedule(dispatchBufferClose,r,{subscriber:n,context:o})),this.schedule(t,e))}function dispatchBufferClose(t){var e=t.subscriber,r=t.context;e.closeContext(r)}var bufferTime_1={bufferTime:bufferTime_2};Observable_1.Observable.prototype.bufferTime=bufferTime_1.bufferTime;var __extends$M=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function bufferToggle(t,e){return this.lift(new BufferToggleOperator(t,e))}var bufferToggle_2=bufferToggle,BufferToggleOperator=function(){function t(t,e){this.openings=t,this.closingSelector=e}return t.prototype.call=function(t,e){return e.subscribe(new BufferToggleSubscriber(t,this.openings,this.closingSelector))},t}(),BufferToggleSubscriber=function(t){function e(e,r,n){t.call(this,e),this.openings=r,this.closingSelector=n,this.contexts=[],this.add(subscribeToResult_1.subscribeToResult(this,r))}return __extends$M(e,t),e.prototype._next=function(t){for(var e=this.contexts,r=e.length,n=0;n<r;n++)e[n].buffer.push(t)},e.prototype._error=function(e){for(var r=this.contexts;r.length>0;){var n=r.shift();n.subscription.unsubscribe(),n.buffer=null,n.subscription=null}this.contexts=null,t.prototype._error.call(this,e)},e.prototype._complete=function(){for(var e=this.contexts;e.length>0;){var r=e.shift();this.destination.next(r.buffer),r.subscription.unsubscribe(),r.buffer=null,r.subscription=null}this.contexts=null,t.prototype._complete.call(this)},e.prototype.notifyNext=function(t,e,r,n,i){t?this.closeBuffer(t):this.openBuffer(e)},e.prototype.notifyComplete=function(t){this.closeBuffer(t.context)},e.prototype.openBuffer=function(t){try{var e=this.closingSelector.call(this,t);e&&this.trySubscribe(e)}catch(t){this._error(t)}},e.prototype.closeBuffer=function(t){var e=this.contexts;if(e&&t){var r=t.buffer,n=t.subscription;this.destination.next(r),e.splice(e.indexOf(t),1),this.remove(n),n.unsubscribe()}},e.prototype.trySubscribe=function(t){var e=this.contexts,r=new Subscription_1.Subscription,n={buffer:[],subscription:r};e.push(n);var i=subscribeToResult_1.subscribeToResult(this,t,n);!i||i.closed?this.closeBuffer(n):(i.context=n,this.add(i),r.add(i))},e}(OuterSubscriber_1.OuterSubscriber),bufferToggle_1={bufferToggle:bufferToggle_2};Observable_1.Observable.prototype.bufferToggle=bufferToggle_1.bufferToggle;var __extends$N=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function bufferWhen(t){return this.lift(new BufferWhenOperator(t))}var bufferWhen_2=bufferWhen,BufferWhenOperator=function(){function t(t){this.closingSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new BufferWhenSubscriber(t,this.closingSelector))},t}(),BufferWhenSubscriber=function(t){function e(e,r){t.call(this,e),this.closingSelector=r,this.subscribing=!1,this.openBuffer()}return __extends$N(e,t),e.prototype._next=function(t){this.buffer.push(t)},e.prototype._complete=function(){var e=this.buffer;e&&this.destination.next(e),t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){this.buffer=null,this.subscribing=!1},e.prototype.notifyNext=function(t,e,r,n,i){this.openBuffer()},e.prototype.notifyComplete=function(){this.subscribing?this.complete():this.openBuffer()},e.prototype.openBuffer=function(){var t=this.closingSubscription;t&&(this.remove(t),t.unsubscribe());var e=this.buffer;this.buffer&&this.destination.next(e),this.buffer=[];var r=tryCatch_1.tryCatch(this.closingSelector)();r===errorObject.errorObject?this.error(errorObject.errorObject.e):(t=new Subscription_1.Subscription,this.closingSubscription=t,this.add(t),this.subscribing=!0,t.add(subscribeToResult_1.subscribeToResult(this,r)),this.subscribing=!1)},e}(OuterSubscriber_1.OuterSubscriber),bufferWhen_1={bufferWhen:bufferWhen_2};Observable_1.Observable.prototype.bufferWhen=bufferWhen_1.bufferWhen;var __extends$O=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function _catch(t){var e=new CatchOperator(t),r=this.lift(e);return e.caught=r}var _catch_2=_catch,CatchOperator=function(){function t(t){this.selector=t}return t.prototype.call=function(t,e){return e.subscribe(new CatchSubscriber(t,this.selector,this.caught))},t}(),CatchSubscriber=function(t){function e(e,r,n){t.call(this,e),this.selector=r,this.caught=n}return __extends$O(e,t),e.prototype.error=function(e){if(!this.isStopped){var r=void 0;try{r=this.selector(e,this.caught)}catch(e){return void t.prototype.error.call(this,e)}this._unsubscribeAndRecycle(),this.add(subscribeToResult_1.subscribeToResult(this,r))}},e}(OuterSubscriber_1.OuterSubscriber),_catch_1={_catch:_catch_2};function combineAll(t){return this.lift(new combineLatest_1.CombineLatestOperator(t))}Observable_1.Observable.prototype.catch=_catch_1._catch,Observable_1.Observable.prototype._catch=_catch_1._catch;var combineAll_2=combineAll,combineAll_1={combineAll:combineAll_2};function concatAll(){return this.lift(new mergeAll_1.MergeAllOperator(1))}Observable_1.Observable.prototype.combineAll=combineAll_1.combineAll,Observable_1.Observable.prototype.combineLatest=combineLatest_1.combineLatest,Observable_1.Observable.prototype.concat=concat_1.concat;var concatAll_2=concatAll,concatAll_1={concatAll:concatAll_2};Observable_1.Observable.prototype.concatAll=concatAll_1.concatAll;var __extends$P=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function mergeMap(t,e,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),"number"==typeof e&&(r=e,e=null),this.lift(new MergeMapOperator(t,e,r))}var mergeMap_2=mergeMap,MergeMapOperator=function(){function t(t,e,r){void 0===r&&(r=Number.POSITIVE_INFINITY),this.project=t,this.resultSelector=e,this.concurrent=r}return t.prototype.call=function(t,e){return e.subscribe(new MergeMapSubscriber(t,this.project,this.resultSelector,this.concurrent))},t}(),MergeMapOperator_1=MergeMapOperator,MergeMapSubscriber=function(t){function e(e,r,n,i){void 0===i&&(i=Number.POSITIVE_INFINITY),t.call(this,e),this.project=r,this.resultSelector=n,this.concurrent=i,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}return __extends$P(e,t),e.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},e.prototype._tryNext=function(t){var e,r=this.index++;try{e=this.project(t,r)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(e,t,r)},e.prototype._innerSub=function(t,e,r){this.add(subscribeToResult_1.subscribeToResult(this,t,e,r))},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete()},e.prototype.notifyNext=function(t,e,r,n,i){this.resultSelector?this._notifyResultSelector(t,e,r,n):this.destination.next(e)},e.prototype._notifyResultSelector=function(t,e,r,n){var i;try{i=this.resultSelector(t,e,r,n)}catch(t){return void this.destination.error(t)}this.destination.next(i)},e.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(OuterSubscriber_1.OuterSubscriber),MergeMapSubscriber_1=MergeMapSubscriber,mergeMap_1={mergeMap:mergeMap_2,MergeMapOperator:MergeMapOperator_1,MergeMapSubscriber:MergeMapSubscriber_1};function concatMap(t,e){return this.lift(new mergeMap_1.MergeMapOperator(t,e,1))}var concatMap_2=concatMap,concatMap_1={concatMap:concatMap_2};Observable_1.Observable.prototype.concatMap=concatMap_1.concatMap;var __extends$Q=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function mergeMapTo(t,e,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),"number"==typeof e&&(r=e,e=null),this.lift(new MergeMapToOperator(t,e,r))}var mergeMapTo_2=mergeMapTo,MergeMapToOperator=function(){function t(t,e,r){void 0===r&&(r=Number.POSITIVE_INFINITY),this.ish=t,this.resultSelector=e,this.concurrent=r}return t.prototype.call=function(t,e){return e.subscribe(new MergeMapToSubscriber(t,this.ish,this.resultSelector,this.concurrent))},t}(),MergeMapToOperator_1=MergeMapToOperator,MergeMapToSubscriber=function(t){function e(e,r,n,i){void 0===i&&(i=Number.POSITIVE_INFINITY),t.call(this,e),this.ish=r,this.resultSelector=n,this.concurrent=i,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}return __extends$Q(e,t),e.prototype._next=function(t){if(this.active<this.concurrent){var e=this.resultSelector,r=this.index++,n=this.ish,i=this.destination;this.active++,this._innerSub(n,i,e,t,r)}else this.buffer.push(t)},e.prototype._innerSub=function(t,e,r,n,i){this.add(subscribeToResult_1.subscribeToResult(this,t,n,i))},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete()},e.prototype.notifyNext=function(t,e,r,n,i){var o=this.resultSelector,s=this.destination;o?this.trySelectResult(t,e,r,n):s.next(e)},e.prototype.trySelectResult=function(t,e,r,n){var i,o=this.resultSelector,s=this.destination;try{i=o(t,e,r,n)}catch(t){return void s.error(t)}s.next(i)},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(OuterSubscriber_1.OuterSubscriber),MergeMapToSubscriber_1=MergeMapToSubscriber,mergeMapTo_1={mergeMapTo:mergeMapTo_2,MergeMapToOperator:MergeMapToOperator_1,MergeMapToSubscriber:MergeMapToSubscriber_1};function concatMapTo(t,e){return this.lift(new mergeMapTo_1.MergeMapToOperator(t,e,1))}var concatMapTo_2=concatMapTo,concatMapTo_1={concatMapTo:concatMapTo_2};Observable_1.Observable.prototype.concatMapTo=concatMapTo_1.concatMapTo;var __extends$R=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function count(t){return this.lift(new CountOperator(t,this))}var count_2=count,CountOperator=function(){function t(t,e){this.predicate=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new CountSubscriber(t,this.predicate,this.source))},t}(),CountSubscriber=function(t){function e(e,r,n){t.call(this,e),this.predicate=r,this.source=n,this.count=0,this.index=0}return __extends$R(e,t),e.prototype._next=function(t){this.predicate?this._tryPredicate(t):this.count++},e.prototype._tryPredicate=function(t){var e;try{e=this.predicate(t,this.index++,this.source)}catch(t){return void this.destination.error(t)}e&&this.count++},e.prototype._complete=function(){this.destination.next(this.count),this.destination.complete()},e}(Subscriber_1.Subscriber),count_1={count:count_2};Observable_1.Observable.prototype.count=count_1.count;var __extends$S=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function dematerialize(){return this.lift(new DeMaterializeOperator)}var dematerialize_2=dematerialize,DeMaterializeOperator=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new DeMaterializeSubscriber(t))},t}(),DeMaterializeSubscriber=function(t){function e(e){t.call(this,e)}return __extends$S(e,t),e.prototype._next=function(t){t.observe(this.destination)},e}(Subscriber_1.Subscriber),dematerialize_1={dematerialize:dematerialize_2};Observable_1.Observable.prototype.dematerialize=dematerialize_1.dematerialize;var __extends$T=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function debounce(t){return this.lift(new DebounceOperator(t))}var debounce_2=debounce,DebounceOperator=function(){function t(t){this.durationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new DebounceSubscriber(t,this.durationSelector))},t}(),DebounceSubscriber=function(t){function e(e,r){t.call(this,e),this.durationSelector=r,this.hasValue=!1,this.durationSubscription=null}return __extends$T(e,t),e.prototype._next=function(t){try{var e=this.durationSelector.call(this,t);e&&this._tryNext(t,e)}catch(t){this.destination.error(t)}},e.prototype._complete=function(){this.emitValue(),this.destination.complete()},e.prototype._tryNext=function(t,e){var r=this.durationSubscription;this.value=t,this.hasValue=!0,r&&(r.unsubscribe(),this.remove(r)),(r=subscribeToResult_1.subscribeToResult(this,e)).closed||this.add(this.durationSubscription=r)},e.prototype.notifyNext=function(t,e,r,n,i){this.emitValue()},e.prototype.notifyComplete=function(){this.emitValue()},e.prototype.emitValue=function(){if(this.hasValue){var e=this.value,r=this.durationSubscription;r&&(this.durationSubscription=null,r.unsubscribe(),this.remove(r)),this.value=null,this.hasValue=!1,t.prototype._next.call(this,e)}},e}(OuterSubscriber_1.OuterSubscriber),debounce_1={debounce:debounce_2};Observable_1.Observable.prototype.debounce=debounce_1.debounce;var __extends$U=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function debounceTime(t,e){return void 0===e&&(e=async.async),this.lift(new DebounceTimeOperator(t,e))}var debounceTime_2=debounceTime,DebounceTimeOperator=function(){function t(t,e){this.dueTime=t,this.scheduler=e}return t.prototype.call=function(t,e){return e.subscribe(new DebounceTimeSubscriber(t,this.dueTime,this.scheduler))},t}(),DebounceTimeSubscriber=function(t){function e(e,r,n){t.call(this,e),this.dueTime=r,this.scheduler=n,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}return __extends$U(e,t),e.prototype._next=function(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(dispatchNext$3,this.dueTime,this))},e.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},e.prototype.debouncedNext=function(){this.clearDebounce(),this.hasValue&&(this.destination.next(this.lastValue),this.lastValue=null,this.hasValue=!1)},e.prototype.clearDebounce=function(){var t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)},e}(Subscriber_1.Subscriber);function dispatchNext$3(t){t.debouncedNext()}var debounceTime_1={debounceTime:debounceTime_2};Observable_1.Observable.prototype.debounceTime=debounceTime_1.debounceTime;var __extends$V=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function defaultIfEmpty(t){return void 0===t&&(t=null),this.lift(new DefaultIfEmptyOperator(t))}var defaultIfEmpty_2=defaultIfEmpty,DefaultIfEmptyOperator=function(){function t(t){this.defaultValue=t}return t.prototype.call=function(t,e){return e.subscribe(new DefaultIfEmptySubscriber(t,this.defaultValue))},t}(),DefaultIfEmptySubscriber=function(t){function e(e,r){t.call(this,e),this.defaultValue=r,this.isEmpty=!0}return __extends$V(e,t),e.prototype._next=function(t){this.isEmpty=!1,this.destination.next(t)},e.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},e}(Subscriber_1.Subscriber),defaultIfEmpty_1={defaultIfEmpty:defaultIfEmpty_2};Observable_1.Observable.prototype.defaultIfEmpty=defaultIfEmpty_1.defaultIfEmpty;var __extends$W=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function delay(t,e){void 0===e&&(e=async.async);var r=isDate_1.isDate(t)?+t-e.now():Math.abs(t);return this.lift(new DelayOperator(r,e))}var delay_2=delay,DelayOperator=function(){function t(t,e){this.delay=t,this.scheduler=e}return t.prototype.call=function(t,e){return e.subscribe(new DelaySubscriber(t,this.delay,this.scheduler))},t}(),DelaySubscriber=function(t){function e(e,r,n){t.call(this,e),this.delay=r,this.scheduler=n,this.queue=[],this.active=!1,this.errored=!1}return __extends$W(e,t),e.dispatch=function(t){for(var e=t.source,r=e.queue,n=t.scheduler,i=t.destination;r.length>0&&r[0].time-n.now()<=0;)r.shift().notification.observe(i);if(r.length>0){var o=Math.max(0,r[0].time-n.now());this.schedule(t,o)}else e.active=!1},e.prototype._schedule=function(t){this.active=!0,this.add(t.schedule(e.dispatch,this.delay,{source:this,destination:this.destination,scheduler:t}))},e.prototype.scheduleNotification=function(t){if(!0!==this.errored){var e=this.scheduler,r=new DelayMessage(e.now()+this.delay,t);this.queue.push(r),!1===this.active&&this._schedule(e)}},e.prototype._next=function(t){this.scheduleNotification(Notification_1.Notification.createNext(t))},e.prototype._error=function(t){this.errored=!0,this.queue=[],this.destination.error(t)},e.prototype._complete=function(){this.scheduleNotification(Notification_1.Notification.createComplete())},e}(Subscriber_1.Subscriber),DelayMessage=function(){return function(t,e){this.time=t,this.notification=e}}(),delay_1={delay:delay_2};Observable_1.Observable.prototype.delay=delay_1.delay;var __extends$X=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function delayWhen(t,e){return e?new SubscriptionDelayObservable(this,e).lift(new DelayWhenOperator(t)):this.lift(new DelayWhenOperator(t))}var delayWhen_2=delayWhen,DelayWhenOperator=function(){function t(t){this.delayDurationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new DelayWhenSubscriber(t,this.delayDurationSelector))},t}(),DelayWhenSubscriber=function(t){function e(e,r){t.call(this,e),this.delayDurationSelector=r,this.completed=!1,this.delayNotifierSubscriptions=[],this.values=[]}return __extends$X(e,t),e.prototype.notifyNext=function(t,e,r,n,i){this.destination.next(t),this.removeSubscription(i),this.tryComplete()},e.prototype.notifyError=function(t,e){this._error(t)},e.prototype.notifyComplete=function(t){var e=this.removeSubscription(t);e&&this.destination.next(e),this.tryComplete()},e.prototype._next=function(t){try{var e=this.delayDurationSelector(t);e&&this.tryDelay(e,t)}catch(t){this.destination.error(t)}},e.prototype._complete=function(){this.completed=!0,this.tryComplete()},e.prototype.removeSubscription=function(t){t.unsubscribe();var e=this.delayNotifierSubscriptions.indexOf(t),r=null;return-1!==e&&(r=this.values[e],this.delayNotifierSubscriptions.splice(e,1),this.values.splice(e,1)),r},e.prototype.tryDelay=function(t,e){var r=subscribeToResult_1.subscribeToResult(this,t,e);r&&!r.closed&&(this.add(r),this.delayNotifierSubscriptions.push(r)),this.values.push(e)},e.prototype.tryComplete=function(){this.completed&&0===this.delayNotifierSubscriptions.length&&this.destination.complete()},e}(OuterSubscriber_1.OuterSubscriber),SubscriptionDelayObservable=function(t){function e(e,r){t.call(this),this.source=e,this.subscriptionDelay=r}return __extends$X(e,t),e.prototype._subscribe=function(t){this.subscriptionDelay.subscribe(new SubscriptionDelaySubscriber(t,this.source))},e}(Observable_1.Observable),SubscriptionDelaySubscriber=function(t){function e(e,r){t.call(this),this.parent=e,this.source=r,this.sourceSubscribed=!1}return __extends$X(e,t),e.prototype._next=function(t){this.subscribeToSource()},e.prototype._error=function(t){this.unsubscribe(),this.parent.error(t)},e.prototype._complete=function(){this.subscribeToSource()},e.prototype.subscribeToSource=function(){this.sourceSubscribed||(this.sourceSubscribed=!0,this.unsubscribe(),this.source.subscribe(this.parent))},e}(Subscriber_1.Subscriber),delayWhen_1={delayWhen:delayWhen_2};function minimalSetImpl(){return function(){function t(){this._values=[]}return t.prototype.add=function(t){this.has(t)||this._values.push(t)},t.prototype.has=function(t){return-1!==this._values.indexOf(t)},Object.defineProperty(t.prototype,"size",{get:function(){return this._values.length},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this._values.length=0},t}()}Observable_1.Observable.prototype.delayWhen=delayWhen_1.delayWhen;var minimalSetImpl_1=minimalSetImpl,Set$1=root.root.Set||minimalSetImpl(),_Set={minimalSetImpl:minimalSetImpl_1,Set:Set$1},__extends$Y=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function distinct(t,e){return this.lift(new DistinctOperator(t,e))}var distinct_2=distinct,DistinctOperator=function(){function t(t,e){this.keySelector=t,this.flushes=e}return t.prototype.call=function(t,e){return e.subscribe(new DistinctSubscriber(t,this.keySelector,this.flushes))},t}(),DistinctSubscriber=function(t){function e(e,r,n){t.call(this,e),this.keySelector=r,this.values=new _Set.Set,n&&this.add(subscribeToResult_1.subscribeToResult(this,n))}return __extends$Y(e,t),e.prototype.notifyNext=function(t,e,r,n,i){this.values.clear()},e.prototype.notifyError=function(t,e){this._error(t)},e.prototype._next=function(t){this.keySelector?this._useKeySelector(t):this._finalizeNext(t,t)},e.prototype._useKeySelector=function(t){var e,r=this.destination;try{e=this.keySelector(t)}catch(t){return void r.error(t)}this._finalizeNext(e,t)},e.prototype._finalizeNext=function(t,e){var r=this.values;r.has(t)||(r.add(t),this.destination.next(e))},e}(OuterSubscriber_1.OuterSubscriber),DistinctSubscriber_1=DistinctSubscriber,distinct_1={distinct:distinct_2,DistinctSubscriber:DistinctSubscriber_1};Observable_1.Observable.prototype.distinct=distinct_1.distinct;var __extends$Z=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function distinctUntilChanged(t,e){return this.lift(new DistinctUntilChangedOperator(t,e))}var distinctUntilChanged_2=distinctUntilChanged,DistinctUntilChangedOperator=function(){function t(t,e){this.compare=t,this.keySelector=e}return t.prototype.call=function(t,e){return e.subscribe(new DistinctUntilChangedSubscriber(t,this.compare,this.keySelector))},t}(),DistinctUntilChangedSubscriber=function(t){function e(e,r,n){t.call(this,e),this.keySelector=n,this.hasKey=!1,"function"==typeof r&&(this.compare=r)}return __extends$Z(e,t),e.prototype.compare=function(t,e){return t===e},e.prototype._next=function(t){var e=t;if(this.keySelector&&(e=tryCatch_1.tryCatch(this.keySelector)(t))===errorObject.errorObject)return this.destination.error(errorObject.errorObject.e);var r=!1;if(this.hasKey){if((r=tryCatch_1.tryCatch(this.compare)(this.key,e))===errorObject.errorObject)return this.destination.error(errorObject.errorObject.e)}else this.hasKey=!0;!1===Boolean(r)&&(this.key=e,this.destination.next(t))},e}(Subscriber_1.Subscriber),distinctUntilChanged_1={distinctUntilChanged:distinctUntilChanged_2};function distinctUntilKeyChanged(t,e){return distinctUntilChanged_1.distinctUntilChanged.call(this,function(r,n){return e?e(r[t],n[t]):r[t]===n[t]})}Observable_1.Observable.prototype.distinctUntilChanged=distinctUntilChanged_1.distinctUntilChanged;var distinctUntilKeyChanged_2=distinctUntilKeyChanged,distinctUntilKeyChanged_1={distinctUntilKeyChanged:distinctUntilKeyChanged_2};Observable_1.Observable.prototype.distinctUntilKeyChanged=distinctUntilKeyChanged_1.distinctUntilKeyChanged;var __extends$_=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function _do(t,e,r){return this.lift(new DoOperator(t,e,r))}var _do_2=_do,DoOperator=function(){function t(t,e,r){this.nextOrObserver=t,this.error=e,this.complete=r}return t.prototype.call=function(t,e){return e.subscribe(new DoSubscriber(t,this.nextOrObserver,this.error,this.complete))},t}(),DoSubscriber=function(t){function e(e,r,n,i){t.call(this,e);var o=new Subscriber_1.Subscriber(r,n,i);o.syncErrorThrowable=!0,this.add(o),this.safeSubscriber=o}return __extends$_(e,t),e.prototype._next=function(t){var e=this.safeSubscriber;e.next(t),e.syncErrorThrown?this.destination.error(e.syncErrorValue):this.destination.next(t)},e.prototype._error=function(t){var e=this.safeSubscriber;e.error(t),e.syncErrorThrown?this.destination.error(e.syncErrorValue):this.destination.error(t)},e.prototype._complete=function(){var t=this.safeSubscriber;t.complete(),t.syncErrorThrown?this.destination.error(t.syncErrorValue):this.destination.complete()},e}(Subscriber_1.Subscriber),_do_1={_do:_do_2};Observable_1.Observable.prototype.do=_do_1._do,Observable_1.Observable.prototype._do=_do_1._do;var __extends$$=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function exhaust(){return this.lift(new SwitchFirstOperator)}var exhaust_2=exhaust,SwitchFirstOperator=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new SwitchFirstSubscriber(t))},t}(),SwitchFirstSubscriber=function(t){function e(e){t.call(this,e),this.hasCompleted=!1,this.hasSubscription=!1}return __extends$$(e,t),e.prototype._next=function(t){this.hasSubscription||(this.hasSubscription=!0,this.add(subscribeToResult_1.subscribeToResult(this,t)))},e.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete()},e.prototype.notifyComplete=function(t){this.remove(t),this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},e}(OuterSubscriber_1.OuterSubscriber),exhaust_1={exhaust:exhaust_2};Observable_1.Observable.prototype.exhaust=exhaust_1.exhaust;var __extends$10=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function exhaustMap(t,e){return this.lift(new SwitchFirstMapOperator(t,e))}var exhaustMap_2=exhaustMap,SwitchFirstMapOperator=function(){function t(t,e){this.project=t,this.resultSelector=e}return t.prototype.call=function(t,e){return e.subscribe(new SwitchFirstMapSubscriber(t,this.project,this.resultSelector))},t}(),SwitchFirstMapSubscriber=function(t){function e(e,r,n){t.call(this,e),this.project=r,this.resultSelector=n,this.hasSubscription=!1,this.hasCompleted=!1,this.index=0}return __extends$10(e,t),e.prototype._next=function(t){this.hasSubscription||this.tryNext(t)},e.prototype.tryNext=function(t){var e=this.index++,r=this.destination;try{var n=this.project(t,e);this.hasSubscription=!0,this.add(subscribeToResult_1.subscribeToResult(this,n,t,e))}catch(t){r.error(t)}},e.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete()},e.prototype.notifyNext=function(t,e,r,n,i){var o=this.resultSelector,s=this.destination;o?this.trySelectResult(t,e,r,n):s.next(e)},e.prototype.trySelectResult=function(t,e,r,n){var i=this.resultSelector,o=this.destination;try{var s=i(t,e,r,n);o.next(s)}catch(t){o.error(t)}},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.remove(t),this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},e}(OuterSubscriber_1.OuterSubscriber),exhaustMap_1={exhaustMap:exhaustMap_2};Observable_1.Observable.prototype.exhaustMap=exhaustMap_1.exhaustMap;var __extends$11=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function expand(t,e,r){return void 0===e&&(e=Number.POSITIVE_INFINITY),void 0===r&&(r=void 0),e=(e||0)<1?Number.POSITIVE_INFINITY:e,this.lift(new ExpandOperator(t,e,r))}var expand_2=expand,ExpandOperator=function(){function t(t,e,r){this.project=t,this.concurrent=e,this.scheduler=r}return t.prototype.call=function(t,e){return e.subscribe(new ExpandSubscriber(t,this.project,this.concurrent,this.scheduler))},t}(),ExpandOperator_1=ExpandOperator,ExpandSubscriber=function(t){function e(e,r,n,i){t.call(this,e),this.project=r,this.concurrent=n,this.scheduler=i,this.index=0,this.active=0,this.hasCompleted=!1,n<Number.POSITIVE_INFINITY&&(this.buffer=[])}return __extends$11(e,t),e.dispatch=function(t){var e=t.subscriber,r=t.result,n=t.value,i=t.index;e.subscribeToProjection(r,n,i)},e.prototype._next=function(t){var r=this.destination;if(r.closed)this._complete();else{var n=this.index++;if(this.active<this.concurrent){r.next(t);var i=tryCatch_1.tryCatch(this.project)(t,n);if(i===errorObject.errorObject)r.error(errorObject.errorObject.e);else if(this.scheduler){var o={subscriber:this,result:i,value:t,index:n};this.add(this.scheduler.schedule(e.dispatch,0,o))}else this.subscribeToProjection(i,t,n)}else this.buffer.push(t)}},e.prototype.subscribeToProjection=function(t,e,r){this.active++,this.add(subscribeToResult_1.subscribeToResult(this,t,e,r))},e.prototype._complete=function(){this.hasCompleted=!0,this.hasCompleted&&0===this.active&&this.destination.complete()},e.prototype.notifyNext=function(t,e,r,n,i){this._next(e)},e.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,e&&e.length>0&&this._next(e.shift()),this.hasCompleted&&0===this.active&&this.destination.complete()},e}(OuterSubscriber_1.OuterSubscriber),ExpandSubscriber_1=ExpandSubscriber,expand_1={expand:expand_2,ExpandOperator:ExpandOperator_1,ExpandSubscriber:ExpandSubscriber_1};Observable_1.Observable.prototype.expand=expand_1.expand;var __extends$12=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},ArgumentOutOfRangeError=function(t){function e(){var e=t.call(this,"argument out of range");this.name=e.name="ArgumentOutOfRangeError",this.stack=e.stack,this.message=e.message}return __extends$12(e,t),e}(Error),ArgumentOutOfRangeError_2=ArgumentOutOfRangeError,ArgumentOutOfRangeError_1={ArgumentOutOfRangeError:ArgumentOutOfRangeError_2},__extends$13=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function elementAt(t,e){return this.lift(new ElementAtOperator(t,e))}var elementAt_2=elementAt,ElementAtOperator=function(){function t(t,e){if(this.index=t,this.defaultValue=e,t<0)throw new ArgumentOutOfRangeError_1.ArgumentOutOfRangeError}return t.prototype.call=function(t,e){return e.subscribe(new ElementAtSubscriber(t,this.index,this.defaultValue))},t}(),ElementAtSubscriber=function(t){function e(e,r,n){t.call(this,e),this.index=r,this.defaultValue=n}return __extends$13(e,t),e.prototype._next=function(t){0==this.index--&&(this.destination.next(t),this.destination.complete())},e.prototype._complete=function(){var t=this.destination;this.index>=0&&(void 0!==this.defaultValue?t.next(this.defaultValue):t.error(new ArgumentOutOfRangeError_1.ArgumentOutOfRangeError)),t.complete()},e}(Subscriber_1.Subscriber),elementAt_1={elementAt:elementAt_2};Observable_1.Observable.prototype.elementAt=elementAt_1.elementAt;var __extends$14=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function filter(t,e){return this.lift(new FilterOperator(t,e))}var filter_2=filter,FilterOperator=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new FilterSubscriber(t,this.predicate,this.thisArg))},t}(),FilterSubscriber=function(t){function e(e,r,n){t.call(this,e),this.predicate=r,this.thisArg=n,this.count=0,this.predicate=r}return __extends$14(e,t),e.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)},e}(Subscriber_1.Subscriber),filter_1={filter:filter_2};Observable_1.Observable.prototype.filter=filter_1.filter;var __extends$15=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function _finally(t){return this.lift(new FinallyOperator(t))}var _finally_2=_finally,FinallyOperator=function(){function t(t){this.callback=t}return t.prototype.call=function(t,e){return e.subscribe(new FinallySubscriber(t,this.callback))},t}(),FinallySubscriber=function(t){function e(e,r){t.call(this,e),this.add(new Subscription_1.Subscription(r))}return __extends$15(e,t),e}(Subscriber_1.Subscriber),_finally_1={_finally:_finally_2};Observable_1.Observable.prototype.finally=_finally_1._finally,Observable_1.Observable.prototype._finally=_finally_1._finally;var __extends$16=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function find(t,e){if("function"!=typeof t)throw new TypeError("predicate is not a function");return this.lift(new FindValueOperator(t,this,!1,e))}var find_2=find,FindValueOperator=function(){function t(t,e,r,n){this.predicate=t,this.source=e,this.yieldIndex=r,this.thisArg=n}return t.prototype.call=function(t,e){return e.subscribe(new FindValueSubscriber(t,this.predicate,this.source,this.yieldIndex,this.thisArg))},t}(),FindValueOperator_1=FindValueOperator,FindValueSubscriber=function(t){function e(e,r,n,i,o){t.call(this,e),this.predicate=r,this.source=n,this.yieldIndex=i,this.thisArg=o,this.index=0}return __extends$16(e,t),e.prototype.notifyComplete=function(t){var e=this.destination;e.next(t),e.complete()},e.prototype._next=function(t){var e=this.predicate,r=this.thisArg,n=this.index++;try{e.call(r||this,t,n,this.source)&&this.notifyComplete(this.yieldIndex?n:t)}catch(t){this.destination.error(t)}},e.prototype._complete=function(){this.notifyComplete(this.yieldIndex?-1:void 0)},e}(Subscriber_1.Subscriber),FindValueSubscriber_1=FindValueSubscriber,find_1={find:find_2,FindValueOperator:FindValueOperator_1,FindValueSubscriber:FindValueSubscriber_1};function findIndex(t,e){return this.lift(new find_1.FindValueOperator(t,this,!0,e))}Observable_1.Observable.prototype.find=find_1.find;var findIndex_2=findIndex,findIndex_1={findIndex:findIndex_2};Observable_1.Observable.prototype.findIndex=findIndex_1.findIndex;var __extends$17=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},EmptyError=function(t){function e(){var e=t.call(this,"no elements in sequence");this.name=e.name="EmptyError",this.stack=e.stack,this.message=e.message}return __extends$17(e,t),e}(Error),EmptyError_2=EmptyError,EmptyError_1={EmptyError:EmptyError_2},__extends$18=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function first(t,e,r){return this.lift(new FirstOperator(t,e,r,this))}var first_2=first,FirstOperator=function(){function t(t,e,r,n){this.predicate=t,this.resultSelector=e,this.defaultValue=r,this.source=n}return t.prototype.call=function(t,e){return e.subscribe(new FirstSubscriber(t,this.predicate,this.resultSelector,this.defaultValue,this.source))},t}(),FirstSubscriber=function(t){function e(e,r,n,i,o){t.call(this,e),this.predicate=r,this.resultSelector=n,this.defaultValue=i,this.source=o,this.index=0,this.hasCompleted=!1,this._emitted=!1}return __extends$18(e,t),e.prototype._next=function(t){var e=this.index++;this.predicate?this._tryPredicate(t,e):this._emit(t,e)},e.prototype._tryPredicate=function(t,e){var r;try{r=this.predicate(t,e,this.source)}catch(t){return void this.destination.error(t)}r&&this._emit(t,e)},e.prototype._emit=function(t,e){this.resultSelector?this._tryResultSelector(t,e):this._emitFinal(t)},e.prototype._tryResultSelector=function(t,e){var r;try{r=this.resultSelector(t,e)}catch(t){return void this.destination.error(t)}this._emitFinal(r)},e.prototype._emitFinal=function(t){var e=this.destination;this._emitted||(this._emitted=!0,e.next(t),e.complete(),this.hasCompleted=!0)},e.prototype._complete=function(){var t=this.destination;this.hasCompleted||void 0===this.defaultValue?this.hasCompleted||t.error(new EmptyError_1.EmptyError):(t.next(this.defaultValue),t.complete())},e}(Subscriber_1.Subscriber),first_1={first:first_2};Observable_1.Observable.prototype.first=first_1.first;var MapPolyfill=function(){function t(){this.size=0,this._values=[],this._keys=[]}return t.prototype.get=function(t){var e=this._keys.indexOf(t);return-1===e?void 0:this._values[e]},t.prototype.set=function(t,e){var r=this._keys.indexOf(t);return-1===r?(this._keys.push(t),this._values.push(e),this.size++):this._values[r]=e,this},t.prototype.delete=function(t){var e=this._keys.indexOf(t);return-1!==e&&(this._values.splice(e,1),this._keys.splice(e,1),this.size--,!0)},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this.size=0},t.prototype.forEach=function(t,e){for(var r=0;r<this.size;r++)t.call(e,this._values[r],this._keys[r])},t}(),MapPolyfill_2=MapPolyfill,MapPolyfill_1={MapPolyfill:MapPolyfill_2},Map$1=root.root.Map||MapPolyfill_1.MapPolyfill,_Map={Map:Map$1},FastMap=function(){function t(){this.values={}}return t.prototype.delete=function(t){return this.values[t]=null,!0},t.prototype.set=function(t,e){return this.values[t]=e,this},t.prototype.get=function(t){return this.values[t]},t.prototype.forEach=function(t,e){var r=this.values;for(var n in r)r.hasOwnProperty(n)&&null!==r[n]&&t.call(e,r[n],n)},t.prototype.clear=function(){this.values={}},t}(),FastMap_2=FastMap,FastMap_1={FastMap:FastMap_2},__extends$19=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function groupBy(t,e,r,n){return this.lift(new GroupByOperator(t,e,r,n))}var groupBy_2=groupBy,GroupByOperator=function(){function t(t,e,r,n){this.keySelector=t,this.elementSelector=e,this.durationSelector=r,this.subjectSelector=n}return t.prototype.call=function(t,e){return e.subscribe(new GroupBySubscriber(t,this.keySelector,this.elementSelector,this.durationSelector,this.subjectSelector))},t}(),GroupBySubscriber=function(t){function e(e,r,n,i,o){t.call(this,e),this.keySelector=r,this.elementSelector=n,this.durationSelector=i,this.subjectSelector=o,this.groups=null,this.attemptedToUnsubscribe=!1,this.count=0}return __extends$19(e,t),e.prototype._next=function(t){var e;try{e=this.keySelector(t)}catch(t){return void this.error(t)}this._group(t,e)},e.prototype._group=function(t,e){var r=this.groups;r||(r=this.groups="string"==typeof e?new FastMap_1.FastMap:new _Map.Map);var n,i=r.get(e);if(this.elementSelector)try{n=this.elementSelector(t)}catch(t){this.error(t)}else n=t;if(!i){i=this.subjectSelector?this.subjectSelector():new Subject_1.Subject,r.set(e,i);var o=new GroupedObservable(e,i,this);if(this.destination.next(o),this.durationSelector){var s=void 0;try{s=this.durationSelector(new GroupedObservable(e,i))}catch(t){return void this.error(t)}this.add(s.subscribe(new GroupDurationSubscriber(e,i,this)))}}i.closed||i.next(n)},e.prototype._error=function(t){var e=this.groups;e&&(e.forEach(function(e,r){e.error(t)}),e.clear()),this.destination.error(t)},e.prototype._complete=function(){var t=this.groups;t&&(t.forEach(function(t,e){t.complete()}),t.clear()),this.destination.complete()},e.prototype.removeGroup=function(t){this.groups.delete(t)},e.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,0===this.count&&t.prototype.unsubscribe.call(this))},e}(Subscriber_1.Subscriber),GroupDurationSubscriber=function(t){function e(e,r,n){t.call(this),this.key=e,this.group=r,this.parent=n}return __extends$19(e,t),e.prototype._next=function(t){this._complete()},e.prototype._error=function(t){var e=this.group;e.closed||e.error(t),this.parent.removeGroup(this.key)},e.prototype._complete=function(){var t=this.group;t.closed||t.complete(),this.parent.removeGroup(this.key)},e}(Subscriber_1.Subscriber),GroupedObservable=function(t){function e(e,r,n){t.call(this),this.key=e,this.groupSubject=r,this.refCountSubscription=n}return __extends$19(e,t),e.prototype._subscribe=function(t){var e=new Subscription_1.Subscription,r=this.refCountSubscription,n=this.groupSubject;return r&&!r.closed&&e.add(new InnerRefCountSubscription(r)),e.add(n.subscribe(t)),e},e}(Observable_1.Observable),GroupedObservable_1=GroupedObservable,InnerRefCountSubscription=function(t){function e(e){t.call(this),this.parent=e,e.count++}return __extends$19(e,t),e.prototype.unsubscribe=function(){var e=this.parent;e.closed||this.closed||(t.prototype.unsubscribe.call(this),e.count-=1,0===e.count&&e.attemptedToUnsubscribe&&e.unsubscribe())},e}(Subscription_1.Subscription),groupBy_1={groupBy:groupBy_2,GroupedObservable:GroupedObservable_1};Observable_1.Observable.prototype.groupBy=groupBy_1.groupBy;var __extends$1a=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function ignoreElements(){return this.lift(new IgnoreElementsOperator)}var ignoreElements_2=ignoreElements,IgnoreElementsOperator=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new IgnoreElementsSubscriber(t))},t}(),IgnoreElementsSubscriber=function(t){function e(){t.apply(this,arguments)}return __extends$1a(e,t),e.prototype._next=function(t){},e}(Subscriber_1.Subscriber),ignoreElements_1={ignoreElements:ignoreElements_2};Observable_1.Observable.prototype.ignoreElements=ignoreElements_1.ignoreElements;var __extends$1b=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function isEmpty(){return this.lift(new IsEmptyOperator)}var isEmpty_2=isEmpty,IsEmptyOperator=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new IsEmptySubscriber(t))},t}(),IsEmptySubscriber=function(t){function e(e){t.call(this,e)}return __extends$1b(e,t),e.prototype.notifyComplete=function(t){var e=this.destination;e.next(t),e.complete()},e.prototype._next=function(t){this.notifyComplete(!1)},e.prototype._complete=function(){this.notifyComplete(!0)},e}(Subscriber_1.Subscriber),isEmpty_1={isEmpty:isEmpty_2};Observable_1.Observable.prototype.isEmpty=isEmpty_1.isEmpty;var __extends$1c=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function audit(t){return this.lift(new AuditOperator(t))}var audit_2=audit,AuditOperator=function(){function t(t){this.durationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new AuditSubscriber(t,this.durationSelector))},t}(),AuditSubscriber=function(t){function e(e,r){t.call(this,e),this.durationSelector=r,this.hasValue=!1}return __extends$1c(e,t),e.prototype._next=function(t){if(this.value=t,this.hasValue=!0,!this.throttled){var e=tryCatch_1.tryCatch(this.durationSelector)(t);e===errorObject.errorObject?this.destination.error(errorObject.errorObject.e):this.add(this.throttled=subscribeToResult_1.subscribeToResult(this,e))}},e.prototype.clearThrottle=function(){var t=this.value,e=this.hasValue,r=this.throttled;r&&(this.remove(r),this.throttled=null,r.unsubscribe()),e&&(this.value=null,this.hasValue=!1,this.destination.next(t))},e.prototype.notifyNext=function(t,e,r,n){this.clearThrottle()},e.prototype.notifyComplete=function(){this.clearThrottle()},e}(OuterSubscriber_1.OuterSubscriber),audit_1={audit:audit_2};Observable_1.Observable.prototype.audit=audit_1.audit;var __extends$1d=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function auditTime(t,e){return void 0===e&&(e=async.async),this.lift(new AuditTimeOperator(t,e))}var auditTime_2=auditTime,AuditTimeOperator=function(){function t(t,e){this.duration=t,this.scheduler=e}return t.prototype.call=function(t,e){return e.subscribe(new AuditTimeSubscriber(t,this.duration,this.scheduler))},t}(),AuditTimeSubscriber=function(t){function e(e,r,n){t.call(this,e),this.duration=r,this.scheduler=n,this.hasValue=!1}return __extends$1d(e,t),e.prototype._next=function(t){this.value=t,this.hasValue=!0,this.throttled||this.add(this.throttled=this.scheduler.schedule(dispatchNext$4,this.duration,this))},e.prototype.clearThrottle=function(){var t=this.value,e=this.hasValue,r=this.throttled;r&&(this.remove(r),this.throttled=null,r.unsubscribe()),e&&(this.value=null,this.hasValue=!1,this.destination.next(t))},e}(Subscriber_1.Subscriber);function dispatchNext$4(t){t.clearThrottle()}var auditTime_1={auditTime:auditTime_2};Observable_1.Observable.prototype.auditTime=auditTime_1.auditTime;var __extends$1e=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function last(t,e,r){return this.lift(new LastOperator(t,e,r,this))}var last_2=last,LastOperator=function(){function t(t,e,r,n){this.predicate=t,this.resultSelector=e,this.defaultValue=r,this.source=n}return t.prototype.call=function(t,e){return e.subscribe(new LastSubscriber(t,this.predicate,this.resultSelector,this.defaultValue,this.source))},t}(),LastSubscriber=function(t){function e(e,r,n,i,o){t.call(this,e),this.predicate=r,this.resultSelector=n,this.defaultValue=i,this.source=o,this.hasValue=!1,this.index=0,void 0!==i&&(this.lastValue=i,this.hasValue=!0)}return __extends$1e(e,t),e.prototype._next=function(t){var e=this.index++;if(this.predicate)this._tryPredicate(t,e);else{if(this.resultSelector)return void this._tryResultSelector(t,e);this.lastValue=t,this.hasValue=!0}},e.prototype._tryPredicate=function(t,e){var r;try{r=this.predicate(t,e,this.source)}catch(t){return void this.destination.error(t)}if(r){if(this.resultSelector)return void this._tryResultSelector(t,e);this.lastValue=t,this.hasValue=!0}},e.prototype._tryResultSelector=function(t,e){var r;try{r=this.resultSelector(t,e)}catch(t){return void this.destination.error(t)}this.lastValue=r,this.hasValue=!0},e.prototype._complete=function(){var t=this.destination;this.hasValue?(t.next(this.lastValue),t.complete()):t.error(new EmptyError_1.EmptyError)},e}(Subscriber_1.Subscriber),last_1={last:last_2};function letProto(t){return t(this)}Observable_1.Observable.prototype.last=last_1.last;var letProto_1=letProto,_let={letProto:letProto_1};Observable_1.Observable.prototype.let=_let.letProto,Observable_1.Observable.prototype.letBind=_let.letProto;var __extends$1f=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function every(t,e){return this.lift(new EveryOperator(t,e,this))}var every_2=every,EveryOperator=function(){function t(t,e,r){this.predicate=t,this.thisArg=e,this.source=r}return t.prototype.call=function(t,e){return e.subscribe(new EverySubscriber(t,this.predicate,this.thisArg,this.source))},t}(),EverySubscriber=function(t){function e(e,r,n,i){t.call(this,e),this.predicate=r,this.thisArg=n,this.source=i,this.index=0,this.thisArg=n||this}return __extends$1f(e,t),e.prototype.notifyComplete=function(t){this.destination.next(t),this.destination.complete()},e.prototype._next=function(t){var e=!1;try{e=this.predicate.call(this.thisArg,t,this.index++,this.source)}catch(t){return void this.destination.error(t)}e||this.notifyComplete(!1)},e.prototype._complete=function(){this.notifyComplete(!0)},e}(Subscriber_1.Subscriber),every_1={every:every_2};Observable_1.Observable.prototype.every=every_1.every,Observable_1.Observable.prototype.map=map_1.map;var __extends$1g=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function mapTo(t){return this.lift(new MapToOperator(t))}var mapTo_2=mapTo,MapToOperator=function(){function t(t){this.value=t}return t.prototype.call=function(t,e){return e.subscribe(new MapToSubscriber(t,this.value))},t}(),MapToSubscriber=function(t){function e(e,r){t.call(this,e),this.value=r}return __extends$1g(e,t),e.prototype._next=function(t){this.destination.next(this.value)},e}(Subscriber_1.Subscriber),mapTo_1={mapTo:mapTo_2};Observable_1.Observable.prototype.mapTo=mapTo_1.mapTo;var __extends$1h=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function materialize(){return this.lift(new MaterializeOperator)}var materialize_2=materialize,MaterializeOperator=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new MaterializeSubscriber(t))},t}(),MaterializeSubscriber=function(t){function e(e){t.call(this,e)}return __extends$1h(e,t),e.prototype._next=function(t){this.destination.next(Notification_1.Notification.createNext(t))},e.prototype._error=function(t){var e=this.destination;e.next(Notification_1.Notification.createError(t)),e.complete()},e.prototype._complete=function(){var t=this.destination;t.next(Notification_1.Notification.createComplete()),t.complete()},e}(Subscriber_1.Subscriber),materialize_1={materialize:materialize_2};Observable_1.Observable.prototype.materialize=materialize_1.materialize;var __extends$1i=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function reduce(t,e){var r=!1;return arguments.length>=2&&(r=!0),this.lift(new ReduceOperator(t,e,r))}var reduce_2=reduce,ReduceOperator=function(){function t(t,e,r){void 0===r&&(r=!1),this.accumulator=t,this.seed=e,this.hasSeed=r}return t.prototype.call=function(t,e){return e.subscribe(new ReduceSubscriber(t,this.accumulator,this.seed,this.hasSeed))},t}(),ReduceOperator_1=ReduceOperator,ReduceSubscriber=function(t){function e(e,r,n,i){t.call(this,e),this.accumulator=r,this.hasSeed=i,this.index=0,this.hasValue=!1,this.acc=n,this.hasSeed||this.index++}return __extends$1i(e,t),e.prototype._next=function(t){this.hasValue||(this.hasValue=this.hasSeed)?this._tryReduce(t):(this.acc=t,this.hasValue=!0)},e.prototype._tryReduce=function(t){var e;try{e=this.accumulator(this.acc,t,this.index++)}catch(t){return void this.destination.error(t)}this.acc=e},e.prototype._complete=function(){(this.hasValue||this.hasSeed)&&this.destination.next(this.acc),this.destination.complete()},e}(Subscriber_1.Subscriber),ReduceSubscriber_1=ReduceSubscriber,reduce_1={reduce:reduce_2,ReduceOperator:ReduceOperator_1,ReduceSubscriber:ReduceSubscriber_1};function max(t){var e="function"==typeof t?function(e,r){return t(e,r)>0?e:r}:function(t,e){return t>e?t:e};return this.lift(new reduce_1.ReduceOperator(e))}var max_2=max,max_1={max:max_2};Observable_1.Observable.prototype.max=max_1.max,Observable_1.Observable.prototype.merge=merge_1.merge,Observable_1.Observable.prototype.mergeAll=mergeAll_1.mergeAll,Observable_1.Observable.prototype.mergeMap=mergeMap_1.mergeMap,Observable_1.Observable.prototype.flatMap=mergeMap_1.mergeMap,Observable_1.Observable.prototype.flatMapTo=mergeMapTo_1.mergeMapTo,Observable_1.Observable.prototype.mergeMapTo=mergeMapTo_1.mergeMapTo;var __extends$1j=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function mergeScan(t,e,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),this.lift(new MergeScanOperator(t,e,r))}var mergeScan_2=mergeScan,MergeScanOperator=function(){function t(t,e,r){this.accumulator=t,this.seed=e,this.concurrent=r}return t.prototype.call=function(t,e){return e.subscribe(new MergeScanSubscriber(t,this.accumulator,this.seed,this.concurrent))},t}(),MergeScanOperator_1=MergeScanOperator,MergeScanSubscriber=function(t){function e(e,r,n,i){t.call(this,e),this.accumulator=r,this.acc=n,this.concurrent=i,this.hasValue=!1,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}return __extends$1j(e,t),e.prototype._next=function(t){if(this.active<this.concurrent){var e=this.index++,r=tryCatch_1.tryCatch(this.accumulator)(this.acc,t),n=this.destination;r===errorObject.errorObject?n.error(errorObject.errorObject.e):(this.active++,this._innerSub(r,t,e))}else this.buffer.push(t)},e.prototype._innerSub=function(t,e,r){this.add(subscribeToResult_1.subscribeToResult(this,t,e,r))},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete())},e.prototype.notifyNext=function(t,e,r,n,i){var o=this.destination;this.acc=e,this.hasValue=!0,o.next(e)},e.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete())},e}(OuterSubscriber_1.OuterSubscriber),MergeScanSubscriber_1=MergeScanSubscriber,mergeScan_1={mergeScan:mergeScan_2,MergeScanOperator:MergeScanOperator_1,MergeScanSubscriber:MergeScanSubscriber_1};function min(t){var e="function"==typeof t?function(e,r){return t(e,r)<0?e:r}:function(t,e){return t<e?t:e};return this.lift(new reduce_1.ReduceOperator(e))}Observable_1.Observable.prototype.mergeScan=mergeScan_1.mergeScan;var min_2=min,min_1={min:min_2};Observable_1.Observable.prototype.min=min_1.min;var __extends$1k=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},ConnectableObservable=function(t){function e(e,r){t.call(this),this.source=e,this.subjectFactory=r,this._refCount=0,this._isComplete=!1}return __extends$1k(e,t),e.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},e.prototype.getSubject=function(){var t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject},e.prototype.connect=function(){var t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new Subscription_1.Subscription).add(this.source.subscribe(new ConnectableSubscriber(this.getSubject(),this))),t.closed?(this._connection=null,t=Subscription_1.Subscription.EMPTY):this._connection=t),t},e.prototype.refCount=function(){return this.lift(new RefCountOperator(this))},e}(Observable_1.Observable),ConnectableObservable_2=ConnectableObservable,connectableProto=ConnectableObservable.prototype,connectableObservableDescriptor={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:connectableProto._subscribe},_isComplete:{value:connectableProto._isComplete,writable:!0},getSubject:{value:connectableProto.getSubject},connect:{value:connectableProto.connect},refCount:{value:connectableProto.refCount}},ConnectableSubscriber=function(t){function e(e,r){t.call(this,e),this.connectable=r}return __extends$1k(e,t),e.prototype._error=function(e){this._unsubscribe(),t.prototype._error.call(this,e)},e.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}},e}(Subject_1.SubjectSubscriber),RefCountOperator=function(){function t(t){this.connectable=t}return t.prototype.call=function(t,e){var r=this.connectable;r._refCount++;var n=new RefCountSubscriber(t,r),i=e.subscribe(n);return n.closed||(n.connection=r.connect()),i},t}(),RefCountSubscriber=function(t){function e(e,r){t.call(this,e),this.connectable=r}return __extends$1k(e,t),e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;if(e<=0)this.connection=null;else if(t._refCount=e-1,e>1)this.connection=null;else{var r=this.connection,n=t._connection;this.connection=null,!n||r&&n!==r||n.unsubscribe()}}else this.connection=null},e}(Subscriber_1.Subscriber),ConnectableObservable_1={ConnectableObservable:ConnectableObservable_2,connectableObservableDescriptor:connectableObservableDescriptor};function multicast(t,e){var r;if(r="function"==typeof t?t:function(){return t},"function"==typeof e)return this.lift(new MulticastOperator(r,e));var n=Object.create(this,ConnectableObservable_1.connectableObservableDescriptor);return n.source=this,n.subjectFactory=r,n}var multicast_2=multicast,MulticastOperator=function(){function t(t,e){this.subjectFactory=t,this.selector=e}return t.prototype.call=function(t,e){var r=this.selector,n=this.subjectFactory(),i=r(n).subscribe(t);return i.add(e.subscribe(n)),i},t}(),MulticastOperator_1=MulticastOperator,multicast_1={multicast:multicast_2,MulticastOperator:MulticastOperator_1};Observable_1.Observable.prototype.multicast=multicast_1.multicast,Observable_1.Observable.prototype.observeOn=observeOn_1.observeOn,Observable_1.Observable.prototype.onErrorResumeNext=onErrorResumeNext_1.onErrorResumeNext;var __extends$1l=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function pairwise(){return this.lift(new PairwiseOperator)}var pairwise_2=pairwise,PairwiseOperator=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new PairwiseSubscriber(t))},t}(),PairwiseSubscriber=function(t){function e(e){t.call(this,e),this.hasPrev=!1}return __extends$1l(e,t),e.prototype._next=function(t){this.hasPrev?this.destination.next([this.prev,t]):this.hasPrev=!0,this.prev=t},e}(Subscriber_1.Subscriber),pairwise_1={pairwise:pairwise_2};function not(t,e){function r(){return!r.pred.apply(r.thisArg,arguments)}return r.pred=t,r.thisArg=e,r}Observable_1.Observable.prototype.pairwise=pairwise_1.pairwise;var not_2=not,not_1={not:not_2};function partition(t,e){return[filter_1.filter.call(this,t,e),filter_1.filter.call(this,not_1.not(t,e))]}var partition_2=partition,partition_1={partition:partition_2};function pluck(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=t.length;if(0===r)throw new Error("list of properties cannot be empty.");return map_1.map.call(this,plucker(t,r))}Observable_1.Observable.prototype.partition=partition_1.partition;var pluck_2=pluck;function plucker(t,e){return function(r){for(var n=r,i=0;i<e;i++){var o=n[t[i]];if(void 0===o)return;n=o}return n}}var pluck_1={pluck:pluck_2};function publish(t){return t?multicast_1.multicast.call(this,function(){return new Subject_1.Subject},t):multicast_1.multicast.call(this,new Subject_1.Subject)}Observable_1.Observable.prototype.pluck=pluck_1.pluck;var publish_2=publish,publish_1={publish:publish_2};Observable_1.Observable.prototype.publish=publish_1.publish;var __extends$1m=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},BehaviorSubject=function(t){function e(e){t.call(this),this._value=e}return __extends$1m(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype._subscribe=function(e){var r=t.prototype._subscribe.call(this,e);return r&&!r.closed&&e.next(this._value),r},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new ObjectUnsubscribedError_1.ObjectUnsubscribedError;return this._value},e.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},e}(Subject_1.Subject),BehaviorSubject_2=BehaviorSubject,BehaviorSubject_1={BehaviorSubject:BehaviorSubject_2};function publishBehavior(t){return multicast_1.multicast.call(this,new BehaviorSubject_1.BehaviorSubject(t))}var publishBehavior_2=publishBehavior,publishBehavior_1={publishBehavior:publishBehavior_2};function publishReplay(t,e,r){return void 0===t&&(t=Number.POSITIVE_INFINITY),void 0===e&&(e=Number.POSITIVE_INFINITY),multicast_1.multicast.call(this,new ReplaySubject_1.ReplaySubject(t,e,r))}Observable_1.Observable.prototype.publishBehavior=publishBehavior_1.publishBehavior;var publishReplay_2=publishReplay,publishReplay_1={publishReplay:publishReplay_2};function publishLast(){return multicast_1.multicast.call(this,new AsyncSubject_1.AsyncSubject)}Observable_1.Observable.prototype.publishReplay=publishReplay_1.publishReplay;var publishLast_2=publishLast,publishLast_1={publishLast:publishLast_2};Observable_1.Observable.prototype.publishLast=publishLast_1.publishLast,Observable_1.Observable.prototype.race=race_1.race,Observable_1.Observable.prototype.reduce=reduce_1.reduce;var __extends$1n=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function repeat(t){return void 0===t&&(t=-1),0===t?new EmptyObservable_1.EmptyObservable:t<0?this.lift(new RepeatOperator(-1,this)):this.lift(new RepeatOperator(t-1,this))}var repeat_2=repeat,RepeatOperator=function(){function t(t,e){this.count=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new RepeatSubscriber(t,this.count,this.source))},t}(),RepeatSubscriber=function(t){function e(e,r,n){t.call(this,e),this.count=r,this.source=n}return __extends$1n(e,t),e.prototype.complete=function(){if(!this.isStopped){var e=this.source,r=this.count;if(0===r)return t.prototype.complete.call(this);r>-1&&(this.count=r-1),e.subscribe(this._unsubscribeAndRecycle())}},e}(Subscriber_1.Subscriber),repeat_1={repeat:repeat_2};Observable_1.Observable.prototype.repeat=repeat_1.repeat;var __extends$1o=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function repeatWhen(t){return this.lift(new RepeatWhenOperator(t))}var repeatWhen_2=repeatWhen,RepeatWhenOperator=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){return e.subscribe(new RepeatWhenSubscriber(t,this.notifier,e))},t}(),RepeatWhenSubscriber=function(t){function e(e,r,n){t.call(this,e),this.notifier=r,this.source=n,this.sourceIsBeingSubscribedTo=!0}return __extends$1o(e,t),e.prototype.notifyNext=function(t,e,r,n,i){this.sourceIsBeingSubscribedTo=!0,this.source.subscribe(this)},e.prototype.notifyComplete=function(e){if(!1===this.sourceIsBeingSubscribedTo)return t.prototype.complete.call(this)},e.prototype.complete=function(){if(this.sourceIsBeingSubscribedTo=!1,!this.isStopped){if(this.retries){if(this.retriesSubscription.closed)return t.prototype.complete.call(this)}else this.subscribeToRetries();this._unsubscribeAndRecycle(),this.notifications.next()}},e.prototype._unsubscribe=function(){var t=this.notifications,e=this.retriesSubscription;t&&(t.unsubscribe(),this.notifications=null),e&&(e.unsubscribe(),this.retriesSubscription=null),this.retries=null},e.prototype._unsubscribeAndRecycle=function(){var e=this.notifications,r=this.retries,n=this.retriesSubscription;return this.notifications=null,this.retries=null,this.retriesSubscription=null,t.prototype._unsubscribeAndRecycle.call(this),this.notifications=e,this.retries=r,this.retriesSubscription=n,this},e.prototype.subscribeToRetries=function(){this.notifications=new Subject_1.Subject;var e=tryCatch_1.tryCatch(this.notifier)(this.notifications);if(e===errorObject.errorObject)return t.prototype.complete.call(this);this.retries=e,this.retriesSubscription=subscribeToResult_1.subscribeToResult(this,e)},e}(OuterSubscriber_1.OuterSubscriber),repeatWhen_1={repeatWhen:repeatWhen_2};Observable_1.Observable.prototype.repeatWhen=repeatWhen_1.repeatWhen;var __extends$1p=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function retry(t){return void 0===t&&(t=-1),this.lift(new RetryOperator(t,this))}var retry_2=retry,RetryOperator=function(){function t(t,e){this.count=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new RetrySubscriber(t,this.count,this.source))},t}(),RetrySubscriber=function(t){function e(e,r,n){t.call(this,e),this.count=r,this.source=n}return __extends$1p(e,t),e.prototype.error=function(e){if(!this.isStopped){var r=this.source,n=this.count;if(0===n)return t.prototype.error.call(this,e);n>-1&&(this.count=n-1),r.subscribe(this._unsubscribeAndRecycle())}},e}(Subscriber_1.Subscriber),retry_1={retry:retry_2};Observable_1.Observable.prototype.retry=retry_1.retry;var __extends$1q=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function retryWhen(t){return this.lift(new RetryWhenOperator(t,this))}var retryWhen_2=retryWhen,RetryWhenOperator=function(){function t(t,e){this.notifier=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new RetryWhenSubscriber(t,this.notifier,this.source))},t}(),RetryWhenSubscriber=function(t){function e(e,r,n){t.call(this,e),this.notifier=r,this.source=n}return __extends$1q(e,t),e.prototype.error=function(e){if(!this.isStopped){var r=this.errors,n=this.retries,i=this.retriesSubscription;if(n)this.errors=null,this.retriesSubscription=null;else{if(r=new Subject_1.Subject,(n=tryCatch_1.tryCatch(this.notifier)(r))===errorObject.errorObject)return t.prototype.error.call(this,errorObject.errorObject.e);i=subscribeToResult_1.subscribeToResult(this,n)}this._unsubscribeAndRecycle(),this.errors=r,this.retries=n,this.retriesSubscription=i,r.next(e)}},e.prototype._unsubscribe=function(){var t=this.errors,e=this.retriesSubscription;t&&(t.unsubscribe(),this.errors=null),e&&(e.unsubscribe(),this.retriesSubscription=null),this.retries=null},e.prototype.notifyNext=function(t,e,r,n,i){var o=this.errors,s=this.retries,a=this.retriesSubscription;this.errors=null,this.retries=null,this.retriesSubscription=null,this._unsubscribeAndRecycle(),this.errors=o,this.retries=s,this.retriesSubscription=a,this.source.subscribe(this)},e}(OuterSubscriber_1.OuterSubscriber),retryWhen_1={retryWhen:retryWhen_2};Observable_1.Observable.prototype.retryWhen=retryWhen_1.retryWhen;var __extends$1r=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function sample(t){return this.lift(new SampleOperator(t))}var sample_2=sample,SampleOperator=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){var r=new SampleSubscriber(t),n=e.subscribe(r);return n.add(subscribeToResult_1.subscribeToResult(r,this.notifier)),n},t}(),SampleSubscriber=function(t){function e(){t.apply(this,arguments),this.hasValue=!1}return __extends$1r(e,t),e.prototype._next=function(t){this.value=t,this.hasValue=!0},e.prototype.notifyNext=function(t,e,r,n,i){this.emitValue()},e.prototype.notifyComplete=function(){this.emitValue()},e.prototype.emitValue=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.value))},e}(OuterSubscriber_1.OuterSubscriber),sample_1={sample:sample_2};Observable_1.Observable.prototype.sample=sample_1.sample;var __extends$1s=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function sampleTime(t,e){return void 0===e&&(e=async.async),this.lift(new SampleTimeOperator(t,e))}var sampleTime_2=sampleTime,SampleTimeOperator=function(){function t(t,e){this.period=t,this.scheduler=e}return t.prototype.call=function(t,e){return e.subscribe(new SampleTimeSubscriber(t,this.period,this.scheduler))},t}(),SampleTimeSubscriber=function(t){function e(e,r,n){t.call(this,e),this.period=r,this.scheduler=n,this.hasValue=!1,this.add(n.schedule(dispatchNotification,r,{subscriber:this,period:r}))}return __extends$1s(e,t),e.prototype._next=function(t){this.lastValue=t,this.hasValue=!0},e.prototype.notifyNext=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.lastValue))},e}(Subscriber_1.Subscriber);function dispatchNotification(t){var e=t.subscriber,r=t.period;e.notifyNext(),this.schedule(t,r)}var sampleTime_1={sampleTime:sampleTime_2};Observable_1.Observable.prototype.sampleTime=sampleTime_1.sampleTime;var __extends$1t=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function scan(t,e){var r=!1;return arguments.length>=2&&(r=!0),this.lift(new ScanOperator(t,e,r))}var scan_2=scan,ScanOperator=function(){function t(t,e,r){void 0===r&&(r=!1),this.accumulator=t,this.seed=e,this.hasSeed=r}return t.prototype.call=function(t,e){return e.subscribe(new ScanSubscriber(t,this.accumulator,this.seed,this.hasSeed))},t}(),ScanSubscriber=function(t){function e(e,r,n,i){t.call(this,e),this.accumulator=r,this._seed=n,this.hasSeed=i,this.index=0}return __extends$1t(e,t),Object.defineProperty(e.prototype,"seed",{get:function(){return this._seed},set:function(t){this.hasSeed=!0,this._seed=t},enumerable:!0,configurable:!0}),e.prototype._next=function(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)},e.prototype._tryNext=function(t){var e,r=this.index++;try{e=this.accumulator(this.seed,t,r)}catch(t){this.destination.error(t)}this.seed=e,this.destination.next(e)},e}(Subscriber_1.Subscriber),scan_1={scan:scan_2};Observable_1.Observable.prototype.scan=scan_1.scan;var __extends$1u=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function sequenceEqual(t,e){return this.lift(new SequenceEqualOperator(t,e))}var sequenceEqual_2=sequenceEqual,SequenceEqualOperator=function(){function t(t,e){this.compareTo=t,this.comparor=e}return t.prototype.call=function(t,e){return e.subscribe(new SequenceEqualSubscriber(t,this.compareTo,this.comparor))},t}(),SequenceEqualOperator_1=SequenceEqualOperator,SequenceEqualSubscriber=function(t){function e(e,r,n){t.call(this,e),this.compareTo=r,this.comparor=n,this._a=[],this._b=[],this._oneComplete=!1,this.add(r.subscribe(new SequenceEqualCompareToSubscriber(e,this)))}return __extends$1u(e,t),e.prototype._next=function(t){this._oneComplete&&0===this._b.length?this.emit(!1):(this._a.push(t),this.checkValues())},e.prototype._complete=function(){this._oneComplete?this.emit(0===this._a.length&&0===this._b.length):this._oneComplete=!0},e.prototype.checkValues=function(){for(var t=this._a,e=this._b,r=this.comparor;t.length>0&&e.length>0;){var n=t.shift(),i=e.shift(),o=!1;r?(o=tryCatch_1.tryCatch(r)(n,i))===errorObject.errorObject&&this.destination.error(errorObject.errorObject.e):o=n===i,o||this.emit(!1)}},e.prototype.emit=function(t){var e=this.destination;e.next(t),e.complete()},e.prototype.nextB=function(t){this._oneComplete&&0===this._a.length?this.emit(!1):(this._b.push(t),this.checkValues())},e}(Subscriber_1.Subscriber),SequenceEqualSubscriber_1=SequenceEqualSubscriber,SequenceEqualCompareToSubscriber=function(t){function e(e,r){t.call(this,e),this.parent=r}return __extends$1u(e,t),e.prototype._next=function(t){this.parent.nextB(t)},e.prototype._error=function(t){this.parent.error(t)},e.prototype._complete=function(){this.parent._complete()},e}(Subscriber_1.Subscriber),sequenceEqual_1={sequenceEqual:sequenceEqual_2,SequenceEqualOperator:SequenceEqualOperator_1,SequenceEqualSubscriber:SequenceEqualSubscriber_1};function shareSubjectFactory(){return new Subject_1.Subject}function share(){return multicast_1.multicast.call(this,shareSubjectFactory).refCount()}Observable_1.Observable.prototype.sequenceEqual=sequenceEqual_1.sequenceEqual;var share_2=share,share_1={share:share_2};function shareReplay(t,e,r){var n;return multicast_1.multicast.call(this,function(){return this._isComplete?n:n=new ReplaySubject_1.ReplaySubject(t,e,r)}).refCount()}Observable_1.Observable.prototype.share=share_1.share;var shareReplay_2=shareReplay,shareReplay_1={shareReplay:shareReplay_2};Observable_1.Observable.prototype.shareReplay=shareReplay_1.shareReplay;var __extends$1v=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function single(t){return this.lift(new SingleOperator(t,this))}var single_2=single,SingleOperator=function(){function t(t,e){this.predicate=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new SingleSubscriber(t,this.predicate,this.source))},t}(),SingleSubscriber=function(t){function e(e,r,n){t.call(this,e),this.predicate=r,this.source=n,this.seenValue=!1,this.index=0}return __extends$1v(e,t),e.prototype.applySingleValue=function(t){this.seenValue?this.destination.error("Sequence contains more than one element"):(this.seenValue=!0,this.singleValue=t)},e.prototype._next=function(t){var e=this.index++;this.predicate?this.tryNext(t,e):this.applySingleValue(t)},e.prototype.tryNext=function(t,e){try{this.predicate(t,e,this.source)&&this.applySingleValue(t)}catch(t){this.destination.error(t)}},e.prototype._complete=function(){var t=this.destination;this.index>0?(t.next(this.seenValue?this.singleValue:void 0),t.complete()):t.error(new EmptyError_1.EmptyError)},e}(Subscriber_1.Subscriber),single_1={single:single_2};Observable_1.Observable.prototype.single=single_1.single;var __extends$1w=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function skip(t){return this.lift(new SkipOperator(t))}var skip_2=skip,SkipOperator=function(){function t(t){this.total=t}return t.prototype.call=function(t,e){return e.subscribe(new SkipSubscriber(t,this.total))},t}(),SkipSubscriber=function(t){function e(e,r){t.call(this,e),this.total=r,this.count=0}return __extends$1w(e,t),e.prototype._next=function(t){++this.count>this.total&&this.destination.next(t)},e}(Subscriber_1.Subscriber),skip_1={skip:skip_2};Observable_1.Observable.prototype.skip=skip_1.skip;var __extends$1x=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function skipLast(t){return this.lift(new SkipLastOperator(t))}var skipLast_2=skipLast,SkipLastOperator=function(){function t(t){if(this._skipCount=t,this._skipCount<0)throw new ArgumentOutOfRangeError_1.ArgumentOutOfRangeError}return t.prototype.call=function(t,e){return 0===this._skipCount?e.subscribe(new Subscriber_1.Subscriber(t)):e.subscribe(new SkipLastSubscriber(t,this._skipCount))},t}(),SkipLastSubscriber=function(t){function e(e,r){t.call(this,e),this._skipCount=r,this._count=0,this._ring=new Array(r)}return __extends$1x(e,t),e.prototype._next=function(t){var e=this._skipCount,r=this._count++;if(r<e)this._ring[r]=t;else{var n=r%e,i=this._ring,o=i[n];i[n]=t,this.destination.next(o)}},e}(Subscriber_1.Subscriber),skipLast_1={skipLast:skipLast_2};Observable_1.Observable.prototype.skipLast=skipLast_1.skipLast;var __extends$1y=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function skipUntil(t){return this.lift(new SkipUntilOperator(t))}var skipUntil_2=skipUntil,SkipUntilOperator=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){return e.subscribe(new SkipUntilSubscriber(t,this.notifier))},t}(),SkipUntilSubscriber=function(t){function e(e,r){t.call(this,e),this.hasValue=!1,this.isInnerStopped=!1,this.add(subscribeToResult_1.subscribeToResult(this,r))}return __extends$1y(e,t),e.prototype._next=function(e){this.hasValue&&t.prototype._next.call(this,e)},e.prototype._complete=function(){this.isInnerStopped?t.prototype._complete.call(this):this.unsubscribe()},e.prototype.notifyNext=function(t,e,r,n,i){this.hasValue=!0},e.prototype.notifyComplete=function(){this.isInnerStopped=!0,this.isStopped&&t.prototype._complete.call(this)},e}(OuterSubscriber_1.OuterSubscriber),skipUntil_1={skipUntil:skipUntil_2};Observable_1.Observable.prototype.skipUntil=skipUntil_1.skipUntil;var __extends$1z=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function skipWhile(t){return this.lift(new SkipWhileOperator(t))}var skipWhile_2=skipWhile,SkipWhileOperator=function(){function t(t){this.predicate=t}return t.prototype.call=function(t,e){return e.subscribe(new SkipWhileSubscriber(t,this.predicate))},t}(),SkipWhileSubscriber=function(t){function e(e,r){t.call(this,e),this.predicate=r,this.skipping=!0,this.index=0}return __extends$1z(e,t),e.prototype._next=function(t){var e=this.destination;this.skipping&&this.tryCallPredicate(t),this.skipping||e.next(t)},e.prototype.tryCallPredicate=function(t){try{var e=this.predicate(t,this.index++);this.skipping=Boolean(e)}catch(t){this.destination.error(t)}},e}(Subscriber_1.Subscriber),skipWhile_1={skipWhile:skipWhile_2};function startWith(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=t[t.length-1];isScheduler_1.isScheduler(r)?t.pop():r=null;var n=t.length;return 1===n?concat_1.concatStatic(new ScalarObservable_1.ScalarObservable(t[0],r),this):n>1?concat_1.concatStatic(new ArrayObservable_1.ArrayObservable(t,r),this):concat_1.concatStatic(new EmptyObservable_1.EmptyObservable(r),this)}Observable_1.Observable.prototype.skipWhile=skipWhile_1.skipWhile;var startWith_2=startWith,startWith_1={startWith:startWith_2};Observable_1.Observable.prototype.startWith=startWith_1.startWith;var ImmediateDefinition=function(){function t(t){if(this.root=t,t.setImmediate&&"function"==typeof t.setImmediate)this.setImmediate=t.setImmediate.bind(t),this.clearImmediate=t.clearImmediate.bind(t);else{this.nextHandle=1,this.tasksByHandle={},this.currentlyRunningATask=!1,this.canUseProcessNextTick()?this.setImmediate=this.createProcessNextTickSetImmediate():this.canUsePostMessage()?this.setImmediate=this.createPostMessageSetImmediate():this.canUseMessageChannel()?this.setImmediate=this.createMessageChannelSetImmediate():this.canUseReadyStateChange()?this.setImmediate=this.createReadyStateChangeSetImmediate():this.setImmediate=this.createSetTimeoutSetImmediate();var e=function t(e){delete t.instance.tasksByHandle[e]};e.instance=this,this.clearImmediate=e}}return t.prototype.identify=function(t){return this.root.Object.prototype.toString.call(t)},t.prototype.canUseProcessNextTick=function(){return"[object process]"===this.identify(this.root.process)},t.prototype.canUseMessageChannel=function(){return Boolean(this.root.MessageChannel)},t.prototype.canUseReadyStateChange=function(){var t=this.root.document;return Boolean(t&&"onreadystatechange"in t.createElement("script"))},t.prototype.canUsePostMessage=function(){var t=this.root;if(t.postMessage&&!t.importScripts){var e=!0,r=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=r,e}return!1},t.prototype.partiallyApplied=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=function t(){var e=t.handler,r=t.args;"function"==typeof e?e.apply(void 0,r):new Function(""+e)()};return n.handler=t,n.args=e,n},t.prototype.addFromSetImmediateArguments=function(t){return this.tasksByHandle[this.nextHandle]=this.partiallyApplied.apply(void 0,t),this.nextHandle++},t.prototype.createProcessNextTickSetImmediate=function(){var t=function t(){var e=t.instance,r=e.addFromSetImmediateArguments(arguments);return e.root.process.nextTick(e.partiallyApplied(e.runIfPresent,r)),r};return t.instance=this,t},t.prototype.createPostMessageSetImmediate=function(){var t=this.root,e="setImmediate$"+t.Math.random()+"$",r=function r(n){var i=r.instance;n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(e)&&i.runIfPresent(+n.data.slice(e.length))};r.instance=this,t.addEventListener("message",r,!1);var n=function t(){var e=t.messagePrefix,r=t.instance,n=r.addFromSetImmediateArguments(arguments);return r.root.postMessage(e+n,"*"),n};return n.instance=this,n.messagePrefix=e,n},t.prototype.runIfPresent=function(t){if(this.currentlyRunningATask)this.root.setTimeout(this.partiallyApplied(this.runIfPresent,t),0);else{var e=this.tasksByHandle[t];if(e){this.currentlyRunningATask=!0;try{e()}finally{this.clearImmediate(t),this.currentlyRunningATask=!1}}}},t.prototype.createMessageChannelSetImmediate=function(){var t=this,e=new this.root.MessageChannel;e.port1.onmessage=function(e){var r=e.data;t.runIfPresent(r)};var r=function t(){var e=t.channel,r=t.instance.addFromSetImmediateArguments(arguments);return e.port2.postMessage(r),r};return r.channel=e,r.instance=this,r},t.prototype.createReadyStateChangeSetImmediate=function(){var t=function t(){var e=t.instance,r=e.root.document,n=r.documentElement,i=e.addFromSetImmediateArguments(arguments),o=r.createElement("script");return o.onreadystatechange=function(){e.runIfPresent(i),o.onreadystatechange=null,n.removeChild(o),o=null},n.appendChild(o),i};return t.instance=this,t},t.prototype.createSetTimeoutSetImmediate=function(){var t=function t(){var e=t.instance,r=e.addFromSetImmediateArguments(arguments);return e.root.setTimeout(e.partiallyApplied(e.runIfPresent,r),0),r};return t.instance=this,t},t}(),ImmediateDefinition_1=ImmediateDefinition,Immediate_1=new ImmediateDefinition(root.root),Immediate={ImmediateDefinition:ImmediateDefinition_1,Immediate:Immediate_1},__extends$1A=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},AsapAction=function(t){function e(e,r){t.call(this,e,r),this.scheduler=e,this.work=r}return __extends$1A(e,t),e.prototype.requestAsyncId=function(e,r,n){return void 0===n&&(n=0),null!==n&&n>0?t.prototype.requestAsyncId.call(this,e,r,n):(e.actions.push(this),e.scheduled||(e.scheduled=Immediate.Immediate.setImmediate(e.flush.bind(e,null))))},e.prototype.recycleAsyncId=function(e,r,n){if(void 0===n&&(n=0),null!==n&&n>0||null===n&&this.delay>0)return t.prototype.recycleAsyncId.call(this,e,r,n);0===e.actions.length&&(Immediate.Immediate.clearImmediate(r),e.scheduled=void 0)},e}(AsyncAction_1.AsyncAction),AsapAction_2=AsapAction,AsapAction_1={AsapAction:AsapAction_2},__extends$1B=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},AsapScheduler=function(t){function e(){t.apply(this,arguments)}return __extends$1B(e,t),e.prototype.flush=function(t){this.active=!0,this.scheduled=void 0;var e,r=this.actions,n=-1,i=r.length;t=t||r.shift();do{if(e=t.execute(t.state,t.delay))break}while(++n<i&&(t=r.shift()));if(this.active=!1,e){for(;++n<i&&(t=r.shift());)t.unsubscribe();throw e}},e}(AsyncScheduler_1.AsyncScheduler),AsapScheduler_2=AsapScheduler,AsapScheduler_1={AsapScheduler:AsapScheduler_2},asap_1=new AsapScheduler_1.AsapScheduler(AsapAction_1.AsapAction),asap={asap:asap_1},__extends$1C=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},SubscribeOnObservable=function(t){function e(e,r,n){void 0===r&&(r=0),void 0===n&&(n=asap.asap),t.call(this),this.source=e,this.delayTime=r,this.scheduler=n,(!isNumeric_1.isNumeric(r)||r<0)&&(this.delayTime=0),n&&"function"==typeof n.schedule||(this.scheduler=asap.asap)}return __extends$1C(e,t),e.create=function(t,r,n){return void 0===r&&(r=0),void 0===n&&(n=asap.asap),new e(t,r,n)},e.dispatch=function(t){var e=t.source,r=t.subscriber;return this.add(e.subscribe(r))},e.prototype._subscribe=function(t){var r=this.delayTime,n=this.source;return this.scheduler.schedule(e.dispatch,r,{source:n,subscriber:t})},e}(Observable_1.Observable),SubscribeOnObservable_2=SubscribeOnObservable,SubscribeOnObservable_1={SubscribeOnObservable:SubscribeOnObservable_2};function subscribeOn(t,e){return void 0===e&&(e=0),this.lift(new SubscribeOnOperator(t,e))}var subscribeOn_2=subscribeOn,SubscribeOnOperator=function(){function t(t,e){this.scheduler=t,this.delay=e}return t.prototype.call=function(t,e){return new SubscribeOnObservable_1.SubscribeOnObservable(e,this.delay,this.scheduler).subscribe(t)},t}(),subscribeOn_1={subscribeOn:subscribeOn_2};Observable_1.Observable.prototype.subscribeOn=subscribeOn_1.subscribeOn;var __extends$1D=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function _switch(){return this.lift(new SwitchOperator)}var _switch_2=_switch,SwitchOperator=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new SwitchSubscriber(t))},t}(),SwitchSubscriber=function(t){function e(e){t.call(this,e),this.active=0,this.hasCompleted=!1}return __extends$1D(e,t),e.prototype._next=function(t){this.unsubscribeInner(),this.active++,this.add(this.innerSubscription=subscribeToResult_1.subscribeToResult(this,t))},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&this.destination.complete()},e.prototype.unsubscribeInner=function(){this.active=this.active>0?this.active-1:0;var t=this.innerSubscription;t&&(t.unsubscribe(),this.remove(t))},e.prototype.notifyNext=function(t,e,r,n,i){this.destination.next(e)},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(){this.unsubscribeInner(),this.hasCompleted&&0===this.active&&this.destination.complete()},e}(OuterSubscriber_1.OuterSubscriber),_switch_1={_switch:_switch_2};Observable_1.Observable.prototype.switch=_switch_1._switch,Observable_1.Observable.prototype._switch=_switch_1._switch;var __extends$1E=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function switchMap(t,e){return this.lift(new SwitchMapOperator(t,e))}var switchMap_2=switchMap,SwitchMapOperator=function(){function t(t,e){this.project=t,this.resultSelector=e}return t.prototype.call=function(t,e){return e.subscribe(new SwitchMapSubscriber(t,this.project,this.resultSelector))},t}(),SwitchMapSubscriber=function(t){function e(e,r,n){t.call(this,e),this.project=r,this.resultSelector=n,this.index=0}return __extends$1E(e,t),e.prototype._next=function(t){var e,r=this.index++;try{e=this.project(t,r)}catch(t){return void this.destination.error(t)}this._innerSub(e,t,r)},e.prototype._innerSub=function(t,e,r){var n=this.innerSubscription;n&&n.unsubscribe(),this.add(this.innerSubscription=subscribeToResult_1.subscribeToResult(this,t,e,r))},e.prototype._complete=function(){var e=this.innerSubscription;e&&!e.closed||t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){this.innerSubscription=null},e.prototype.notifyComplete=function(e){this.remove(e),this.innerSubscription=null,this.isStopped&&t.prototype._complete.call(this)},e.prototype.notifyNext=function(t,e,r,n,i){this.resultSelector?this._tryNotifyNext(t,e,r,n):this.destination.next(e)},e.prototype._tryNotifyNext=function(t,e,r,n){var i;try{i=this.resultSelector(t,e,r,n)}catch(t){return void this.destination.error(t)}this.destination.next(i)},e}(OuterSubscriber_1.OuterSubscriber),switchMap_1={switchMap:switchMap_2};Observable_1.Observable.prototype.switchMap=switchMap_1.switchMap;var __extends$1F=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function switchMapTo(t,e){return this.lift(new SwitchMapToOperator(t,e))}var switchMapTo_2=switchMapTo,SwitchMapToOperator=function(){function t(t,e){this.observable=t,this.resultSelector=e}return t.prototype.call=function(t,e){return e.subscribe(new SwitchMapToSubscriber(t,this.observable,this.resultSelector))},t}(),SwitchMapToSubscriber=function(t){function e(e,r,n){t.call(this,e),this.inner=r,this.resultSelector=n,this.index=0}return __extends$1F(e,t),e.prototype._next=function(t){var e=this.innerSubscription;e&&e.unsubscribe(),this.add(this.innerSubscription=subscribeToResult_1.subscribeToResult(this,this.inner,t,this.index++))},e.prototype._complete=function(){var e=this.innerSubscription;e&&!e.closed||t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){this.innerSubscription=null},e.prototype.notifyComplete=function(e){this.remove(e),this.innerSubscription=null,this.isStopped&&t.prototype._complete.call(this)},e.prototype.notifyNext=function(t,e,r,n,i){var o=this.resultSelector,s=this.destination;o?this.tryResultSelector(t,e,r,n):s.next(e)},e.prototype.tryResultSelector=function(t,e,r,n){var i,o=this.resultSelector,s=this.destination;try{i=o(t,e,r,n)}catch(t){return void s.error(t)}s.next(i)},e}(OuterSubscriber_1.OuterSubscriber),switchMapTo_1={switchMapTo:switchMapTo_2};Observable_1.Observable.prototype.switchMapTo=switchMapTo_1.switchMapTo;var __extends$1G=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function take(t){return 0===t?new EmptyObservable_1.EmptyObservable:this.lift(new TakeOperator(t))}var take_2=take,TakeOperator=function(){function t(t){if(this.total=t,this.total<0)throw new ArgumentOutOfRangeError_1.ArgumentOutOfRangeError}return t.prototype.call=function(t,e){return e.subscribe(new TakeSubscriber(t,this.total))},t}(),TakeSubscriber=function(t){function e(e,r){t.call(this,e),this.total=r,this.count=0}return __extends$1G(e,t),e.prototype._next=function(t){var e=this.total,r=++this.count;r<=e&&(this.destination.next(t),r===e&&(this.destination.complete(),this.unsubscribe()))},e}(Subscriber_1.Subscriber),take_1={take:take_2};Observable_1.Observable.prototype.take=take_1.take;var __extends$1H=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function takeLast(t){return 0===t?new EmptyObservable_1.EmptyObservable:this.lift(new TakeLastOperator(t))}var takeLast_2=takeLast,TakeLastOperator=function(){function t(t){if(this.total=t,this.total<0)throw new ArgumentOutOfRangeError_1.ArgumentOutOfRangeError}return t.prototype.call=function(t,e){return e.subscribe(new TakeLastSubscriber(t,this.total))},t}(),TakeLastSubscriber=function(t){function e(e,r){t.call(this,e),this.total=r,this.ring=new Array,this.count=0}return __extends$1H(e,t),e.prototype._next=function(t){var e=this.ring,r=this.total,n=this.count++;e.length<r?e.push(t):e[n%r]=t},e.prototype._complete=function(){var t=this.destination,e=this.count;if(e>0)for(var r=this.count>=this.total?this.total:this.count,n=this.ring,i=0;i<r;i++){var o=e++%r;t.next(n[o])}t.complete()},e}(Subscriber_1.Subscriber),takeLast_1={takeLast:takeLast_2};Observable_1.Observable.prototype.takeLast=takeLast_1.takeLast;var __extends$1I=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function takeUntil(t){return this.lift(new TakeUntilOperator(t))}var takeUntil_2=takeUntil,TakeUntilOperator=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){return e.subscribe(new TakeUntilSubscriber(t,this.notifier))},t}(),TakeUntilSubscriber=function(t){function e(e,r){t.call(this,e),this.notifier=r,this.add(subscribeToResult_1.subscribeToResult(this,r))}return __extends$1I(e,t),e.prototype.notifyNext=function(t,e,r,n,i){this.complete()},e.prototype.notifyComplete=function(){},e}(OuterSubscriber_1.OuterSubscriber),takeUntil_1={takeUntil:takeUntil_2};Observable_1.Observable.prototype.takeUntil=takeUntil_1.takeUntil;var __extends$1J=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function takeWhile(t){return this.lift(new TakeWhileOperator(t))}var takeWhile_2=takeWhile,TakeWhileOperator=function(){function t(t){this.predicate=t}return t.prototype.call=function(t,e){return e.subscribe(new TakeWhileSubscriber(t,this.predicate))},t}(),TakeWhileSubscriber=function(t){function e(e,r){t.call(this,e),this.predicate=r,this.index=0}return __extends$1J(e,t),e.prototype._next=function(t){var e,r=this.destination;try{e=this.predicate(t,this.index++)}catch(t){return void r.error(t)}this.nextOrComplete(t,e)},e.prototype.nextOrComplete=function(t,e){var r=this.destination;Boolean(e)?r.next(t):r.complete()},e}(Subscriber_1.Subscriber),takeWhile_1={takeWhile:takeWhile_2};Observable_1.Observable.prototype.takeWhile=takeWhile_1.takeWhile;var throttle_1=createCommonjsModule(function(t,e){var r=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};e.defaultThrottleConfig={leading:!0,trailing:!1},e.throttle=function(t,r){return void 0===r&&(r=e.defaultThrottleConfig),this.lift(new n(t,r.leading,r.trailing))};var n=function(){function t(t,e,r){this.durationSelector=t,this.leading=e,this.trailing=r}return t.prototype.call=function(t,e){return e.subscribe(new i(t,this.durationSelector,this.leading,this.trailing))},t}(),i=function(t){function e(e,r,n,i){t.call(this,e),this.destination=e,this.durationSelector=r,this._leading=n,this._trailing=i,this._hasTrailingValue=!1}return r(e,t),e.prototype._next=function(t){if(this.throttled)this._trailing&&(this._hasTrailingValue=!0,this._trailingValue=t);else{var e=this.tryDurationSelector(t);e&&this.add(this.throttled=subscribeToResult_1.subscribeToResult(this,e)),this._leading&&(this.destination.next(t),this._trailing&&(this._hasTrailingValue=!0,this._trailingValue=t))}},e.prototype.tryDurationSelector=function(t){try{return this.durationSelector(t)}catch(t){return this.destination.error(t),null}},e.prototype._unsubscribe=function(){var t=this.throttled;this._trailingValue,this._hasTrailingValue,this._trailing;this._trailingValue=null,this._hasTrailingValue=!1,t&&(this.remove(t),this.throttled=null,t.unsubscribe())},e.prototype._sendTrailing=function(){var t=this,e=t.destination,r=t.throttled,n=t._trailing,i=t._trailingValue,o=t._hasTrailingValue;r&&n&&o&&(e.next(i),this._trailingValue=null,this._hasTrailingValue=!1)},e.prototype.notifyNext=function(t,e,r,n,i){this._sendTrailing(),this._unsubscribe()},e.prototype.notifyComplete=function(){this._sendTrailing(),this._unsubscribe()},e}(OuterSubscriber_1.OuterSubscriber)}),throttle_2=throttle_1.defaultThrottleConfig,throttle_3=throttle_1.throttle;Observable_1.Observable.prototype.throttle=throttle_1.throttle;var __extends$1K=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function throttleTime(t,e,r){return void 0===e&&(e=async.async),void 0===r&&(r=throttle_1.defaultThrottleConfig),this.lift(new ThrottleTimeOperator(t,e,r.leading,r.trailing))}var throttleTime_2=throttleTime,ThrottleTimeOperator=function(){function t(t,e,r,n){this.duration=t,this.scheduler=e,this.leading=r,this.trailing=n}return t.prototype.call=function(t,e){return e.subscribe(new ThrottleTimeSubscriber(t,this.duration,this.scheduler,this.leading,this.trailing))},t}(),ThrottleTimeSubscriber=function(t){function e(e,r,n,i,o){t.call(this,e),this.duration=r,this.scheduler=n,this.leading=i,this.trailing=o,this._hasTrailingValue=!1,this._trailingValue=null}return __extends$1K(e,t),e.prototype._next=function(t){this.throttled?this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(dispatchNext$5,this.duration,{subscriber:this})),this.leading&&this.destination.next(t))},e.prototype.clearThrottle=function(){var t=this.throttled;t&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),t.unsubscribe(),this.remove(t),this.throttled=null)},e}(Subscriber_1.Subscriber);function dispatchNext$5(t){t.subscriber.clearThrottle()}var throttleTime_1={throttleTime:throttleTime_2};Observable_1.Observable.prototype.throttleTime=throttleTime_1.throttleTime;var __extends$1L=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function timeInterval(t){return void 0===t&&(t=async.async),this.lift(new TimeIntervalOperator(t))}var timeInterval_2=timeInterval,TimeInterval=function(){return function(t,e){this.value=t,this.interval=e}}(),TimeInterval_1=TimeInterval,TimeIntervalOperator=function(){function t(t){this.scheduler=t}return t.prototype.call=function(t,e){return e.subscribe(new TimeIntervalSubscriber(t,this.scheduler))},t}(),TimeIntervalSubscriber=function(t){function e(e,r){t.call(this,e),this.scheduler=r,this.lastTime=0,this.lastTime=r.now()}return __extends$1L(e,t),e.prototype._next=function(t){var e=this.scheduler.now(),r=e-this.lastTime;this.lastTime=e,this.destination.next(new TimeInterval(t,r))},e}(Subscriber_1.Subscriber),timeInterval_1={timeInterval:timeInterval_2,TimeInterval:TimeInterval_1};Observable_1.Observable.prototype.timeInterval=timeInterval_1.timeInterval;var __extends$1M=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},TimeoutError=function(t){function e(){var e=t.call(this,"Timeout has occurred");this.name=e.name="TimeoutError",this.stack=e.stack,this.message=e.message}return __extends$1M(e,t),e}(Error),TimeoutError_2=TimeoutError,TimeoutError_1={TimeoutError:TimeoutError_2},__extends$1N=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function timeout(t,e){void 0===e&&(e=async.async);var r=isDate_1.isDate(t),n=r?+t-e.now():Math.abs(t);return this.lift(new TimeoutOperator(n,r,e,new TimeoutError_1.TimeoutError))}var timeout_2=timeout,TimeoutOperator=function(){function t(t,e,r,n){this.waitFor=t,this.absoluteTimeout=e,this.scheduler=r,this.errorInstance=n}return t.prototype.call=function(t,e){return e.subscribe(new TimeoutSubscriber(t,this.absoluteTimeout,this.waitFor,this.scheduler,this.errorInstance))},t}(),TimeoutSubscriber=function(t){function e(e,r,n,i,o){t.call(this,e),this.absoluteTimeout=r,this.waitFor=n,this.scheduler=i,this.errorInstance=o,this.action=null,this.scheduleTimeout()}return __extends$1N(e,t),e.dispatchTimeout=function(t){t.error(t.errorInstance)},e.prototype.scheduleTimeout=function(){var t=this.action;t?this.action=t.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(e.dispatchTimeout,this.waitFor,this))},e.prototype._next=function(e){this.absoluteTimeout||this.scheduleTimeout(),t.prototype._next.call(this,e)},e.prototype._unsubscribe=function(){this.action=null,this.scheduler=null,this.errorInstance=null},e}(Subscriber_1.Subscriber),timeout_1={timeout:timeout_2};Observable_1.Observable.prototype.timeout=timeout_1.timeout;var __extends$1O=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function timeoutWith(t,e,r){void 0===r&&(r=async.async);var n=isDate_1.isDate(t),i=n?+t-r.now():Math.abs(t);return this.lift(new TimeoutWithOperator(i,n,e,r))}var timeoutWith_2=timeoutWith,TimeoutWithOperator=function(){function t(t,e,r,n){this.waitFor=t,this.absoluteTimeout=e,this.withObservable=r,this.scheduler=n}return t.prototype.call=function(t,e){return e.subscribe(new TimeoutWithSubscriber(t,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},t}(),TimeoutWithSubscriber=function(t){function e(e,r,n,i,o){t.call(this,e),this.absoluteTimeout=r,this.waitFor=n,this.withObservable=i,this.scheduler=o,this.action=null,this.scheduleTimeout()}return __extends$1O(e,t),e.dispatchTimeout=function(t){var e=t.withObservable;t._unsubscribeAndRecycle(),t.add(subscribeToResult_1.subscribeToResult(t,e))},e.prototype.scheduleTimeout=function(){var t=this.action;t?this.action=t.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(e.dispatchTimeout,this.waitFor,this))},e.prototype._next=function(e){this.absoluteTimeout||this.scheduleTimeout(),t.prototype._next.call(this,e)},e.prototype._unsubscribe=function(){this.action=null,this.scheduler=null,this.withObservable=null},e}(OuterSubscriber_1.OuterSubscriber),timeoutWith_1={timeoutWith:timeoutWith_2};Observable_1.Observable.prototype.timeoutWith=timeoutWith_1.timeoutWith;var __extends$1P=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function timestamp(t){return void 0===t&&(t=async.async),this.lift(new TimestampOperator(t))}var timestamp_2=timestamp,Timestamp=function(){return function(t,e){this.value=t,this.timestamp=e}}(),Timestamp_1=Timestamp,TimestampOperator=function(){function t(t){this.scheduler=t}return t.prototype.call=function(t,e){return e.subscribe(new TimestampSubscriber(t,this.scheduler))},t}(),TimestampSubscriber=function(t){function e(e,r){t.call(this,e),this.scheduler=r}return __extends$1P(e,t),e.prototype._next=function(t){var e=this.scheduler.now();this.destination.next(new Timestamp(t,e))},e}(Subscriber_1.Subscriber),timestamp_1={timestamp:timestamp_2,Timestamp:Timestamp_1};Observable_1.Observable.prototype.timestamp=timestamp_1.timestamp;var __extends$1Q=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function toArray(){return this.lift(new ToArrayOperator)}var toArray_2=toArray,ToArrayOperator=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new ToArraySubscriber(t))},t}(),ToArraySubscriber=function(t){function e(e){t.call(this,e),this.array=[]}return __extends$1Q(e,t),e.prototype._next=function(t){this.array.push(t)},e.prototype._complete=function(){this.destination.next(this.array),this.destination.complete()},e}(Subscriber_1.Subscriber),toArray_1={toArray:toArray_2};function toPromise(t){var e=this;if(t||(root.root.Rx&&root.root.Rx.config&&root.root.Rx.config.Promise?t=root.root.Rx.config.Promise:root.root.Promise&&(t=root.root.Promise)),!t)throw new Error("no Promise impl found");return new t(function(t,r){var n;e.subscribe(function(t){return n=t},function(t){return r(t)},function(){return t(n)})})}Observable_1.Observable.prototype.toArray=toArray_1.toArray;var toPromise_2=toPromise,toPromise_1={toPromise:toPromise_2};Observable_1.Observable.prototype.toPromise=toPromise_1.toPromise;var __extends$1R=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function window$1(t){return this.lift(new WindowOperator(t))}var window_2=window$1,WindowOperator=function(){function t(t){this.windowBoundaries=t}return t.prototype.call=function(t,e){var r=new WindowSubscriber(t),n=e.subscribe(r);return n.closed||r.add(subscribeToResult_1.subscribeToResult(r,this.windowBoundaries)),n},t}(),WindowSubscriber=function(t){function e(e){t.call(this,e),this.window=new Subject_1.Subject,e.next(this.window)}return __extends$1R(e,t),e.prototype.notifyNext=function(t,e,r,n,i){this.openWindow()},e.prototype.notifyError=function(t,e){this._error(t)},e.prototype.notifyComplete=function(t){this._complete()},e.prototype._next=function(t){this.window.next(t)},e.prototype._error=function(t){this.window.error(t),this.destination.error(t)},e.prototype._complete=function(){this.window.complete(),this.destination.complete()},e.prototype._unsubscribe=function(){this.window=null},e.prototype.openWindow=function(){var t=this.window;t&&t.complete();var e=this.destination,r=this.window=new Subject_1.Subject;e.next(r)},e}(OuterSubscriber_1.OuterSubscriber),window_1={window:window_2};Observable_1.Observable.prototype.window=window_1.window;var __extends$1S=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function windowCount(t,e){return void 0===e&&(e=0),this.lift(new WindowCountOperator(t,e))}var windowCount_2=windowCount,WindowCountOperator=function(){function t(t,e){this.windowSize=t,this.startWindowEvery=e}return t.prototype.call=function(t,e){return e.subscribe(new WindowCountSubscriber(t,this.windowSize,this.startWindowEvery))},t}(),WindowCountSubscriber=function(t){function e(e,r,n){t.call(this,e),this.destination=e,this.windowSize=r,this.startWindowEvery=n,this.windows=[new Subject_1.Subject],this.count=0,e.next(this.windows[0])}return __extends$1S(e,t),e.prototype._next=function(t){for(var e=this.startWindowEvery>0?this.startWindowEvery:this.windowSize,r=this.destination,n=this.windowSize,i=this.windows,o=i.length,s=0;s<o&&!this.closed;s++)i[s].next(t);var a=this.count-n+1;if(a>=0&&a%e==0&&!this.closed&&i.shift().complete(),++this.count%e==0&&!this.closed){var c=new Subject_1.Subject;i.push(c),r.next(c)}},e.prototype._error=function(t){var e=this.windows;if(e)for(;e.length>0&&!this.closed;)e.shift().error(t);this.destination.error(t)},e.prototype._complete=function(){var t=this.windows;if(t)for(;t.length>0&&!this.closed;)t.shift().complete();this.destination.complete()},e.prototype._unsubscribe=function(){this.count=0,this.windows=null},e}(Subscriber_1.Subscriber),windowCount_1={windowCount:windowCount_2};Observable_1.Observable.prototype.windowCount=windowCount_1.windowCount;var __extends$1T=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function windowTime(t){var e=async.async,r=null,n=Number.POSITIVE_INFINITY;return isScheduler_1.isScheduler(arguments[3])&&(e=arguments[3]),isScheduler_1.isScheduler(arguments[2])?e=arguments[2]:isNumeric_1.isNumeric(arguments[2])&&(n=arguments[2]),isScheduler_1.isScheduler(arguments[1])?e=arguments[1]:isNumeric_1.isNumeric(arguments[1])&&(r=arguments[1]),this.lift(new WindowTimeOperator(t,r,n,e))}var windowTime_2=windowTime,WindowTimeOperator=function(){function t(t,e,r,n){this.windowTimeSpan=t,this.windowCreationInterval=e,this.maxWindowSize=r,this.scheduler=n}return t.prototype.call=function(t,e){return e.subscribe(new WindowTimeSubscriber(t,this.windowTimeSpan,this.windowCreationInterval,this.maxWindowSize,this.scheduler))},t}(),CountedSubject=function(t){function e(){t.apply(this,arguments),this._numberOfNextedValues=0}return __extends$1T(e,t),e.prototype.next=function(e){this._numberOfNextedValues++,t.prototype.next.call(this,e)},Object.defineProperty(e.prototype,"numberOfNextedValues",{get:function(){return this._numberOfNextedValues},enumerable:!0,configurable:!0}),e}(Subject_1.Subject),WindowTimeSubscriber=function(t){function e(e,r,n,i,o){t.call(this,e),this.destination=e,this.windowTimeSpan=r,this.windowCreationInterval=n,this.maxWindowSize=i,this.scheduler=o,this.windows=[];var s=this.openWindow();if(null!==n&&n>=0){var a={subscriber:this,window:s,context:null},c={windowTimeSpan:r,windowCreationInterval:n,subscriber:this,scheduler:o};this.add(o.schedule(dispatchWindowClose,r,a)),this.add(o.schedule(dispatchWindowCreation,n,c))}else{var u={subscriber:this,window:s,windowTimeSpan:r};this.add(o.schedule(dispatchWindowTimeSpanOnly,r,u))}}return __extends$1T(e,t),e.prototype._next=function(t){for(var e=this.windows,r=e.length,n=0;n<r;n++){var i=e[n];i.closed||(i.next(t),i.numberOfNextedValues>=this.maxWindowSize&&this.closeWindow(i))}},e.prototype._error=function(t){for(var e=this.windows;e.length>0;)e.shift().error(t);this.destination.error(t)},e.prototype._complete=function(){for(var t=this.windows;t.length>0;){var e=t.shift();e.closed||e.complete()}this.destination.complete()},e.prototype.openWindow=function(){var t=new CountedSubject;return this.windows.push(t),this.destination.next(t),t},e.prototype.closeWindow=function(t){t.complete();var e=this.windows;e.splice(e.indexOf(t),1)},e}(Subscriber_1.Subscriber);function dispatchWindowTimeSpanOnly(t){var e=t.subscriber,r=t.windowTimeSpan,n=t.window;n&&e.closeWindow(n),t.window=e.openWindow(),this.schedule(t,r)}function dispatchWindowCreation(t){var e=t.windowTimeSpan,r=t.subscriber,n=t.scheduler,i=t.windowCreationInterval,o=r.openWindow(),s={action:this,subscription:null},a={subscriber:r,window:o,context:s};s.subscription=n.schedule(dispatchWindowClose,e,a),this.add(s.subscription),this.schedule(t,i)}function dispatchWindowClose(t){var e=t.subscriber,r=t.window,n=t.context;n&&n.action&&n.subscription&&n.action.remove(n.subscription),e.closeWindow(r)}var windowTime_1={windowTime:windowTime_2};Observable_1.Observable.prototype.windowTime=windowTime_1.windowTime;var __extends$1U=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function windowToggle(t,e){return this.lift(new WindowToggleOperator(t,e))}var windowToggle_2=windowToggle,WindowToggleOperator=function(){function t(t,e){this.openings=t,this.closingSelector=e}return t.prototype.call=function(t,e){return e.subscribe(new WindowToggleSubscriber(t,this.openings,this.closingSelector))},t}(),WindowToggleSubscriber=function(t){function e(e,r,n){t.call(this,e),this.openings=r,this.closingSelector=n,this.contexts=[],this.add(this.openSubscription=subscribeToResult_1.subscribeToResult(this,r,r))}return __extends$1U(e,t),e.prototype._next=function(t){var e=this.contexts;if(e)for(var r=e.length,n=0;n<r;n++)e[n].window.next(t)},e.prototype._error=function(e){var r=this.contexts;if(this.contexts=null,r)for(var n=r.length,i=-1;++i<n;){var o=r[i];o.window.error(e),o.subscription.unsubscribe()}t.prototype._error.call(this,e)},e.prototype._complete=function(){var e=this.contexts;if(this.contexts=null,e)for(var r=e.length,n=-1;++n<r;){var i=e[n];i.window.complete(),i.subscription.unsubscribe()}t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var t=this.contexts;if(this.contexts=null,t)for(var e=t.length,r=-1;++r<e;){var n=t[r];n.window.unsubscribe(),n.subscription.unsubscribe()}},e.prototype.notifyNext=function(t,e,r,n,i){if(t===this.openings){var o=this.closingSelector,s=tryCatch_1.tryCatch(o)(e);if(s===errorObject.errorObject)return this.error(errorObject.errorObject.e);var a=new Subject_1.Subject,c=new Subscription_1.Subscription,u={window:a,subscription:c};this.contexts.push(u);var l=subscribeToResult_1.subscribeToResult(this,s,u);l.closed?this.closeWindow(this.contexts.length-1):(l.context=u,c.add(l)),this.destination.next(a)}else this.closeWindow(this.contexts.indexOf(t))},e.prototype.notifyError=function(t){this.error(t)},e.prototype.notifyComplete=function(t){t!==this.openSubscription&&this.closeWindow(this.contexts.indexOf(t.context))},e.prototype.closeWindow=function(t){if(-1!==t){var e=this.contexts,r=e[t],n=r.window,i=r.subscription;e.splice(t,1),n.complete(),i.unsubscribe()}},e}(OuterSubscriber_1.OuterSubscriber),windowToggle_1={windowToggle:windowToggle_2};Observable_1.Observable.prototype.windowToggle=windowToggle_1.windowToggle;var __extends$1V=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function windowWhen(t){return this.lift(new WindowOperator$1(t))}var windowWhen_2=windowWhen,WindowOperator$1=function(){function t(t){this.closingSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new WindowSubscriber$1(t,this.closingSelector))},t}(),WindowSubscriber$1=function(t){function e(e,r){t.call(this,e),this.destination=e,this.closingSelector=r,this.openWindow()}return __extends$1V(e,t),e.prototype.notifyNext=function(t,e,r,n,i){this.openWindow(i)},e.prototype.notifyError=function(t,e){this._error(t)},e.prototype.notifyComplete=function(t){this.openWindow(t)},e.prototype._next=function(t){this.window.next(t)},e.prototype._error=function(t){this.window.error(t),this.destination.error(t),this.unsubscribeClosingNotification()},e.prototype._complete=function(){this.window.complete(),this.destination.complete(),this.unsubscribeClosingNotification()},e.prototype.unsubscribeClosingNotification=function(){this.closingNotification&&this.closingNotification.unsubscribe()},e.prototype.openWindow=function(t){void 0===t&&(t=null),t&&(this.remove(t),t.unsubscribe());var e=this.window;e&&e.complete();var r=this.window=new Subject_1.Subject;this.destination.next(r);var n=tryCatch_1.tryCatch(this.closingSelector)();if(n===errorObject.errorObject){var i=errorObject.errorObject.e;this.destination.error(i),this.window.error(i)}else this.add(this.closingNotification=subscribeToResult_1.subscribeToResult(this,n))},e}(OuterSubscriber_1.OuterSubscriber),windowWhen_1={windowWhen:windowWhen_2};Observable_1.Observable.prototype.windowWhen=windowWhen_1.windowWhen;var __extends$1W=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};function withLatestFrom(){for(var t,e=[],r=0;r<arguments.length;r++)e[r-0]=arguments[r];"function"==typeof e[e.length-1]&&(t=e.pop());var n=e;return this.lift(new WithLatestFromOperator(n,t))}var withLatestFrom_2=withLatestFrom,WithLatestFromOperator=function(){function t(t,e){this.observables=t,this.project=e}return t.prototype.call=function(t,e){return e.subscribe(new WithLatestFromSubscriber(t,this.observables,this.project))},t}(),WithLatestFromSubscriber=function(t){function e(e,r,n){t.call(this,e),this.observables=r,this.project=n,this.toRespond=[];var i=r.length;this.values=new Array(i);for(var o=0;o<i;o++)this.toRespond.push(o);for(o=0;o<i;o++){var s=r[o];this.add(subscribeToResult_1.subscribeToResult(this,s,s,o))}}return __extends$1W(e,t),e.prototype.notifyNext=function(t,e,r,n,i){this.values[r]=e;var o=this.toRespond;if(o.length>0){var s=o.indexOf(r);-1!==s&&o.splice(s,1)}},e.prototype.notifyComplete=function(){},e.prototype._next=function(t){if(0===this.toRespond.length){var e=[t].concat(this.values);this.project?this._tryProject(e):this.destination.next(e)}},e.prototype._tryProject=function(t){var e;try{e=this.project.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(OuterSubscriber_1.OuterSubscriber),withLatestFrom_1={withLatestFrom:withLatestFrom_2};function zipAll(t){return this.lift(new zip.ZipOperator(t))}Observable_1.Observable.prototype.withLatestFrom=withLatestFrom_1.withLatestFrom,Observable_1.Observable.prototype.zip=zip.zipProto;var zipAll_2=zipAll,zipAll_1={zipAll:zipAll_2};Observable_1.Observable.prototype.zipAll=zipAll_1.zipAll;var SubscriptionLog=function(){return function(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.subscribedFrame=t,this.unsubscribedFrame=e}}(),SubscriptionLog_2=SubscriptionLog,SubscriptionLog_1={SubscriptionLog:SubscriptionLog_2},SubscriptionLoggable=function(){function t(){this.subscriptions=[]}return t.prototype.logSubscribedFrame=function(){return this.subscriptions.push(new SubscriptionLog_1.SubscriptionLog(this.scheduler.now())),this.subscriptions.length-1},t.prototype.logUnsubscribedFrame=function(t){var e=this.subscriptions,r=e[t];e[t]=new SubscriptionLog_1.SubscriptionLog(r.subscribedFrame,this.scheduler.now())},t}(),SubscriptionLoggable_2=SubscriptionLoggable,SubscriptionLoggable_1={SubscriptionLoggable:SubscriptionLoggable_2};function applyMixins(t,e){for(var r=0,n=e.length;r<n;r++)for(var i=e[r],o=Object.getOwnPropertyNames(i.prototype),s=0,a=o.length;s<a;s++){var c=o[s];t.prototype[c]=i.prototype[c]}}var applyMixins_2=applyMixins,applyMixins_1={applyMixins:applyMixins_2},__extends$1X=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},ColdObservable=function(t){function e(e,r){t.call(this,function(t){var e=this,r=e.logSubscribedFrame();return t.add(new Subscription_1.Subscription(function(){e.logUnsubscribedFrame(r)})),e.scheduleMessages(t),t}),this.messages=e,this.subscriptions=[],this.scheduler=r}return __extends$1X(e,t),e.prototype.scheduleMessages=function(t){for(var e=this.messages.length,r=0;r<e;r++){var n=this.messages[r];t.add(this.scheduler.schedule(function(t){var e=t.message,r=t.subscriber;e.notification.observe(r)},n.frame,{message:n,subscriber:t}))}},e}(Observable_1.Observable),ColdObservable_2=ColdObservable;applyMixins_1.applyMixins(ColdObservable,[SubscriptionLoggable_1.SubscriptionLoggable]);var ColdObservable_1={ColdObservable:ColdObservable_2},__extends$1Y=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},HotObservable=function(t){function e(e,r){t.call(this),this.messages=e,this.subscriptions=[],this.scheduler=r}return __extends$1Y(e,t),e.prototype._subscribe=function(e){var r=this,n=r.logSubscribedFrame();return e.add(new Subscription_1.Subscription(function(){r.logUnsubscribedFrame(n)})),t.prototype._subscribe.call(this,e)},e.prototype.setup=function(){for(var t=this,e=t.messages.length,r=0;r<e;r++)!function(){var e=t.messages[r];t.scheduler.schedule(function(){e.notification.observe(t)},e.frame)}()},e}(Subject_1.Subject),HotObservable_2=HotObservable;applyMixins_1.applyMixins(HotObservable,[SubscriptionLoggable_1.SubscriptionLoggable]);var HotObservable_1={HotObservable:HotObservable_2},__extends$1Z=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},VirtualTimeScheduler=function(t){function e(e,r){var n=this;void 0===e&&(e=VirtualAction),void 0===r&&(r=Number.POSITIVE_INFINITY),t.call(this,e,function(){return n.frame}),this.maxFrames=r,this.frame=0,this.index=-1}return __extends$1Z(e,t),e.prototype.flush=function(){for(var t,e,r=this.actions,n=this.maxFrames;(e=r.shift())&&(this.frame=e.delay)<=n&&!(t=e.execute(e.state,e.delay)););if(t){for(;e=r.shift();)e.unsubscribe();throw t}},e.frameTimeFactor=10,e}(AsyncScheduler_1.AsyncScheduler),VirtualTimeScheduler_2=VirtualTimeScheduler,VirtualAction=function(t){function e(e,r,n){void 0===n&&(n=e.index+=1),t.call(this,e,r),this.scheduler=e,this.work=r,this.index=n,this.active=!0,this.index=e.index=n}return __extends$1Z(e,t),e.prototype.schedule=function(r,n){if(void 0===n&&(n=0),!this.id)return t.prototype.schedule.call(this,r,n);this.active=!1;var i=new e(this.scheduler,this.work);return this.add(i),i.schedule(r,n)},e.prototype.requestAsyncId=function(t,r,n){void 0===n&&(n=0),this.delay=t.frame+n;var i=t.actions;return i.push(this),i.sort(e.sortActions),!0},e.prototype.recycleAsyncId=function(t,e,r){},e.prototype._execute=function(e,r){if(!0===this.active)return t.prototype._execute.call(this,e,r)},e.sortActions=function(t,e){return t.delay===e.delay?t.index===e.index?0:t.index>e.index?1:-1:t.delay>e.delay?1:-1},e}(AsyncAction_1.AsyncAction),VirtualAction_1=VirtualAction,VirtualTimeScheduler_1={VirtualTimeScheduler:VirtualTimeScheduler_2,VirtualAction:VirtualAction_1},__extends$1_=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},defaultMaxFrame=750,TestScheduler=function(t){function e(e){t.call(this,VirtualTimeScheduler_1.VirtualAction,defaultMaxFrame),this.assertDeepEqual=e,this.hotObservables=[],this.coldObservables=[],this.flushTests=[]}return __extends$1_(e,t),e.prototype.createTime=function(t){var r=t.indexOf("|");if(-1===r)throw new Error('marble diagram for time should have a completion marker "|"');return r*e.frameTimeFactor},e.prototype.createColdObservable=function(t,r,n){if(-1!==t.indexOf("^"))throw new Error('cold observable cannot have subscription offset "^"');if(-1!==t.indexOf("!"))throw new Error('cold observable cannot have unsubscription marker "!"');var i=e.parseMarbles(t,r,n),o=new ColdObservable_1.ColdObservable(i,this);return this.coldObservables.push(o),o},e.prototype.createHotObservable=function(t,r,n){if(-1!==t.indexOf("!"))throw new Error('hot observable cannot have unsubscription marker "!"');var i=e.parseMarbles(t,r,n),o=new HotObservable_1.HotObservable(i,this);return this.hotObservables.push(o),o},e.prototype.materializeInnerObservable=function(t,e){var r=this,n=[];return t.subscribe(function(t){n.push({frame:r.frame-e,notification:Notification_1.Notification.createNext(t)})},function(t){n.push({frame:r.frame-e,notification:Notification_1.Notification.createError(t)})},function(){n.push({frame:r.frame-e,notification:Notification_1.Notification.createComplete()})}),n},e.prototype.expectObservable=function(t,r){var n=this;void 0===r&&(r=null);var i,o=[],s={actual:o,ready:!1},a=e.parseMarblesAsSubscriptions(r).unsubscribedFrame;return this.schedule(function(){i=t.subscribe(function(t){var e=t;t instanceof Observable_1.Observable&&(e=n.materializeInnerObservable(e,n.frame)),o.push({frame:n.frame,notification:Notification_1.Notification.createNext(e)})},function(t){o.push({frame:n.frame,notification:Notification_1.Notification.createError(t)})},function(){o.push({frame:n.frame,notification:Notification_1.Notification.createComplete()})})},0),a!==Number.POSITIVE_INFINITY&&this.schedule(function(){return i.unsubscribe()},a),this.flushTests.push(s),{toBe:function(t,r,n){s.ready=!0,s.expected=e.parseMarbles(t,r,n,!0)}}},e.prototype.expectSubscriptions=function(t){var r={actual:t,ready:!1};return this.flushTests.push(r),{toBe:function(t){var n="string"==typeof t?[t]:t;r.ready=!0,r.expected=n.map(function(t){return e.parseMarblesAsSubscriptions(t)})}}},e.prototype.flush=function(){for(var e=this.hotObservables;e.length>0;)e.shift().setup();t.prototype.flush.call(this);for(var r=this.flushTests.filter(function(t){return t.ready});r.length>0;){var n=r.shift();this.assertDeepEqual(n.actual,n.expected)}},e.parseMarblesAsSubscriptions=function(t){if("string"!=typeof t)return new SubscriptionLog_1.SubscriptionLog(Number.POSITIVE_INFINITY);for(var e=t.length,r=-1,n=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,o=0;o<e;o++){var s=o*this.frameTimeFactor,a=t[o];switch(a){case"-":case" ":break;case"(":r=s;break;case")":r=-1;break;case"^":if(n!==Number.POSITIVE_INFINITY)throw new Error("found a second subscription point '^' in a subscription marble diagram. There can only be one.");n=r>-1?r:s;break;case"!":if(i!==Number.POSITIVE_INFINITY)throw new Error("found a second subscription point '^' in a subscription marble diagram. There can only be one.");i=r>-1?r:s;break;default:throw new Error("there can only be '^' and '!' markers in a subscription marble diagram. Found instead '"+a+"'.")}}return i<0?new SubscriptionLog_1.SubscriptionLog(n):new SubscriptionLog_1.SubscriptionLog(n,i)},e.parseMarbles=function(t,e,r,n){if(void 0===n&&(n=!1),-1!==t.indexOf("!"))throw new Error('conventional marble diagrams cannot have the unsubscription marker "!"');for(var i=t.length,o=[],s=t.indexOf("^"),a=-1===s?0:s*-this.frameTimeFactor,c="object"!=typeof e?function(t){return t}:function(t){return n&&e[t]instanceof ColdObservable_1.ColdObservable?e[t].messages:e[t]},u=-1,l=0;l<i;l++){var h=l*this.frameTimeFactor+a,p=void 0,f=t[l];switch(f){case"-":case" ":break;case"(":u=h;break;case")":u=-1;break;case"|":p=Notification_1.Notification.createComplete();break;case"^":break;case"#":p=Notification_1.Notification.createError(r||"error");break;default:p=Notification_1.Notification.createNext(c(f))}p&&o.push({frame:u>-1?u:h,notification:p})}return o},e}(VirtualTimeScheduler_1.VirtualTimeScheduler),RequestAnimationFrameDefinition=function(){return function(t){t.requestAnimationFrame?(this.cancelAnimationFrame=t.cancelAnimationFrame.bind(t),this.requestAnimationFrame=t.requestAnimationFrame.bind(t)):t.mozRequestAnimationFrame?(this.cancelAnimationFrame=t.mozCancelAnimationFrame.bind(t),this.requestAnimationFrame=t.mozRequestAnimationFrame.bind(t)):t.webkitRequestAnimationFrame?(this.cancelAnimationFrame=t.webkitCancelAnimationFrame.bind(t),this.requestAnimationFrame=t.webkitRequestAnimationFrame.bind(t)):t.msRequestAnimationFrame?(this.cancelAnimationFrame=t.msCancelAnimationFrame.bind(t),this.requestAnimationFrame=t.msRequestAnimationFrame.bind(t)):t.oRequestAnimationFrame?(this.cancelAnimationFrame=t.oCancelAnimationFrame.bind(t),this.requestAnimationFrame=t.oRequestAnimationFrame.bind(t)):(this.cancelAnimationFrame=t.clearTimeout.bind(t),this.requestAnimationFrame=function(e){return t.setTimeout(e,1e3/60)})}}(),RequestAnimationFrameDefinition_1=RequestAnimationFrameDefinition,AnimationFrame_1=new RequestAnimationFrameDefinition(root.root),AnimationFrame={RequestAnimationFrameDefinition:RequestAnimationFrameDefinition_1,AnimationFrame:AnimationFrame_1},__extends$1$=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},AnimationFrameAction=function(t){function e(e,r){t.call(this,e,r),this.scheduler=e,this.work=r}return __extends$1$(e,t),e.prototype.requestAsyncId=function(e,r,n){return void 0===n&&(n=0),null!==n&&n>0?t.prototype.requestAsyncId.call(this,e,r,n):(e.actions.push(this),e.scheduled||(e.scheduled=AnimationFrame.AnimationFrame.requestAnimationFrame(e.flush.bind(e,null))))},e.prototype.recycleAsyncId=function(e,r,n){if(void 0===n&&(n=0),null!==n&&n>0||null===n&&this.delay>0)return t.prototype.recycleAsyncId.call(this,e,r,n);0===e.actions.length&&(AnimationFrame.AnimationFrame.cancelAnimationFrame(r),e.scheduled=void 0)},e}(AsyncAction_1.AsyncAction),AnimationFrameAction_2=AnimationFrameAction,AnimationFrameAction_1={AnimationFrameAction:AnimationFrameAction_2},__extends$20=commonjsGlobal&&commonjsGlobal.__extends||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);function n(){this.constructor=t}t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},AnimationFrameScheduler=function(t){function e(){t.apply(this,arguments)}return __extends$20(e,t),e.prototype.flush=function(t){this.active=!0,this.scheduled=void 0;var e,r=this.actions,n=-1,i=r.length;t=t||r.shift();do{if(e=t.execute(t.state,t.delay))break}while(++n<i&&(t=r.shift()));if(this.active=!1,e){for(;++n<i&&(t=r.shift());)t.unsubscribe();throw e}},e}(AsyncScheduler_1.AsyncScheduler),AnimationFrameScheduler_2=AnimationFrameScheduler,AnimationFrameScheduler_1={AnimationFrameScheduler:AnimationFrameScheduler_2},animationFrame_1=new AnimationFrameScheduler_1.AnimationFrameScheduler(AnimationFrameAction_1.AnimationFrameAction),Subject$1=Subject_1.Subject,Observable$1=Observable_1.Observable,BehaviorSubject$1=BehaviorSubject_1.BehaviorSubject,Symbol$1={rxSubscriber:rxSubscriber.rxSubscriber,observable:observable.observable,iterator:iterator.iterator},dequeue=createCommonjsModule(function(t,e){var r=t.exports=function(){this.head=new n,this.length=0};function n(t){this.data=t,this.next=this,this.prev=this}r.prototype.push=function(t){var e=new n(t);return this.head.prepend(e),this.length+=1,this},r.prototype.unshift=function(t){var e=new n(t);return this.head.append(e),this.length+=1,this},r.prototype.pop=function(){if(this.head.prev!==this.head){var t=this.head.prev.remove();return this.length-=1,t.data}},r.prototype.shift=function(){if(this.head.next!==this.head){var t=this.head.next.remove();return this.length-=1,t.data}},r.prototype.last=function(){if(this.head.prev!==this.head)return this.head.prev.data},r.prototype.first=function(){if(this.head.next!==this.head)return this.head.next.data},r.prototype.empty=function(){0!==this.length&&(this.head.next.prev=null,this.head.prev.next=null,this.head.next=this.head,this.head.prev=this.head,this.length=0)},n.prototype.append=function(t){return t.next=this.next,t.prev=this,this.next.prev=t,this.next=t,t},n.prototype.prepend=function(t){return t.prev=this.prev,t.next=this,this.prev.next=t,this.prev=t,t},n.prototype.remove=function(){return this.next.prev=this.prev,this.prev.next=this.next,this}}),lib=createCommonjsModule(function(t,e){t.exports=dequeue});class PromisePool{constructor(t){_defineProperty(this,"_fifo",void 0),_defineProperty(this,"_emitter",void 0),_defineProperty(this,"_numPromisesRunning",void 0),_defineProperty(this,"_poolSize",void 0),_defineProperty(this,"_nextRequestId",void 0),this._fifo=new lib,this._emitter=new EventEmitter,this._numPromisesRunning=0,this._poolSize=t,this._nextRequestId=1}submit(t){const e=this._getNextRequestId();this._fifo.push({id:e,executor:t});const r=new Promise((t,r)=>{this._emitter.once(e,e=>{const{isSuccess:n,value:i}=e;(n?t:r)(i)})});return this._run(),r}_run(){if(this._numPromisesRunning===this._poolSize)return;if(0===this._fifo.length)return;const{id:t,executor:e}=this._fifo.shift();this._numPromisesRunning++,new Promise(e).then(e=>{this._emitter.emit(t,{isSuccess:!0,value:e}),this._numPromisesRunning--,this._run()},e=>{this._emitter.emit(t,{isSuccess:!1,value:e}),this._numPromisesRunning--,this._run()})}_getNextRequestId(){return(this._nextRequestId++).toString(16)}}class PromiseQueue{constructor(){_defineProperty(this,"_promisePool",void 0),this._promisePool=new PromisePool(1)}submit(t){return this._promisePool.submit(t)}}for(var TOKEN="",i=0;i<4;i++)TOKEN+=(Math.pow(16,8)*Math.random()).toString(16);let platformPathPromise;const blockingQueues={},COMMON_BINARY_PATHS=["/usr/bin","/bin","/usr/sbin","/sbin","/usr/local/bin"],DARWIN_PATH_HELPER_REGEXP=/PATH="([^"]+)"/,STREAM_NAMES=["stdin","stdout","stderr"];function getPlatformPath(){return platformPathPromise&&"test"!==process.env.NODE_ENV?platformPathPromise:platformPathPromise="darwin"===process.platform?new Promise((t,e)=>{child_process.execFile("/usr/libexec/path_helper",["-s"],(r,n,i)=>{if(r)e(r);else{const e=n.toString().match(DARWIN_PATH_HELPER_REGEXP);t(e&&e.length>1?e[1]:"")}})}):Promise.resolve("")}async function createExecEnvironment(t,e){const r={...t};if(r.PATH!==process.env.PATH)return r;r.PATH=r.PATH||"";let n=null;try{n=await getPlatformPath()}catch(t){logError("Failed to getPlatformPath",t)}if(n)r.PATH=n;else if(e.length){const t=nuclideUri.splitPathList(r.PATH);e.forEach(e=>{-1===t.indexOf(e)&&t.push(e)}),r.PATH=nuclideUri.joinPathList(t)}return r}function logError(...t){console.error(...t)}function monitorStreamErrors(t,e,r,n){STREAM_NAMES.forEach(i=>{const o=t[i];null!=o&&o.on("error",t=>{logError(`stream error on stream ${i} with command:`,e,r,n,"error:",t)})})}async function safeSpawn(t,e=[],r={}){r.env=await createExecEnvironment(r.env||process.env,COMMON_BINARY_PATHS);const n=crossSpawn(t,e,r);return monitorStreamErrors(n,t,e,r),n.on("error",n=>{logError("error with command:",t,e,r,"error:",n)}),n}function asyncExecute(t,e,r={}){const n={...r},i=(r,i)=>{let o,s,a;n.pipedCommand?(monitorStreamErrors(o=crossSpawn(t,e,n),t,e,n),a="",o.on("error",n=>{r({command:[t].concat(e).join(" "),errorMessage:n.message,errorCode:n.code,stderr:a,stdout:""})}),null!=o.stderr&&o.stderr.on("data",t=>{a+=t}),monitorStreamErrors(s=crossSpawn(n.pipedCommand,n.pipedArgs,n),t,e,n),null!=s.stdin&&null!=o.stdout&&(s.stdin.on("error",()=>{o.stdout.emit("end")}),o.stdout.pipe(s.stdin))):(monitorStreamErrors(s=crossSpawn(t,e,n),t,e,n),o=s);let c="",u="",l=null;null!=n.timeout&&(l=setTimeout(()=>{s.removeAllListeners(),s.kill(),r({command:[t].concat(e).join(" "),errorMessage:`Exceeded timeout of ${n.timeout}ms`,errorCode:"ETIMEDOUT",stderr:c,stdout:u})},n.timeout)),s.on("close",t=>{r({exitCode:t,stderr:c,stdout:u}),null!=l&&clearTimeout(l)}),s.on("error",n=>{r({command:[t].concat(e).join(" "),errorMessage:n.message,errorCode:n.code,stderr:c,stdout:u}),null!=l&&clearTimeout(l)}),null!=s.stderr&&s.stderr.on("data",t=>{c+=t}),null!=s.stdout&&s.stdout.on("data",t=>{u+=t}),"string"==typeof n.stdin&&null!=o.stdin&&(o.stdin.write(n.stdin),o.stdin.end())};function o(){return void 0===n.queueName?new Promise(i):(blockingQueues[n.queueName]||(blockingQueues[n.queueName]=new PromiseQueue),blockingQueues[n.queueName].submit(i))}return createExecEnvironment(n.env||process.env,COMMON_BINARY_PATHS).then(t=>(n.env=t,o()),t=>(n.env=n.env||process.env,o()))}async function checkOutput(t,e,r={}){const n=await asyncExecute(t,e,r);if(0!==n.exitCode){const e=null!=n.exitCode?`exitCode: ${n.exitCode}`:`error: ${String(n.errorMessage)}`;throw new Error(`asyncExecute "${t}" failed with ${e}, `+`stderr: ${String(n.stderr)}, stdout: ${String(n.stdout)}.`)}return n}var underscore=createCommonjsModule(function(t,e){(function(){var r=this,n=r._,i={},o=Array.prototype,s=Object.prototype,a=Function.prototype,c=o.push,u=o.slice,l=o.concat,h=s.toString,p=s.hasOwnProperty,f=o.forEach,b=o.map,d=o.reduce,m=o.reduceRight,v=o.filter,y=o.every,_=o.some,g=o.indexOf,w=o.lastIndexOf,S=Array.isArray,O=Object.keys,x=a.bind,j=function(t){return t instanceof j?t:this instanceof j?void(this._wrapped=t):new j(t)};t.exports&&(e=t.exports=j),e._=j,j.VERSION="1.6.0";var E=j.each=j.forEach=function(t,e,r){if(null==t)return t;if(f&&t.forEach===f)t.forEach(e,r);else if(t.length===+t.length){for(var n=0,o=t.length;n<o;n++)if(e.call(r,t[n],n,t)===i)return}else{var s=j.keys(t);for(n=0,o=s.length;n<o;n++)if(e.call(r,t[s[n]],s[n],t)===i)return}return t};j.map=j.collect=function(t,e,r){var n=[];return null==t?n:b&&t.map===b?t.map(e,r):(E(t,function(t,i,o){n.push(e.call(r,t,i,o))}),n)};var T="Reduce of empty array with no initial value";j.reduce=j.foldl=j.inject=function(t,e,r,n){var i=arguments.length>2;if(null==t&&(t=[]),d&&t.reduce===d)return n&&(e=j.bind(e,n)),i?t.reduce(e,r):t.reduce(e);if(E(t,function(t,o,s){i?r=e.call(n,r,t,o,s):(r=t,i=!0)}),!i)throw new TypeError(T);return r},j.reduceRight=j.foldr=function(t,e,r,n){var i=arguments.length>2;if(null==t&&(t=[]),m&&t.reduceRight===m)return n&&(e=j.bind(e,n)),i?t.reduceRight(e,r):t.reduceRight(e);var o=t.length;if(o!==+o){var s=j.keys(t);o=s.length}if(E(t,function(a,c,u){c=s?s[--o]:--o,i?r=e.call(n,r,t[c],c,u):(r=t[c],i=!0)}),!i)throw new TypeError(T);return r},j.find=j.detect=function(t,e,r){var n;return A(t,function(t,i,o){if(e.call(r,t,i,o))return n=t,!0}),n},j.filter=j.select=function(t,e,r){var n=[];return null==t?n:v&&t.filter===v?t.filter(e,r):(E(t,function(t,i,o){e.call(r,t,i,o)&&n.push(t)}),n)},j.reject=function(t,e,r){return j.filter(t,function(t,n,i){return!e.call(r,t,n,i)},r)},j.every=j.all=function(t,e,r){e||(e=j.identity);var n=!0;return null==t?n:y&&t.every===y?t.every(e,r):(E(t,function(t,o,s){if(!(n=n&&e.call(r,t,o,s)))return i}),!!n)};var A=j.some=j.any=function(t,e,r){e||(e=j.identity);var n=!1;return null==t?n:_&&t.some===_?t.some(e,r):(E(t,function(t,o,s){if(n||(n=e.call(r,t,o,s)))return i}),!!n)};j.contains=j.include=function(t,e){return null!=t&&(g&&t.indexOf===g?-1!=t.indexOf(e):A(t,function(t){return t===e}))},j.invoke=function(t,e){var r=u.call(arguments,2),n=j.isFunction(e);return j.map(t,function(t){return(n?e:t[e]).apply(t,r)})},j.pluck=function(t,e){return j.map(t,j.property(e))},j.where=function(t,e){return j.filter(t,j.matches(e))},j.findWhere=function(t,e){return j.find(t,j.matches(e))},j.max=function(t,e,r){if(!e&&j.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);var n=-1/0,i=-1/0;return E(t,function(t,o,s){var a=e?e.call(r,t,o,s):t;a>i&&(n=t,i=a)}),n},j.min=function(t,e,r){if(!e&&j.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);var n=1/0,i=1/0;return E(t,function(t,o,s){var a=e?e.call(r,t,o,s):t;a<i&&(n=t,i=a)}),n},j.shuffle=function(t){var e,r=0,n=[];return E(t,function(t){e=j.random(r++),n[r-1]=n[e],n[e]=t}),n},j.sample=function(t,e,r){return null==e||r?(t.length!==+t.length&&(t=j.values(t)),t[j.random(t.length-1)]):j.shuffle(t).slice(0,Math.max(0,e))};var C=function(t){return null==t?j.identity:j.isFunction(t)?t:j.property(t)};j.sortBy=function(t,e,r){return e=C(e),j.pluck(j.map(t,function(t,n,i){return{value:t,index:n,criteria:e.call(r,t,n,i)}}).sort(function(t,e){var r=t.criteria,n=e.criteria;if(r!==n){if(r>n||void 0===r)return 1;if(r<n||void 0===n)return-1}return t.index-e.index}),"value")};var k=function(t){return function(e,r,n){var i={};return r=C(r),E(e,function(o,s){var a=r.call(n,o,s,e);t(i,a,o)}),i}};j.groupBy=k(function(t,e,r){j.has(t,e)?t[e].push(r):t[e]=[r]}),j.indexBy=k(function(t,e,r){t[e]=r}),j.countBy=k(function(t,e){j.has(t,e)?t[e]++:t[e]=1}),j.sortedIndex=function(t,e,r,n){for(var i=(r=C(r)).call(n,e),o=0,s=t.length;o<s;){var a=o+s>>>1;r.call(n,t[a])<i?o=a+1:s=a}return o},j.toArray=function(t){return t?j.isArray(t)?u.call(t):t.length===+t.length?j.map(t,j.identity):j.values(t):[]},j.size=function(t){return null==t?0:t.length===+t.length?t.length:j.keys(t).length},j.first=j.head=j.take=function(t,e,r){if(null!=t)return null==e||r?t[0]:e<0?[]:u.call(t,0,e)},j.initial=function(t,e,r){return u.call(t,0,t.length-(null==e||r?1:e))},j.last=function(t,e,r){if(null!=t)return null==e||r?t[t.length-1]:u.call(t,Math.max(t.length-e,0))},j.rest=j.tail=j.drop=function(t,e,r){return u.call(t,null==e||r?1:e)},j.compact=function(t){return j.filter(t,j.identity)};var P=function(t,e,r){return e&&j.every(t,j.isArray)?l.apply(r,t):(E(t,function(t){j.isArray(t)||j.isArguments(t)?e?c.apply(r,t):P(t,e,r):r.push(t)}),r)};j.flatten=function(t,e){return P(t,e,[])},j.without=function(t){return j.difference(t,u.call(arguments,1))},j.partition=function(t,e){var r=[],n=[];return E(t,function(t){(e(t)?r:n).push(t)}),[r,n]},j.uniq=j.unique=function(t,e,r,n){j.isFunction(e)&&(n=r,r=e,e=!1);var i=r?j.map(t,r,n):t,o=[],s=[];return E(i,function(r,n){(e?n&&s[s.length-1]===r:j.contains(s,r))||(s.push(r),o.push(t[n]))}),o},j.union=function(){return j.uniq(j.flatten(arguments,!0))},j.intersection=function(t){var e=u.call(arguments,1);return j.filter(j.uniq(t),function(t){return j.every(e,function(e){return j.contains(e,t)})})},j.difference=function(t){var e=l.apply(o,u.call(arguments,1));return j.filter(t,function(t){return!j.contains(e,t)})},j.zip=function(){for(var t=j.max(j.pluck(arguments,"length").concat(0)),e=new Array(t),r=0;r<t;r++)e[r]=j.pluck(arguments,""+r);return e},j.object=function(t,e){if(null==t)return{};for(var r={},n=0,i=t.length;n<i;n++)e?r[t[n]]=e[n]:r[t[n][0]]=t[n][1];return r},j.indexOf=function(t,e,r){if(null==t)return-1;var n=0,i=t.length;if(r){if("number"!=typeof r)return t[n=j.sortedIndex(t,e)]===e?n:-1;n=r<0?Math.max(0,i+r):r}if(g&&t.indexOf===g)return t.indexOf(e,r);for(;n<i;n++)if(t[n]===e)return n;return-1},j.lastIndexOf=function(t,e,r){if(null==t)return-1;var n=null!=r;if(w&&t.lastIndexOf===w)return n?t.lastIndexOf(e,r):t.lastIndexOf(e);for(var i=n?r:t.length;i--;)if(t[i]===e)return i;return-1},j.range=function(t,e,r){arguments.length<=1&&(e=t||0,t=0),r=arguments[2]||1;for(var n=Math.max(Math.ceil((e-t)/r),0),i=0,o=new Array(n);i<n;)o[i++]=t,t+=r;return o};var R=function(){};j.bind=function(t,e){var r,n;if(x&&t.bind===x)return x.apply(t,u.call(arguments,1));if(!j.isFunction(t))throw new TypeError;return r=u.call(arguments,2),n=function(){if(!(this instanceof n))return t.apply(e,r.concat(u.call(arguments)));R.prototype=t.prototype;var i=new R;R.prototype=null;var o=t.apply(i,r.concat(u.call(arguments)));return Object(o)===o?o:i}},j.partial=function(t){var e=u.call(arguments,1);return function(){for(var r=0,n=e.slice(),i=0,o=n.length;i<o;i++)n[i]===j&&(n[i]=arguments[r++]);for(;r<arguments.length;)n.push(arguments[r++]);return t.apply(this,n)}},j.bindAll=function(t){var e=u.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return E(e,function(e){t[e]=j.bind(t[e],t)}),t},j.memoize=function(t,e){var r={};return e||(e=j.identity),function(){var n=e.apply(this,arguments);return j.has(r,n)?r[n]:r[n]=t.apply(this,arguments)}},j.delay=function(t,e){var r=u.call(arguments,2);return setTimeout(function(){return t.apply(null,r)},e)},j.defer=function(t){return j.delay.apply(j,[t,1].concat(u.call(arguments,1)))},j.throttle=function(t,e,r){var n,i,o,s=null,a=0;r||(r={});var c=function(){a=!1===r.leading?0:j.now(),s=null,o=t.apply(n,i),n=i=null};return function(){var u=j.now();a||!1!==r.leading||(a=u);var l=e-(u-a);return n=this,i=arguments,l<=0?(clearTimeout(s),s=null,a=u,o=t.apply(n,i),n=i=null):s||!1===r.trailing||(s=setTimeout(c,l)),o}},j.debounce=function(t,e,r){var n,i,o,s,a,c=function(){var u=j.now()-s;u<e?n=setTimeout(c,e-u):(n=null,r||(a=t.apply(o,i),o=i=null))};return function(){o=this,i=arguments,s=j.now();var u=r&&!n;return n||(n=setTimeout(c,e)),u&&(a=t.apply(o,i),o=i=null),a}},j.once=function(t){var e,r=!1;return function(){return r?e:(r=!0,e=t.apply(this,arguments),t=null,e)}},j.wrap=function(t,e){return j.partial(e,t)},j.compose=function(){var t=arguments;return function(){for(var e=arguments,r=t.length-1;r>=0;r--)e=[t[r].apply(this,e)];return e[0]}},j.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},j.keys=function(t){if(!j.isObject(t))return[];if(O)return O(t);var e=[];for(var r in t)j.has(t,r)&&e.push(r);return e},j.values=function(t){for(var e=j.keys(t),r=e.length,n=new Array(r),i=0;i<r;i++)n[i]=t[e[i]];return n},j.pairs=function(t){for(var e=j.keys(t),r=e.length,n=new Array(r),i=0;i<r;i++)n[i]=[e[i],t[e[i]]];return n},j.invert=function(t){for(var e={},r=j.keys(t),n=0,i=r.length;n<i;n++)e[t[r[n]]]=r[n];return e},j.functions=j.methods=function(t){var e=[];for(var r in t)j.isFunction(t[r])&&e.push(r);return e.sort()},j.extend=function(t){return E(u.call(arguments,1),function(e){if(e)for(var r in e)t[r]=e[r]}),t},j.pick=function(t){var e={},r=l.apply(o,u.call(arguments,1));return E(r,function(r){r in t&&(e[r]=t[r])}),e},j.omit=function(t){var e={},r=l.apply(o,u.call(arguments,1));for(var n in t)j.contains(r,n)||(e[n]=t[n]);return e},j.defaults=function(t){return E(u.call(arguments,1),function(e){if(e)for(var r in e)void 0===t[r]&&(t[r]=e[r])}),t},j.clone=function(t){return j.isObject(t)?j.isArray(t)?t.slice():j.extend({},t):t},j.tap=function(t,e){return e(t),t};var $=function(t,e,r,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof j&&(t=t._wrapped),e instanceof j&&(e=e._wrapped);var i=h.call(t);if(i!=h.call(e))return!1;switch(i){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var o=r.length;o--;)if(r[o]==t)return n[o]==e;var s=t.constructor,a=e.constructor;if(s!==a&&!(j.isFunction(s)&&s instanceof s&&j.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1;r.push(t),n.push(e);var c=0,u=!0;if("[object Array]"==i){if(u=(c=t.length)==e.length)for(;c--&&(u=$(t[c],e[c],r,n)););}else{for(var l in t)if(j.has(t,l)&&(c++,!(u=j.has(e,l)&&$(t[l],e[l],r,n))))break;if(u){for(l in e)if(j.has(e,l)&&!c--)break;u=!c}}return r.pop(),n.pop(),u};j.isEqual=function(t,e){return $(t,e,[],[])},j.isEmpty=function(t){if(null==t)return!0;if(j.isArray(t)||j.isString(t))return 0===t.length;for(var e in t)if(j.has(t,e))return!1;return!0},j.isElement=function(t){return!(!t||1!==t.nodeType)},j.isArray=S||function(t){return"[object Array]"==h.call(t)},j.isObject=function(t){return t===Object(t)},E(["Arguments","Function","String","Number","Date","RegExp"],function(t){j["is"+t]=function(e){return h.call(e)=="[object "+t+"]"}}),j.isArguments(arguments)||(j.isArguments=function(t){return!(!t||!j.has(t,"callee"))}),j.isFunction=function(t){return"function"==typeof t},j.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},j.isNaN=function(t){return j.isNumber(t)&&t!=+t},j.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"==h.call(t)},j.isNull=function(t){return null===t},j.isUndefined=function(t){return void 0===t},j.has=function(t,e){return p.call(t,e)},j.noConflict=function(){return r._=n,this},j.identity=function(t){return t},j.constant=function(t){return function(){return t}},j.property=function(t){return function(e){return e[t]}},j.matches=function(t){return function(e){if(e===t)return!0;for(var r in t)if(t[r]!==e[r])return!1;return!0}},j.times=function(t,e,r){for(var n=Array(Math.max(0,t)),i=0;i<t;i++)n[i]=e.call(r,i);return n},j.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},j.now=Date.now||function(){return(new Date).getTime()};var N={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};N.unescape=j.invert(N.escape);var I={escape:new RegExp("["+j.keys(N.escape).join("")+"]","g"),unescape:new RegExp("("+j.keys(N.unescape).join("|")+")","g")};j.each(["escape","unescape"],function(t){j[t]=function(e){return null==e?"":(""+e).replace(I[t],function(e){return N[t][e]})}}),j.result=function(t,e){if(null!=t){var r=t[e];return j.isFunction(r)?r.call(t):r}},j.mixin=function(t){E(j.functions(t),function(e){var r=j[e]=t[e];j.prototype[e]=function(){var t=[this._wrapped];return c.apply(t,arguments),D.call(this,r.apply(j,t))}})};var F=0;j.uniqueId=function(t){var e=++F+"";return t?t+e:e},j.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var M=/(.)^/,G={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\t|\u2028|\u2029/g;j.template=function(t,e,r){var n;r=j.defaults({},r,j.templateSettings);var i=new RegExp([(r.escape||M).source,(r.interpolate||M).source,(r.evaluate||M).source].join("|")+"|$","g"),o=0,s="__p+='";t.replace(i,function(e,r,n,i,a){return s+=t.slice(o,a).replace(L,function(t){return"\\"+G[t]}),r&&(s+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'"),n&&(s+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),i&&(s+="';\n"+i+"\n__p+='"),o=a+e.length,e}),s+="';\n",r.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{n=new Function(r.variable||"obj","_",s)}catch(t){throw t.source=s,t}if(e)return n(e,j);var a=function(t){return n.call(this,t,j)};return a.source="function("+(r.variable||"obj")+"){\n"+s+"}",a},j.chain=function(t){return j(t).chain()};var D=function(t){return this._chain?j(t).chain():t};j.mixin(j),E(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=o[t];j.prototype[t]=function(){var r=this._wrapped;return e.apply(r,arguments),"shift"!=t&&"splice"!=t||0!==r.length||delete r[0],D.call(this,r)}}),E(["concat","join","slice"],function(t){var e=o[t];j.prototype[t]=function(){return D.call(this,e.apply(this._wrapped,arguments))}}),j.extend(j.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(commonjsGlobal)}),underscore_1=underscore._,underscorePlus=createCommonjsModule(function(t){(function(){var e,r,n,i,o,s,a,c,u=[].slice;c=underscore,n={cmd:"",ctrl:"",alt:"",option:"",shift:"",enter:"",left:"",right:"",up:"",down:""},i={cmd:"Cmd",ctrl:"Ctrl",alt:"Alt",option:"Alt",shift:"Shift",enter:"Enter",left:"Left",right:"Right",up:"Up",down:"Down"},s={"~":"`",_:"-","+":"=","|":"\\","{":"[","}":"]",":":";",'"':"'","<":",",">":".","?":"/"},a=function(t){var e,r,n,i,o;if(n=0,r=[],null==t)return r;for(e=i=0,o=t.length;i<o;e=++i)"."!==t[e]||0!==e&&"\\"===t[e-1]||(r.push(t.substring(n,e)),n=e+1);return r.push(t.substr(n,t.length)),r},r=function(t){return c.isObject(t)&&!c.isArray(t)},o={adviseBefore:function(t,e,r){var n;return n=t[e],t[e]=function(){var t;if(t=1<=arguments.length?u.call(arguments,0):[],!1!==r.apply(this,t))return n.apply(this,t)}},camelize:function(t){return t?t.replace(/[_-]+(\w)/g,function(t){return t[1].toUpperCase()}):""},capitalize:function(t){return t?"github"===t.toLowerCase()?"GitHub":t[0].toUpperCase()+t.slice(1):""},compactObject:function(t){var e,r,n;for(e in r={},t)null!=(n=t[e])&&(r[e]=n);return r},dasherize:function(t){return t?(t=t[0].toLowerCase()+t.slice(1)).replace(/([A-Z])|(_)/g,function(t,e){return e?"-"+e.toLowerCase():"-"}):""},deepClone:function(t){return c.isArray(t)?t.map(function(t){return o.deepClone(t)}):c.isObject(t)&&!c.isFunction(t)?o.mapObject(t,function(t,e){return[t,o.deepClone(e)]}):t},deepExtend:function(t){var e,n,i,s,a,c,u;for(s=t,e=0;++e<arguments.length;)if(i=arguments[e],r(s)&&r(i))for(a=0,c=(u=Object.keys(i)).length;a<c;a++)s[n=u[a]]=o.deepExtend(s[n],i[n]);else s=o.deepClone(i);return s},deepContains:function(t,e){var r,n,i;if(null==t)return!1;for(n=0,i=t.length;n<i;n++)if(r=t[n],c.isEqual(r,e))return!0;return!1},endsWith:function(t,e){return null==e&&(e=""),!!t&&-1!==t.indexOf(e,t.length-e.length)},escapeAttribute:function(t){return t?t.replace(/"/g,"&quot;").replace(/\n/g,"").replace(/\\/g,"-"):""},escapeRegExp:function(t){return t?t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"):""},humanizeEventName:function(t,e){var r,n,i,s;return n=(s=t.split(":"))[0],null==(r=s[1])?o.undasherize(n):(i=o.undasherize(n),null==e&&(e=o.undasherize(r)),i+": "+e)},humanizeKey:function(t,e){var r;return null==e&&(e=process.platform),t?(r="darwin"===e?n:i)[t]?r[t]:1===t.length&&null!=s[t]?[r.shift,s[t]]:1===t.length&&t===t.toUpperCase()&&t.toUpperCase()!==t.toLowerCase()?[r.shift,t.toUpperCase()]:1===t.length||/f[0-9]{1,2}/.test(t)?t.toUpperCase():"darwin"===e?t:o.capitalize(t):t},humanizeKeystroke:function(t,e){var r,n,i,s,a,u,l,h,p,f;if(null==e&&(e=process.platform),!t)return t;for(r=[],l=0,p=(a=t.split(" ")).length;l<p;l++){for(s=[],n=h=0,f=(u=(t=a[l]).split("-")).length;h<f;n=++h)""===(i=u[n])&&""===u[n-1]&&(i="-"),i&&s.push(o.humanizeKey(i,e));s=c.uniq(c.flatten(s)),s="darwin"===e?s.join(""):s.join("+"),r.push(s)}return r.join(" ")},isSubset:function(t,e){return c.every(t,function(t){return c.include(e,t)})},losslessInvert:function(t){var e,r,n;for(r in e={},t)null==e[n=t[r]]&&(e[n]=[]),e[n].push(r);return e},mapObject:function(t,e){var r,n,i,o,s,a,c;for(n={},o=0,s=(a=Object.keys(t)).length;o<s;o++)r=(c=e(r=a[o],t[r]))[0],i=c[1],n[r]=i;return n},multiplyString:function(t,e){var r,n;for(r="",n=0;n<e;)r+=t,n++;return r},pluralize:function(t,e,r){return null==t&&(t=0),null==r&&(r=e+"s"),1===t?t+" "+e:t+" "+r},remove:function(t,e){var r;return(r=t.indexOf(e))>=0&&t.splice(r,1),t},setValueForKeyPath:function(t,e,r){var n,i;for(i=a(e);i.length>1;)null==t[n=i.shift()]&&(t[n]={}),t=t[n];return null!=r?t[i.shift()]=r:delete t[i.shift()]},hasKeyPath:function(t,e){var r,n,i,o;for(i=0,o=(n=a(e)).length;i<o;i++){if(r=n[i],!t.hasOwnProperty(r))return!1;t=t[r]}return!0},spliceWithArray:function(t,e,r,n,i){var o,s,a,c;if(null==i&&(i=1e5),n.length<i)return t.splice.apply(t,[e,r].concat(u.call(n)));for(t.splice(e,r),c=[],o=s=0,a=n.length;i>0?s<=a:s>=a;o=s+=i)c.push(t.splice.apply(t,[e+o,0].concat(u.call(n.slice(o,o+i)))));return c},sum:function(t){var e,r,n;for(e=0,r=0,n=t.length;r<n;r++)e+=t[r];return e},uncamelcase:function(t){var e;return t?(e=t.replace(/([A-Z])|_+/g,function(t,e){return null==e&&(e="")," "+e}),o.capitalize(e.trim())):""},undasherize:function(t){return t?t.split("-").map(o.capitalize).join(" "):""},underscore:function(t){return t?(t=t[0].toLowerCase()+t.slice(1)).replace(/([A-Z])|-+/g,function(t,e){return null==e&&(e=""),"_"+e.toLowerCase()}):""},valueForKeyPath:function(t,e){var r,n,i;for(n=0,i=(r=a(e)).length;n<i;n++)if(null==(t=t[r[n]]))return;return t},isEqual:function(t,r,n,i){return c.isArray(n)&&c.isArray(i)?e(t,r,n,i):e(t,r)},isEqualForProperties:function(){var t,e,r,n,i,o;for(t=arguments[0],e=arguments[1],i=0,o=(r=3<=arguments.length?u.call(arguments,2):[]).length;i<o;i++)if(n=r[i],!c.isEqual(t[n],e[n]))return!1;return!0}},e=function(t,r,n,i){var o,s,a,u,l,h,p,f,b,d,m,v,y,_;if(null==n&&(n=[]),null==i&&(i=[]),t===r)return c.isEqual(t,r);if(c.isFunction(t)||c.isFunction(r))return c.isEqual(t,r);for(v=n.length;v--;)if(n[v]===t)return i[v]===r;if(n.push(t),i.push(r),b=!1,c.isFunction(null!=t?t.isEqual:void 0))b=t.isEqual(r,n,i);else if(c.isFunction(null!=r?r.isEqual:void 0))b=r.isEqual(t,i,n);else if(c.isArray(t)&&c.isArray(r)&&t.length===r.length){for(b=!0,d=y=0,_=t.length;y<_;d=++y)if(a=t[d],!e(a,r[d],n,i)){b=!1;break}}else if(c.isRegExp(t)&&c.isRegExp(r))b=c.isEqual(t,r);else if(c.isElement(t)&&c.isElement(r))b=t===r;else if(c.isObject(t)&&c.isObject(r))if(o=t.constructor,h=r.constructor,s=c.isFunction(o)&&o instanceof o,p=c.isFunction(h)&&h instanceof h,o===h||s&&p){for(m in u=0,b=!0,t)if(l=t[m],c.has(t,m)&&(u++,!c.has(r,m)||!e(l,r[m],n,i))){b=!1;break}if(b){for(m in f=0,r)r[m],c.has(r,m)&&f++;b=u===f}}else b=!1;else b=c.isEqual(t,r);return n.pop(),i.pop(),b},t.exports=c.extend({},c,o)}).call(commonjsGlobal)}),async$1=createCommonjsModule(function(t){!function(){var e,r={};function n(){}function i(t){return t}function o(t){return!!t}function s(t){return!t}var a="object"==typeof self&&self.self===self&&self||"object"==typeof commonjsGlobal&&commonjsGlobal.global===commonjsGlobal&&commonjsGlobal||this;function c(t){return function(){if(null===t)throw new Error("Callback was already called.");t.apply(this,arguments),t=null}}function u(t){return function(){null!==t&&(t.apply(this,arguments),t=null)}}null!=a&&(e=a.async),r.noConflict=function(){return a.async=e,r};var l=Object.prototype.toString,h=Array.isArray||function(t){return"[object Array]"===l.call(t)};function p(t){return h(t)||"number"==typeof t.length&&t.length>=0&&t.length%1==0}function f(t,e){for(var r=-1,n=t.length;++r<n;)e(t[r],r,t)}function b(t,e){for(var r=-1,n=t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}function d(t){return b(Array(t),function(t,e){return e})}function m(t,e){for(var r=0;r<t.length;r++)if(t[r]===e)return r;return-1}var v=Object.keys||function(t){var e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(r);return e};function y(t){var e,r,n=-1;return p(t)?(e=t.length,function(){return++n<e?n:null}):(r=v(t),e=r.length,function(){return++n<e?r[n]:null})}function _(t,e){return e=null==e?t.length-1:+e,function(){for(var r=Math.max(arguments.length-e,0),n=Array(r),i=0;i<r;i++)n[i]=arguments[i+e];switch(e){case 0:return t.call(this,n);case 1:return t.call(this,arguments[0],n)}}}function g(t){return function(e,r,n){return t(e,n)}}var w="function"==typeof setImmediate&&setImmediate,S=w?function(t){w(t)}:function(t){setTimeout(t,0)};function O(t){return function(e,r,i){i=u(i||n);var o=y(e=e||[]);if(t<=0)return i(null);var s=!1,a=0,l=!1;!function n(){if(s&&a<=0)return i(null);for(;a<t&&!l;){var u=o();if(null===u)return s=!0,void(a<=0&&i(null));a+=1,r(e[u],u,c(function(t){a-=1,t?(i(t),l=!0):n()}))}}()}}function x(t){return function(e,n,i){return t(r.eachOf,e,n,i)}}function j(t){return function(e,r,n,i){return t(O(r),e,n,i)}}function E(t){return function(e,n,i){return t(r.eachOfSeries,e,n,i)}}function T(t,e,r,i){i=u(i||n);var o=p(e=e||[])?[]:{};t(e,function(t,e,n){r(t,function(t,r){o[e]=r,n(t)})},function(t){i(t,o)})}function A(t,e,r,n){var i=[];t(e,function(t,e,n){r(t,function(r){r&&i.push({index:e,value:t}),n()})},function(){n(b(i.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})}function C(t,e,r,n){A(t,e,function(t,e){r(t,function(t){e(!t)})},n)}function k(t,e,r){return function(n,i,o,s){function a(){s&&s(r(!1,void 0))}function c(t,n,i){if(!s)return i();o(t,function(n){s&&e(n)&&(s(r(!0,t)),s=o=!1),i()})}arguments.length>3?t(n,i,c,a):(s=o,o=i,t(n,c,a))}}function P(t,e){return e}function R(t,e,r){r=r||n;var i=p(e)?[]:{};t(e,function(t,e,r){t(_(function(t,n){n.length<=1&&(n=n[0]),i[e]=n,r(t)}))},function(t){r(t,i)})}function $(t,e,r,n){var i=[];t(e,function(t,e,n){r(t,function(t,e){i=i.concat(e||[]),n(t)})},function(t){n(t,i)})}function N(t,e,i){if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");function o(t,e,i,o){if(null!=o&&"function"!=typeof o)throw new Error("task callback must be a function");if(t.started=!0,h(e)||(e=[e]),0===e.length&&t.idle())return r.setImmediate(function(){t.drain()});f(e,function(e){var r={data:e,callback:o||n};i?t.tasks.unshift(r):t.tasks.push(r),t.tasks.length===t.concurrency&&t.saturated()}),r.setImmediate(t.process)}function s(t,e){return function(){a-=1;var r=!1,n=arguments;f(e,function(t){f(u,function(e,n){e!==t||r||(u.splice(n,1),r=!0)}),t.callback.apply(t,n)}),t.tasks.length+a===0&&t.drain(),t.process()}}var a=0,u=[],l={tasks:[],concurrency:e,payload:i,saturated:n,empty:n,drain:n,started:!1,paused:!1,push:function(t,e){o(l,t,!1,e)},kill:function(){l.drain=n,l.tasks=[]},unshift:function(t,e){o(l,t,!0,e)},process:function(){for(;!l.paused&&a<l.concurrency&&l.tasks.length;){var e=l.payload?l.tasks.splice(0,l.payload):l.tasks.splice(0,l.tasks.length),r=b(e,function(t){return t.data});0===l.tasks.length&&l.empty(),a+=1,u.push(e[0]);var n=c(s(l,e));t(r,n)}},length:function(){return l.tasks.length},running:function(){return a},workersList:function(){return u},idle:function(){return l.tasks.length+a===0},pause:function(){l.paused=!0},resume:function(){if(!1!==l.paused){l.paused=!1;for(var t=Math.min(l.concurrency,l.tasks.length),e=1;e<=t;e++)r.setImmediate(l.process)}}};return l}function I(t){return _(function(e,r){e.apply(null,r.concat([_(function(e,r){"object"==typeof console&&(e?console.error&&console.error(e):console[t]&&f(r,function(e){console[t](e)}))})]))})}function F(t){return function(e,r,n){t(d(e),r,n)}}function M(t){return _(function(e,r){var n=_(function(r){var n=this,i=r.pop();return t(e,function(t,e,i){t.apply(n,r.concat([i]))},i)});return r.length?n.apply(this,r):n})}function G(t){return _(function(e){var n=e.pop();e.push(function(){var t=arguments;i?r.setImmediate(function(){n.apply(null,t)}):n.apply(null,t)});var i=!0;t.apply(this,e),i=!1})}"object"==typeof process&&"function"==typeof process.nextTick?r.nextTick=process.nextTick:r.nextTick=S,r.setImmediate=w?S:r.nextTick,r.forEach=r.each=function(t,e,n){return r.eachOf(t,g(e),n)},r.forEachSeries=r.eachSeries=function(t,e,n){return r.eachOfSeries(t,g(e),n)},r.forEachLimit=r.eachLimit=function(t,e,r,n){return O(e)(t,g(r),n)},r.forEachOf=r.eachOf=function(t,e,r){r=u(r||n);for(var i,o=y(t=t||[]),s=0;null!=(i=o());)s+=1,e(t[i],i,c(a));function a(t){s--,t?r(t):null===i&&s<=0&&r(null)}0===s&&r(null)},r.forEachOfSeries=r.eachOfSeries=function(t,e,i){i=u(i||n);var o=y(t=t||[]),s=o();!function n(){var a=!0;if(null===s)return i(null);e(t[s],s,c(function(t){if(t)i(t);else{if(null===(s=o()))return i(null);a?r.setImmediate(n):n()}})),a=!1}()},r.forEachOfLimit=r.eachOfLimit=function(t,e,r,n){O(e)(t,r,n)},r.map=x(T),r.mapSeries=E(T),r.mapLimit=j(T),r.inject=r.foldl=r.reduce=function(t,e,n,i){r.eachOfSeries(t,function(t,r,i){n(e,t,function(t,r){e=r,i(t)})},function(t){i(t,e)})},r.foldr=r.reduceRight=function(t,e,n,o){var s=b(t,i).reverse();r.reduce(s,e,n,o)},r.transform=function(t,e,n,i){3===arguments.length&&(i=n,n=e,e=h(t)?[]:{}),r.eachOf(t,function(t,r,i){n(e,t,r,i)},function(t){i(t,e)})},r.select=r.filter=x(A),r.selectLimit=r.filterLimit=j(A),r.selectSeries=r.filterSeries=E(A),r.reject=x(C),r.rejectLimit=j(C),r.rejectSeries=E(C),r.any=r.some=k(r.eachOf,o,i),r.someLimit=k(r.eachOfLimit,o,i),r.all=r.every=k(r.eachOf,s,s),r.everyLimit=k(r.eachOfLimit,s,s),r.detect=k(r.eachOf,i,P),r.detectSeries=k(r.eachOfSeries,i,P),r.detectLimit=k(r.eachOfLimit,i,P),r.sortBy=function(t,e,n){function i(t,e){var r=t.criteria,n=e.criteria;return r<n?-1:r>n?1:0}r.map(t,function(t,r){e(t,function(e,n){e?r(e):r(null,{value:t,criteria:n})})},function(t,e){if(t)return n(t);n(null,b(e.sort(i),function(t){return t.value}))})},r.auto=function(t,e,i){"function"==typeof arguments[1]&&(i=e,e=null),i=u(i||n);var o=v(t),s=o.length;if(!s)return i(null);e||(e=s);var a={},c=0,l=!1,p=[];function b(t){p.unshift(t)}function d(){s--,f(p.slice(0),function(t){t()})}b(function(){s||i(null,a)}),f(o,function(n){if(!l){for(var o,s=h(t[n])?t[n]:[t[n]],u=_(function(t,e){if(c--,e.length<=1&&(e=e[0]),t){var o={};!function(t,e){f(v(t),function(r){e(t[r],r)})}(a,function(t,e){o[e]=t}),o[n]=e,l=!0,i(t,o)}else a[n]=e,r.setImmediate(d)}),y=s.slice(0,s.length-1),g=y.length;g--;){if(!(o=t[y[g]]))throw new Error("Has nonexistent dependency in "+y.join(", "));if(h(o)&&m(o,n)>=0)throw new Error("Has cyclic dependencies")}w()?(c++,s[s.length-1](u,a)):b(function t(){w()&&(c++,(e=m(p,t))>=0&&p.splice(e,1),s[s.length-1](u,a));var e})}function w(){return c<e&&function(t,e,r){return f(t,function(t,n,i){r=e(r,t,n,i)}),r}(y,function(t,e){return t&&a.hasOwnProperty(e)},!0)&&!a.hasOwnProperty(n)}})},r.retry=function(t,e,n){var i=5,o=0,s=[],a={times:i,interval:o};var c=arguments.length;if(c<1||c>3)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");function u(t,e){function n(t,r){return function(n){t(function(t,e){n(!t||r,{err:t,result:e})},e)}}function i(t){return function(e){setTimeout(function(){e(null)},t)}}for(;a.times;){var o=!(a.times-=1);s.push(n(a.task,o)),!o&&a.interval>0&&s.push(i(a.interval))}r.series(s,function(e,r){r=r[r.length-1],(t||a.callback)(r.err,r.result)})}return c<=2&&"function"==typeof t&&(n=e,e=t),"function"!=typeof t&&function(t,e){if("number"==typeof e)t.times=parseInt(e,10)||i;else{if("object"!=typeof e)throw new Error("Unsupported argument type for 'times': "+typeof e);t.times=parseInt(e.times,10)||i,t.interval=parseInt(e.interval,10)||o}}(a,t),a.callback=n,a.task=e,a.callback?u():u},r.waterfall=function(t,e){if(e=u(e||n),!h(t)){var i=new Error("First argument to waterfall must be an array of functions");return e(i)}if(!t.length)return e();!function t(r){return _(function(n,i){if(n)e.apply(null,[n].concat(i));else{var o=r.next();o?i.push(t(o)):i.push(e),G(r).apply(null,i)}})}(r.iterator(t))()},r.parallel=function(t,e){R(r.eachOf,t,e)},r.parallelLimit=function(t,e,r){R(O(e),t,r)},r.series=function(t,e){R(r.eachOfSeries,t,e)},r.iterator=function(t){return function e(r){function n(){return t.length&&t[r].apply(null,arguments),n.next()}return n.next=function(){return r<t.length-1?e(r+1):null},n}(0)},r.apply=_(function(t,e){return _(function(r){return t.apply(null,e.concat(r))})}),r.concat=x($),r.concatSeries=E($),r.whilst=function(t,e,r){if(r=r||n,t()){var i=_(function(n,o){n?r(n):t.apply(this,o)?e(i):r.apply(null,[null].concat(o))});e(i)}else r(null)},r.doWhilst=function(t,e,n){var i=0;return r.whilst(function(){return++i<=1||e.apply(this,arguments)},t,n)},r.until=function(t,e,n){return r.whilst(function(){return!t.apply(this,arguments)},e,n)},r.doUntil=function(t,e,n){return r.doWhilst(t,function(){return!e.apply(this,arguments)},n)},r.during=function(t,e,r){r=r||n;var i=_(function(e,n){e?r(e):(n.push(o),t.apply(this,n))}),o=function(t,n){t?r(t):n?e(i):r(null)};t(o)},r.doDuring=function(t,e,n){var i=0;r.during(function(t){i++<1?t(null,!0):e.apply(this,arguments)},t,n)},r.queue=function(t,e){return N(function(e,r){t(e[0],r)},e,1)},r.priorityQueue=function(t,e){function i(t,e){return t.priority-e.priority}var o=r.queue(t,e);return o.push=function(t,e,s){!function(t,e,o,s){if(null!=s&&"function"!=typeof s)throw new Error("task callback must be a function");if(t.started=!0,h(e)||(e=[e]),0===e.length)return r.setImmediate(function(){t.drain()});f(e,function(e){var a={data:e,priority:o,callback:"function"==typeof s?s:n};t.tasks.splice(function(t,e,r){for(var n=-1,i=t.length-1;n<i;){var o=n+(i-n+1>>>1);r(e,t[o])>=0?n=o:i=o-1}return n}(t.tasks,a,i)+1,0,a),t.tasks.length===t.concurrency&&t.saturated(),r.setImmediate(t.process)})}(o,t,e,s)},delete o.unshift,o},r.cargo=function(t,e){return N(t,1,e)},r.log=I("log"),r.dir=I("dir"),r.memoize=function(t,e){var n={},o={},s=Object.prototype.hasOwnProperty;e=e||i;var a=_(function(i){var a=i.pop(),c=e.apply(null,i);s.call(n,c)?r.setImmediate(function(){a.apply(null,n[c])}):s.call(o,c)?o[c].push(a):(o[c]=[a],t.apply(null,i.concat([_(function(t){n[c]=t;var e=o[c];delete o[c];for(var r=0,i=e.length;r<i;r++)e[r].apply(null,t)})])))});return a.memo=n,a.unmemoized=t,a},r.unmemoize=function(t){return function(){return(t.unmemoized||t).apply(null,arguments)}},r.times=F(r.map),r.timesSeries=F(r.mapSeries),r.timesLimit=function(t,e,n,i){return r.mapLimit(d(t),e,n,i)},r.seq=function(){var t=arguments;return _(function(e){var i=this,o=e[e.length-1];"function"==typeof o?e.pop():o=n,r.reduce(t,e,function(t,e,r){e.apply(i,t.concat([_(function(t,e){r(t,e)})]))},function(t,e){o.apply(i,[t].concat(e))})})},r.compose=function(){return r.seq.apply(null,Array.prototype.reverse.call(arguments))},r.applyEach=M(r.eachOf),r.applyEachSeries=M(r.eachOfSeries),r.forever=function(t,e){var r=c(e||n),i=G(t);!function t(e){if(e)return r(e);i(t)}()},r.ensureAsync=G,r.constant=_(function(t){var e=[null].concat(t);return function(t){return t.apply(this,e)}}),r.wrapSync=r.asyncify=function(t){return _(function(e){var r,n=e.pop();try{r=t.apply(this,e)}catch(t){return n(t)}!function(t){var e=typeof t;return"function"===e||"object"===e&&!!t}(r)||"function"!=typeof r.then?n(null,r):r.then(function(t){n(null,t)}).catch(function(t){n(t.message?t:new Error(t))})})},t.exports?t.exports=r:a.async=r}()}),_0777=parseInt("0777",8),mkdirp=mkdirP.mkdirp=mkdirP.mkdirP=mkdirP;function mkdirP(t,e,r,n){"function"==typeof e?(r=e,e={}):e&&"object"==typeof e||(e={mode:e});var i=e.mode,o=e.fs||fs;void 0===i&&(i=_0777&~process.umask()),n||(n=null);var s=r||function(){};t=path$1__default.resolve(t),o.mkdir(t,i,function(r){if(!r)return s(null,n=n||t);switch(r.code){case"ENOENT":mkdirP(path$1__default.dirname(t),e,function(r,n){r?s(r,n):mkdirP(t,e,s,n)});break;default:o.stat(t,function(t,e){t||!e.isDirectory()?s(r,n):s(null,n)})}})}mkdirP.sync=function t(e,r,n){r&&"object"==typeof r||(r={mode:r});var i=r.mode,o=r.fs||fs;void 0===i&&(i=_0777&~process.umask()),n||(n=null),e=path$1__default.resolve(e);try{o.mkdirSync(e,i),n=n||e}catch(i){switch(i.code){case"ENOENT":n=t(path$1__default.dirname(e),r,n),t(e,r,n);break;default:var s;try{s=o.statSync(e)}catch(t){throw i}if(!s.isDirectory())throw i}}return n};var isWindows$1="win32"===process.platform,DEBUG=process.env.NODE_DEBUG&&/fs/.test(process.env.NODE_DEBUG);function rethrow(){var t;if(DEBUG){var e=new Error;t=function(t){t&&(e.message=t.message,r(t=e))}}else t=r;return t;function r(t){if(t){if(process.throwDeprecation)throw t;if(!process.noDeprecation){var e="fs: missing callback "+(t.stack||t.message);process.traceDeprecation?console.trace(e):console.error(e)}}}}function maybeCallback(t){return"function"==typeof t?t:rethrow()}var normalize$1=path$1__default.normalize;if(isWindows$1)var nextPartRe=/(.*?)(?:[\/\\]+|$)/g;else nextPartRe=/(.*?)(?:[\/]+|$)/g;if(isWindows$1)var splitRootRe=/^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/;else splitRootRe=/^[\/]*/;var realpathSync=function(t,e){if(t=path$1__default.resolve(t),e&&Object.prototype.hasOwnProperty.call(e,t))return e[t];var r,n,i,o,s=t,a={},c={};function u(){var e=splitRootRe.exec(t);r=e[0].length,n=e[0],i=e[0],o="",isWindows$1&&!c[i]&&(fs.lstatSync(i),c[i]=!0)}for(u();r<t.length;){nextPartRe.lastIndex=r;var l=nextPartRe.exec(t);if(o=n,n+=l[0],i=o+l[1],r=nextPartRe.lastIndex,!(c[i]||e&&e[i]===i)){var h;if(e&&Object.prototype.hasOwnProperty.call(e,i))h=e[i];else{var p=fs.lstatSync(i);if(!p.isSymbolicLink()){c[i]=!0,e&&(e[i]=i);continue}var f=null;if(!isWindows$1){var b=p.dev.toString(32)+":"+p.ino.toString(32);a.hasOwnProperty(b)&&(f=a[b])}null===f&&(fs.statSync(i),f=fs.readlinkSync(i)),h=path$1__default.resolve(o,f),e&&(e[i]=h),isWindows$1||(a[b]=f)}t=path$1__default.resolve(h,t.slice(r)),u()}}return e&&(e[s]=t),t},realpath=function(t,e,r){if("function"!=typeof r&&(r=maybeCallback(e),e=null),t=path$1__default.resolve(t),e&&Object.prototype.hasOwnProperty.call(e,t))return process.nextTick(r.bind(null,null,e[t]));var n,i,o,s,a=t,c={},u={};function l(){var e=splitRootRe.exec(t);n=e[0].length,i=e[0],o=e[0],s="",isWindows$1&&!u[o]?fs.lstat(o,function(t){if(t)return r(t);u[o]=!0,h()}):process.nextTick(h)}function h(){if(n>=t.length)return e&&(e[a]=t),r(null,t);nextPartRe.lastIndex=n;var c=nextPartRe.exec(t);return s=i,i+=c[0],o=s+c[1],n=nextPartRe.lastIndex,u[o]||e&&e[o]===o?process.nextTick(h):e&&Object.prototype.hasOwnProperty.call(e,o)?b(e[o]):fs.lstat(o,p)}function p(t,n){if(t)return r(t);if(!n.isSymbolicLink())return u[o]=!0,e&&(e[o]=o),process.nextTick(h);if(!isWindows$1){var i=n.dev.toString(32)+":"+n.ino.toString(32);if(c.hasOwnProperty(i))return f(null,c[i],o)}fs.stat(o,function(t){if(t)return r(t);fs.readlink(o,function(t,e){isWindows$1||(c[i]=e),f(t,e)})})}function f(t,n,i){if(t)return r(t);var o=path$1__default.resolve(s,n);e&&(e[i]=o),b(o)}function b(e){t=path$1__default.resolve(e,t.slice(n)),l()}l()},old={realpathSync:realpathSync,realpath:realpath},fs_realpath=realpath$1;realpath$1.realpath=realpath$1,realpath$1.sync=realpathSync$1,realpath$1.realpathSync=realpathSync$1,realpath$1.monkeypatch=monkeypatch,realpath$1.unmonkeypatch=unmonkeypatch;var origRealpath=fs.realpath,origRealpathSync=fs.realpathSync,version=process.version,ok=/^v[0-5]\./.test(version);function newError(t){return t&&"realpath"===t.syscall&&("ELOOP"===t.code||"ENOMEM"===t.code||"ENAMETOOLONG"===t.code)}function realpath$1(t,e,r){if(ok)return origRealpath(t,e,r);"function"==typeof e&&(r=e,e=null),origRealpath(t,e,function(n,i){newError(n)?old.realpath(t,e,r):r(n,i)})}function realpathSync$1(t,e){if(ok)return origRealpathSync(t,e);try{return origRealpathSync(t,e)}catch(r){if(newError(r))return old.realpathSync(t,e);throw r}}function monkeypatch(){fs.realpath=realpath$1,fs.realpathSync=realpathSync$1}function unmonkeypatch(){fs.realpath=origRealpath,fs.realpathSync=origRealpathSync}var concatMap$1=function(t,e){for(var r=[],n=0;n<t.length;n++){var i=e(t[n],n);isArray$1(i)?r.push.apply(r,i):r.push(i)}return r},isArray$1=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},balancedMatch=balanced;function balanced(t,e,r){t instanceof RegExp&&(t=maybeMatch(t,r)),e instanceof RegExp&&(e=maybeMatch(e,r));var n=range$1(t,e,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+t.length,n[1]),post:r.slice(n[1]+e.length)}}function maybeMatch(t,e){var r=e.match(t);return r?r[0]:null}function range$1(t,e,r){var n,i,o,s,a,c=r.indexOf(t),u=r.indexOf(e,c+1),l=c;if(c>=0&&u>0){for(n=[],o=r.length;l>=0&&!a;)l==c?(n.push(l),c=r.indexOf(t,l+1)):1==n.length?a=[n.pop(),u]:((i=n.pop())<o&&(o=i,s=u),u=r.indexOf(e,l+1)),l=c<u&&c>=0?c:u;n.length&&(a=[o,s])}return a}balanced.range=range$1;var braceExpansion=expandTop,escSlash="\0SLASH"+Math.random()+"\0",escOpen="\0OPEN"+Math.random()+"\0",escClose="\0CLOSE"+Math.random()+"\0",escComma="\0COMMA"+Math.random()+"\0",escPeriod="\0PERIOD"+Math.random()+"\0";function numeric(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function escapeBraces(t){return t.split("\\\\").join(escSlash).split("\\{").join(escOpen).split("\\}").join(escClose).split("\\,").join(escComma).split("\\.").join(escPeriod)}function unescapeBraces(t){return t.split(escSlash).join("\\").split(escOpen).join("{").split(escClose).join("}").split(escComma).join(",").split(escPeriod).join(".")}function parseCommaParts(t){if(!t)return[""];var e=[],r=balancedMatch("{","}",t);if(!r)return t.split(",");var n=r.pre,i=r.body,o=r.post,s=n.split(",");s[s.length-1]+="{"+i+"}";var a=parseCommaParts(o);return o.length&&(s[s.length-1]+=a.shift(),s.push.apply(s,a)),e.push.apply(e,s),e}function expandTop(t){return t?("{}"===t.substr(0,2)&&(t="\\{\\}"+t.substr(2)),expand$1(escapeBraces(t),!0).map(unescapeBraces)):[]}function embrace(t){return"{"+t+"}"}function isPadded(t){return/^-?0\d/.test(t)}function lte(t,e){return t<=e}function gte(t,e){return t>=e}function expand$1(t,e){var r=[],n=balancedMatch("{","}",t);if(!n||/\$$/.test(n.pre))return[t];var i,o=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(n.body),s=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(n.body),a=o||s,c=n.body.indexOf(",")>=0;if(!a&&!c)return n.post.match(/,.*\}/)?expand$1(t=n.pre+"{"+n.body+escClose+n.post):[t];if(a)i=n.body.split(/\.\./);else if(1===(i=parseCommaParts(n.body)).length&&1===(i=expand$1(i[0],!1).map(embrace)).length)return(h=n.post.length?expand$1(n.post,!1):[""]).map(function(t){return n.pre+i[0]+t});var u,l=n.pre,h=n.post.length?expand$1(n.post,!1):[""];if(a){var p=numeric(i[0]),f=numeric(i[1]),b=Math.max(i[0].length,i[1].length),d=3==i.length?Math.abs(numeric(i[2])):1,m=lte;f<p&&(d*=-1,m=gte);var v=i.some(isPadded);u=[];for(var y=p;m(y,f);y+=d){var _;if(s)"\\"===(_=String.fromCharCode(y))&&(_="");else if(_=String(y),v){var g=b-_.length;if(g>0){var w=new Array(g+1).join("0");_=y<0?"-"+w+_.slice(1):w+_}}u.push(_)}}else u=concatMap$1(i,function(t){return expand$1(t,!1)});for(var S=0;S<u.length;S++)for(var O=0;O<h.length;O++){var x=l+u[S]+h[O];(!e||a||x)&&r.push(x)}return r}var minimatch_1=minimatch;minimatch.Minimatch=Minimatch;var path={sep:"/"};try{path=path$1__default}catch(t){}var GLOBSTAR=minimatch.GLOBSTAR=Minimatch.GLOBSTAR={},plTypes={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},qmark="[^/]",star=qmark+"*?",twoStarDot="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",twoStarNoDot="(?:(?!(?:\\/|^)\\.).)*?",reSpecials=charSet("().*{}+?[]^$\\!");function charSet(t){return t.split("").reduce(function(t,e){return t[e]=!0,t},{})}var slashSplit=/\/+/;function filter$1(t,e){return e=e||{},function(r,n,i){return minimatch(r,t,e)}}function ext(t,e){t=t||{},e=e||{};var r={};return Object.keys(e).forEach(function(t){r[t]=e[t]}),Object.keys(t).forEach(function(e){r[e]=t[e]}),r}function minimatch(t,e,r){if("string"!=typeof e)throw new TypeError("glob pattern string required");return r||(r={}),!(!r.nocomment&&"#"===e.charAt(0))&&(""===e.trim()?""===t:new Minimatch(e,r).match(t))}function Minimatch(t,e){if(!(this instanceof Minimatch))return new Minimatch(t,e);if("string"!=typeof t)throw new TypeError("glob pattern string required");e||(e={}),t=t.trim(),"/"!==path.sep&&(t=t.split(path.sep).join("/")),this.options=e,this.set=[],this.pattern=t,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}function make(){if(!this._made){var t=this.pattern,e=this.options;if(e.nocomment||"#"!==t.charAt(0))if(t){this.parseNegate();var r=this.globSet=this.braceExpand();e.debug&&(this.debug=console.error),this.debug(this.pattern,r),r=this.globParts=r.map(function(t){return t.split(slashSplit)}),this.debug(this.pattern,r),r=r.map(function(t,e,r){return t.map(this.parse,this)},this),this.debug(this.pattern,r),r=r.filter(function(t){return-1===t.indexOf(!1)}),this.debug(this.pattern,r),this.set=r}else this.empty=!0;else this.comment=!0}}function parseNegate(){var t=this.pattern,e=!1,r=0;if(!this.options.nonegate){for(var n=0,i=t.length;n<i&&"!"===t.charAt(n);n++)e=!e,r++;r&&(this.pattern=t.substr(r)),this.negate=e}}function braceExpand(t,e){if(e||(e=this instanceof Minimatch?this.options:{}),void 0===(t=void 0===t?this.pattern:t))throw new TypeError("undefined pattern");return e.nobrace||!t.match(/\{.*\}/)?[t]:braceExpansion(t)}minimatch.filter=filter$1,minimatch.defaults=function(t){if(!t||!Object.keys(t).length)return minimatch;var e=minimatch,r=function(r,n,i){return e.minimatch(r,n,ext(t,i))};return r.Minimatch=function(r,n){return new e.Minimatch(r,ext(t,n))},r},Minimatch.defaults=function(t){return t&&Object.keys(t).length?minimatch.defaults(t).Minimatch:Minimatch},Minimatch.prototype.debug=function(){},Minimatch.prototype.make=make,Minimatch.prototype.parseNegate=parseNegate,minimatch.braceExpand=function(t,e){return braceExpand(t,e)},Minimatch.prototype.braceExpand=braceExpand,Minimatch.prototype.parse=parse$2;var SUBPARSE={};function parse$2(t,e){if(t.length>65536)throw new TypeError("pattern is too long");var r=this.options;if(!r.noglobstar&&"**"===t)return GLOBSTAR;if(""===t)return"";var n,i="",o=!!r.nocase,s=!1,a=[],c=[],u=!1,l=-1,h=-1,p="."===t.charAt(0)?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",f=this;function b(){if(n){switch(n){case"*":i+=star,o=!0;break;case"?":i+=qmark,o=!0;break;default:i+="\\"+n}f.debug("clearStateChar %j %j",n,i),n=!1}}for(var d,m=0,v=t.length;m<v&&(d=t.charAt(m));m++)if(this.debug("%s\t%s %s %j",t,m,i,d),s&&reSpecials[d])i+="\\"+d,s=!1;else switch(d){case"/":return!1;case"\\":b(),s=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",t,m,i,d),u){this.debug("  in class"),"!"===d&&m===h+1&&(d="^"),i+=d;continue}f.debug("call clearStateChar %j",n),b(),n=d,r.noext&&b();continue;case"(":if(u){i+="(";continue}if(!n){i+="\\(";continue}a.push({type:n,start:m-1,reStart:i.length,open:plTypes[n].open,close:plTypes[n].close}),i+="!"===n?"(?:(?!(?:":"(?:",this.debug("plType %j %j",n,i),n=!1;continue;case")":if(u||!a.length){i+="\\)";continue}b(),o=!0;var y=a.pop();i+=y.close,"!"===y.type&&c.push(y),y.reEnd=i.length;continue;case"|":if(u||!a.length||s){i+="\\|",s=!1;continue}b(),i+="|";continue;case"[":if(b(),u){i+="\\"+d;continue}u=!0,h=m,l=i.length,i+=d;continue;case"]":if(m===h+1||!u){i+="\\"+d,s=!1;continue}if(u){var _=t.substring(h+1,m);try{RegExp("["+_+"]")}catch(t){var g=this.parse(_,SUBPARSE);i=i.substr(0,l)+"\\["+g[0]+"\\]",o=o||g[1],u=!1;continue}}o=!0,u=!1,i+=d;continue;default:b(),s?s=!1:!reSpecials[d]||"^"===d&&u||(i+="\\"),i+=d}for(u&&(_=t.substr(h+1),g=this.parse(_,SUBPARSE),i=i.substr(0,l)+"\\["+g[0],o=o||g[1]),y=a.pop();y;y=a.pop()){var w=i.slice(y.reStart+y.open.length);this.debug("setting tail",i,y),w=w.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(t,e,r){return r||(r="\\"),e+e+r+"|"}),this.debug("tail=%j\n   %s",w,w,y,i);var S="*"===y.type?star:"?"===y.type?qmark:"\\"+y.type;o=!0,i=i.slice(0,y.reStart)+S+"\\("+w}b(),s&&(i+="\\\\");var O=!1;switch(i.charAt(0)){case".":case"[":case"(":O=!0}for(var x=c.length-1;x>-1;x--){var j=c[x],E=i.slice(0,j.reStart),T=i.slice(j.reStart,j.reEnd-8),A=i.slice(j.reEnd-8,j.reEnd),C=i.slice(j.reEnd);A+=C;var k=E.split("(").length-1,P=C;for(m=0;m<k;m++)P=P.replace(/\)[+*?]?/,"");var R="";""===(C=P)&&e!==SUBPARSE&&(R="$"),i=E+T+C+R+A}if(""!==i&&o&&(i="(?=.)"+i),O&&(i=p+i),e===SUBPARSE)return[i,o];if(!o)return globUnescape(t);var $=r.nocase?"i":"";try{var N=new RegExp("^"+i+"$",$)}catch(t){return new RegExp("$.")}return N._glob=t,N._src=i,N}function makeRe(){if(this.regexp||!1===this.regexp)return this.regexp;var t=this.set;if(!t.length)return this.regexp=!1,this.regexp;var e=this.options,r=e.noglobstar?star:e.dot?twoStarDot:twoStarNoDot,n=e.nocase?"i":"",i=t.map(function(t){return t.map(function(t){return t===GLOBSTAR?r:"string"==typeof t?regExpEscape(t):t._src}).join("\\/")}).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,n)}catch(t){this.regexp=!1}return this.regexp}function match(t,e){if(this.debug("match",t,this.pattern),this.comment)return!1;if(this.empty)return""===t;if("/"===t&&e)return!0;var r=this.options;"/"!==path.sep&&(t=t.split(path.sep).join("/")),t=t.split(slashSplit),this.debug(this.pattern,"split",t);var n,i,o=this.set;for(this.debug(this.pattern,"set",o),i=t.length-1;i>=0&&!(n=t[i]);i--);for(i=0;i<o.length;i++){var s=o[i],a=t;if(r.matchBase&&1===s.length&&(a=[n]),this.matchOne(a,s,e))return!!r.flipNegate||!this.negate}return!r.flipNegate&&this.negate}function globUnescape(t){return t.replace(/\\(.)/g,"$1")}function regExpEscape(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}minimatch.makeRe=function(t,e){return new Minimatch(t,e||{}).makeRe()},Minimatch.prototype.makeRe=makeRe,minimatch.match=function(t,e,r){var n=new Minimatch(e,r=r||{});return t=t.filter(function(t){return n.match(t)}),n.options.nonull&&!t.length&&t.push(e),t},Minimatch.prototype.match=match,Minimatch.prototype.matchOne=function(t,e,r){var n=this.options;this.debug("matchOne",{this:this,file:t,pattern:e}),this.debug("matchOne",t.length,e.length);for(var i=0,o=0,s=t.length,a=e.length;i<s&&o<a;i++,o++){this.debug("matchOne loop");var c,u=e[o],l=t[i];if(this.debug(e,u,l),!1===u)return!1;if(u===GLOBSTAR){this.debug("GLOBSTAR",[e,u,l]);var h=i,p=o+1;if(p===a){for(this.debug("** at the end");i<s;i++)if("."===t[i]||".."===t[i]||!n.dot&&"."===t[i].charAt(0))return!1;return!0}for(;h<s;){var f=t[h];if(this.debug("\nglobstar while",t,h,e,p,f),this.matchOne(t.slice(h),e.slice(p),r))return this.debug("globstar found match!",h,s,f),!0;if("."===f||".."===f||!n.dot&&"."===f.charAt(0)){this.debug("dot detected!",t,h,e,p);break}this.debug("globstar swallow a segment, and continue"),h++}return!(!r||(this.debug("\n>>> no match, partial?",t,h,e,p),h!==s))}if("string"==typeof u?(c=n.nocase?l.toLowerCase()===u.toLowerCase():l===u,this.debug("string match",u,l,c)):(c=l.match(u),this.debug("pattern match",u,l,c)),!c)return!1}if(i===s&&o===a)return!0;if(i===s)return r;if(o===a)return i===s-1&&""===t[i];throw new Error("wtf?")};var inherits_browser=createCommonjsModule(function(t){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}}),inherits=createCommonjsModule(function(t){try{var e=util;if("function"!=typeof e.inherits)throw"";t.exports=e.inherits}catch(e){t.exports=inherits_browser}});function posix(t){return"/"===t.charAt(0)}function win32(t){var e=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/.exec(t),r=e[1]||"",n=Boolean(r&&":"!==r.charAt(1));return Boolean(e[2]||n)}var pathIsAbsolute="win32"===process.platform?win32:posix,posix_1=posix,win32_1=win32;pathIsAbsolute.posix=posix_1,pathIsAbsolute.win32=win32_1;var alphasort_1=alphasort,alphasorti_1=alphasorti,setopts_1=setopts,ownProp_1=ownProp,makeAbs_1=makeAbs,finish_1=finish,mark_1=mark,isIgnored_1=isIgnored,childrenIgnored_1=childrenIgnored;function ownProp(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var Minimatch$1=minimatch_1.Minimatch;function alphasorti(t,e){return t.toLowerCase().localeCompare(e.toLowerCase())}function alphasort(t,e){return t.localeCompare(e)}function setupIgnores(t,e){t.ignore=e.ignore||[],Array.isArray(t.ignore)||(t.ignore=[t.ignore]),t.ignore.length&&(t.ignore=t.ignore.map(ignoreMap))}function ignoreMap(t){var e=null;if("/**"===t.slice(-3)){var r=t.replace(/(\/\*\*)+$/,"");e=new Minimatch$1(r,{dot:!0})}return{matcher:new Minimatch$1(t,{dot:!0}),gmatcher:e}}function setopts(t,e,r){if(r||(r={}),r.matchBase&&-1===e.indexOf("/")){if(r.noglobstar)throw new Error("base matching requires globstar");e="**/"+e}t.silent=!!r.silent,t.pattern=e,t.strict=!1!==r.strict,t.realpath=!!r.realpath,t.realpathCache=r.realpathCache||Object.create(null),t.follow=!!r.follow,t.dot=!!r.dot,t.mark=!!r.mark,t.nodir=!!r.nodir,t.nodir&&(t.mark=!0),t.sync=!!r.sync,t.nounique=!!r.nounique,t.nonull=!!r.nonull,t.nosort=!!r.nosort,t.nocase=!!r.nocase,t.stat=!!r.stat,t.noprocess=!!r.noprocess,t.absolute=!!r.absolute,t.maxLength=r.maxLength||1/0,t.cache=r.cache||Object.create(null),t.statCache=r.statCache||Object.create(null),t.symlinks=r.symlinks||Object.create(null),setupIgnores(t,r),t.changedCwd=!1;var n=process.cwd();ownProp(r,"cwd")?(t.cwd=path$1__default.resolve(r.cwd),t.changedCwd=t.cwd!==n):t.cwd=n,t.root=r.root||path$1__default.resolve(t.cwd,"/"),t.root=path$1__default.resolve(t.root),"win32"===process.platform&&(t.root=t.root.replace(/\\/g,"/")),t.cwdAbs=pathIsAbsolute(t.cwd)?t.cwd:makeAbs(t,t.cwd),"win32"===process.platform&&(t.cwdAbs=t.cwdAbs.replace(/\\/g,"/")),t.nomount=!!r.nomount,r.nonegate=!0,r.nocomment=!0,t.minimatch=new Minimatch$1(e,r),t.options=t.minimatch.options}function finish(t){for(var e=t.nounique,r=e?[]:Object.create(null),n=0,i=t.matches.length;n<i;n++){var o=t.matches[n];if(o&&0!==Object.keys(o).length){var s=Object.keys(o);e?r.push.apply(r,s):s.forEach(function(t){r[t]=!0})}else if(t.nonull){var a=t.minimatch.globSet[n];e?r.push(a):r[a]=!0}}if(e||(r=Object.keys(r)),t.nosort||(r=r.sort(t.nocase?alphasorti:alphasort)),t.mark){for(n=0;n<r.length;n++)r[n]=t._mark(r[n]);t.nodir&&(r=r.filter(function(e){var r=!/\/$/.test(e),n=t.cache[e]||t.cache[makeAbs(t,e)];return r&&n&&(r="DIR"!==n&&!Array.isArray(n)),r}))}t.ignore.length&&(r=r.filter(function(e){return!isIgnored(t,e)})),t.found=r}function mark(t,e){var r=makeAbs(t,e),n=t.cache[r],i=e;if(n){var o="DIR"===n||Array.isArray(n),s="/"===e.slice(-1);if(o&&!s?i+="/":!o&&s&&(i=i.slice(0,-1)),i!==e){var a=makeAbs(t,i);t.statCache[a]=t.statCache[r],t.cache[a]=t.cache[r]}}return i}function makeAbs(t,e){var r=e;return r="/"===e.charAt(0)?path$1__default.join(t.root,e):pathIsAbsolute(e)||""===e?e:t.changedCwd?path$1__default.resolve(t.cwd,e):path$1__default.resolve(e),"win32"===process.platform&&(r=r.replace(/\\/g,"/")),r}function isIgnored(t,e){return!!t.ignore.length&&t.ignore.some(function(t){return t.matcher.match(e)||!(!t.gmatcher||!t.gmatcher.match(e))})}function childrenIgnored(t,e){return!!t.ignore.length&&t.ignore.some(function(t){return!(!t.gmatcher||!t.gmatcher.match(e))})}var common={alphasort:alphasort_1,alphasorti:alphasorti_1,setopts:setopts_1,ownProp:ownProp_1,makeAbs:makeAbs_1,finish:finish_1,mark:mark_1,isIgnored:isIgnored_1,childrenIgnored:childrenIgnored_1},sync$4=globSync;globSync.GlobSync=GlobSync;var setopts$1=common.setopts,ownProp$1=common.ownProp,childrenIgnored$1=common.childrenIgnored,isIgnored$1=common.isIgnored;function globSync(t,e){if("function"==typeof e||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");return new GlobSync(t,e).found}function GlobSync(t,e){if(!t)throw new Error("must provide pattern");if("function"==typeof e||3===arguments.length)throw new TypeError("callback provided to sync glob\nSee: https://github.com/isaacs/node-glob/issues/167");if(!(this instanceof GlobSync))return new GlobSync(t,e);if(setopts$1(this,t,e),this.noprocess)return this;var r=this.minimatch.set.length;this.matches=new Array(r);for(var n=0;n<r;n++)this._process(this.minimatch.set[n],n,!1);this._finish()}GlobSync.prototype._finish=function(){if(invariant(this instanceof GlobSync),this.realpath){var t=this;this.matches.forEach(function(e,r){var n=t.matches[r]=Object.create(null);for(var i in e)try{i=t._makeAbs(i),n[fs_realpath.realpathSync(i,t.realpathCache)]=!0}catch(e){if("stat"!==e.syscall)throw e;n[t._makeAbs(i)]=!0}})}common.finish(this)},GlobSync.prototype._process=function(t,e,r){invariant(this instanceof GlobSync);for(var n,i=0;"string"==typeof t[i];)i++;switch(i){case t.length:return void this._processSimple(t.join("/"),e);case 0:n=null;break;default:n=t.slice(0,i).join("/")}var o,s=t.slice(i);null===n?o=".":pathIsAbsolute(n)||pathIsAbsolute(t.join("/"))?(n&&pathIsAbsolute(n)||(n="/"+n),o=n):o=n;var a=this._makeAbs(o);childrenIgnored$1(this,o)||(s[0]===minimatch_1.GLOBSTAR?this._processGlobStar(n,o,a,s,e,r):this._processReaddir(n,o,a,s,e,r))},GlobSync.prototype._processReaddir=function(t,e,r,n,i,o){var s=this._readdir(r,o);if(s){for(var a=n[0],c=!!this.minimatch.negate,u=a._glob,l=this.dot||"."===u.charAt(0),h=[],p=0;p<s.length;p++){if("."!==(d=s[p]).charAt(0)||l)(c&&!t?!d.match(a):d.match(a))&&h.push(d)}var f=h.length;if(0!==f)if(1!==n.length||this.mark||this.stat){n.shift();for(p=0;p<f;p++){var b;d=h[p];b=t?[t,d]:[d],this._process(b.concat(n),i,o)}}else{this.matches[i]||(this.matches[i]=Object.create(null));for(var p=0;p<f;p++){var d=h[p];t&&(d="/"!==t.slice(-1)?t+"/"+d:t+d),"/"!==d.charAt(0)||this.nomount||(d=path$1__default.join(this.root,d)),this._emitMatch(i,d)}}}},GlobSync.prototype._emitMatch=function(t,e){if(!isIgnored$1(this,e)){var r=this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=r),!this.matches[t][e]){if(this.nodir){var n=this.cache[r];if("DIR"===n||Array.isArray(n))return}this.matches[t][e]=!0,this.stat&&this._stat(e)}}},GlobSync.prototype._readdirInGlobStar=function(t){if(this.follow)return this._readdir(t,!1);var e,r;try{r=fs.lstatSync(t)}catch(t){if("ENOENT"===t.code)return null}var n=r&&r.isSymbolicLink();return this.symlinks[t]=n,n||!r||r.isDirectory()?e=this._readdir(t,!1):this.cache[t]="FILE",e},GlobSync.prototype._readdir=function(t,e){if(e&&!ownProp$1(this.symlinks,t))return this._readdirInGlobStar(t);if(ownProp$1(this.cache,t)){var r=this.cache[t];if(!r||"FILE"===r)return null;if(Array.isArray(r))return r}try{return this._readdirEntries(t,fs.readdirSync(t))}catch(e){return this._readdirError(t,e),null}},GlobSync.prototype._readdirEntries=function(t,e){if(!this.mark&&!this.stat)for(var r=0;r<e.length;r++){var n=e[r];n="/"===t?t+n:t+"/"+n,this.cache[n]=!0}return this.cache[t]=e,e},GlobSync.prototype._readdirError=function(t,e){switch(e.code){case"ENOTSUP":case"ENOTDIR":var r=this._makeAbs(t);if(this.cache[r]="FILE",r===this.cwdAbs){var n=new Error(e.code+" invalid cwd "+this.cwd);throw n.path=this.cwd,n.code=e.code,n}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:if(this.cache[this._makeAbs(t)]=!1,this.strict)throw e;this.silent||console.error("glob error",e)}},GlobSync.prototype._processGlobStar=function(t,e,r,n,i,o){var s=this._readdir(r,o);if(s){var a=n.slice(1),c=t?[t]:[],u=c.concat(a);this._process(u,i,!1);var l=s.length;if(!this.symlinks[r]||!o)for(var h=0;h<l;h++){if("."!==s[h].charAt(0)||this.dot){var p=c.concat(s[h],a);this._process(p,i,!0);var f=c.concat(s[h],n);this._process(f,i,!0)}}}},GlobSync.prototype._processSimple=function(t,e){var r=this._stat(t);if(this.matches[e]||(this.matches[e]=Object.create(null)),r){if(t&&pathIsAbsolute(t)&&!this.nomount){var n=/[\/\\]$/.test(t);"/"===t.charAt(0)?t=path$1__default.join(this.root,t):(t=path$1__default.resolve(this.root,t),n&&(t+="/"))}"win32"===process.platform&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t)}},GlobSync.prototype._stat=function(t){var e=this._makeAbs(t),r="/"===t.slice(-1);if(t.length>this.maxLength)return!1;if(!this.stat&&ownProp$1(this.cache,e)){var n=this.cache[e];if(Array.isArray(n)&&(n="DIR"),!r||"DIR"===n)return n;if(r&&"FILE"===n)return!1}var i=this.statCache[e];if(!i){var o;try{o=fs.lstatSync(e)}catch(t){if(t&&("ENOENT"===t.code||"ENOTDIR"===t.code))return this.statCache[e]=!1,!1}if(o&&o.isSymbolicLink())try{i=fs.statSync(e)}catch(t){i=o}else i=o}this.statCache[e]=i;n=!0;return i&&(n=i.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||n,(!r||"FILE"!==n)&&n},GlobSync.prototype._mark=function(t){return common.mark(this,t)},GlobSync.prototype._makeAbs=function(t){return common.makeAbs(this,t)};var wrappy_1=wrappy;function wrappy(t,e){if(t&&e)return wrappy(t)(e);if("function"!=typeof t)throw new TypeError("need wrapper function");return Object.keys(t).forEach(function(e){r[e]=t[e]}),r;function r(){for(var e=new Array(arguments.length),r=0;r<e.length;r++)e[r]=arguments[r];var n=t.apply(this,e),i=e[e.length-1];return"function"==typeof n&&n!==i&&Object.keys(i).forEach(function(t){n[t]=i[t]}),n}}var once_1=wrappy_1(once),strict=wrappy_1(onceStrict);function once(t){var e=function(){return e.called?e.value:(e.called=!0,e.value=t.apply(this,arguments))};return e.called=!1,e}function onceStrict(t){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=t.apply(this,arguments)},r=t.name||"Function wrapped with `once`";return e.onceError=r+" shouldn't be called more than once",e.called=!1,e}once.proto=once(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return once(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return onceStrict(this)},configurable:!0})}),once_1.strict=strict;var reqs=Object.create(null),inflight_1=wrappy_1(inflight);function inflight(t,e){return reqs[t]?(reqs[t].push(e),null):(reqs[t]=[e],makeres(t))}function makeres(t){return once_1(function e(){var r=reqs[t],n=r.length,i=slice(arguments);try{for(var o=0;o<n;o++)r[o].apply(null,i)}finally{r.length>n?(r.splice(0,n),process.nextTick(function(){e.apply(null,i)})):delete reqs[t]}})}function slice(t){for(var e=t.length,r=[],n=0;n<e;n++)r[n]=t[n];return r}var glob_1=glob,EE=EventEmitter.EventEmitter,setopts$2=common.setopts,ownProp$2=common.ownProp,childrenIgnored$2=common.childrenIgnored,isIgnored$2=common.isIgnored;function glob(t,e,r){if("function"==typeof e&&(r=e,e={}),e||(e={}),e.sync){if(r)throw new TypeError("callback provided to sync glob");return sync$4(t,e)}return new Glob(t,e,r)}glob.sync=sync$4;var GlobSync$1=glob.GlobSync=sync$4.GlobSync;function extend(t,e){if(null===e||"object"!=typeof e)return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t}function Glob(t,e,r){if("function"==typeof e&&(r=e,e=null),e&&e.sync){if(r)throw new TypeError("callback provided to sync glob");return new GlobSync$1(t,e)}if(!(this instanceof Glob))return new Glob(t,e,r);setopts$2(this,t,e),this._didRealPath=!1;var n=this.minimatch.set.length;this.matches=new Array(n),"function"==typeof r&&(r=once_1(r),this.on("error",r),this.on("end",function(t){r(null,t)}));var i=this;if(this._processing=0,this._emitQueue=[],this._processQueue=[],this.paused=!1,this.noprocess)return this;if(0===n)return a();for(var o=!0,s=0;s<n;s++)this._process(this.minimatch.set[s],s,!1,a);function a(){--i._processing,i._processing<=0&&(o?process.nextTick(function(){i._finish()}):i._finish())}o=!1}function readdirCb(t,e,r){return function(n,i){n?t._readdirError(e,n,r):t._readdirEntries(e,i,r)}}glob.glob=glob,glob.hasMagic=function(t,e){var r=extend({},e);r.noprocess=!0;var n=new Glob(t,r).minimatch.set;if(!t)return!1;if(n.length>1)return!0;for(var i=0;i<n[0].length;i++)if("string"!=typeof n[0][i])return!0;return!1},glob.Glob=Glob,inherits(Glob,EE),Glob.prototype._finish=function(){if(invariant(this instanceof Glob),!this.aborted){if(this.realpath&&!this._didRealpath)return this._realpath();common.finish(this),this.emit("end",this.found)}},Glob.prototype._realpath=function(){if(!this._didRealpath){this._didRealpath=!0;var t=this.matches.length;if(0===t)return this._finish();for(var e=this,r=0;r<this.matches.length;r++)this._realpathSet(r,n)}function n(){0==--t&&e._finish()}},Glob.prototype._realpathSet=function(t,e){var r=this.matches[t];if(!r)return e();var n=Object.keys(r),i=this,o=n.length;if(0===o)return e();var s=this.matches[t]=Object.create(null);n.forEach(function(r,n){r=i._makeAbs(r),fs_realpath.realpath(r,i.realpathCache,function(n,a){n?"stat"===n.syscall?s[r]=!0:i.emit("error",n):s[a]=!0,0==--o&&(i.matches[t]=s,e())})})},Glob.prototype._mark=function(t){return common.mark(this,t)},Glob.prototype._makeAbs=function(t){return common.makeAbs(this,t)},Glob.prototype.abort=function(){this.aborted=!0,this.emit("abort")},Glob.prototype.pause=function(){this.paused||(this.paused=!0,this.emit("pause"))},Glob.prototype.resume=function(){if(this.paused){if(this.emit("resume"),this.paused=!1,this._emitQueue.length){var t=this._emitQueue.slice(0);this._emitQueue.length=0;for(var e=0;e<t.length;e++){var r=t[e];this._emitMatch(r[0],r[1])}}if(this._processQueue.length){var n=this._processQueue.slice(0);this._processQueue.length=0;for(e=0;e<n.length;e++){var i=n[e];this._processing--,this._process(i[0],i[1],i[2],i[3])}}}},Glob.prototype._process=function(t,e,r,n){if(invariant(this instanceof Glob),invariant("function"==typeof n),!this.aborted)if(this._processing++,this.paused)this._processQueue.push([t,e,r,n]);else{for(var i,o=0;"string"==typeof t[o];)o++;switch(o){case t.length:return void this._processSimple(t.join("/"),e,n);case 0:i=null;break;default:i=t.slice(0,o).join("/")}var s,a=t.slice(o);null===i?s=".":pathIsAbsolute(i)||pathIsAbsolute(t.join("/"))?(i&&pathIsAbsolute(i)||(i="/"+i),s=i):s=i;var c=this._makeAbs(s);if(childrenIgnored$2(this,s))return n();a[0]===minimatch_1.GLOBSTAR?this._processGlobStar(i,s,c,a,e,r,n):this._processReaddir(i,s,c,a,e,r,n)}},Glob.prototype._processReaddir=function(t,e,r,n,i,o,s){var a=this;this._readdir(r,o,function(c,u){return a._processReaddir2(t,e,r,n,i,o,u,s)})},Glob.prototype._processReaddir2=function(t,e,r,n,i,o,s,a){if(!s)return a();for(var c=n[0],u=!!this.minimatch.negate,l=c._glob,h=this.dot||"."===l.charAt(0),p=[],f=0;f<s.length;f++){if("."!==(d=s[f]).charAt(0)||h)(u&&!t?!d.match(c):d.match(c))&&p.push(d)}var b=p.length;if(0===b)return a();if(1===n.length&&!this.mark&&!this.stat){this.matches[i]||(this.matches[i]=Object.create(null));for(f=0;f<b;f++){var d=p[f];t&&(d="/"!==t?t+"/"+d:t+d),"/"!==d.charAt(0)||this.nomount||(d=path$1__default.join(this.root,d)),this._emitMatch(i,d)}return a()}n.shift();for(f=0;f<b;f++){d=p[f];t&&(d="/"!==t?t+"/"+d:t+d),this._process([d].concat(n),i,o,a)}a()},Glob.prototype._emitMatch=function(t,e){if(!this.aborted&&!isIgnored$2(this,e))if(this.paused)this._emitQueue.push([t,e]);else{var r=pathIsAbsolute(e)?e:this._makeAbs(e);if(this.mark&&(e=this._mark(e)),this.absolute&&(e=r),!this.matches[t][e]){if(this.nodir){var n=this.cache[r];if("DIR"===n||Array.isArray(n))return}this.matches[t][e]=!0;var i=this.statCache[r];i&&this.emit("stat",e,i),this.emit("match",e)}}},Glob.prototype._readdirInGlobStar=function(t,e){if(!this.aborted){if(this.follow)return this._readdir(t,!1,e);var r=this,n=inflight_1("lstat\0"+t,function(n,i){if(n&&"ENOENT"===n.code)return e();var o=i&&i.isSymbolicLink();r.symlinks[t]=o,o||!i||i.isDirectory()?r._readdir(t,!1,e):(r.cache[t]="FILE",e())});n&&fs.lstat(t,n)}},Glob.prototype._readdir=function(t,e,r){if(!this.aborted&&(r=inflight_1("readdir\0"+t+"\0"+e,r))){if(e&&!ownProp$2(this.symlinks,t))return this._readdirInGlobStar(t,r);if(ownProp$2(this.cache,t)){var n=this.cache[t];if(!n||"FILE"===n)return r();if(Array.isArray(n))return r(null,n)}fs.readdir(t,readdirCb(this,t,r))}},Glob.prototype._readdirEntries=function(t,e,r){if(!this.aborted){if(!this.mark&&!this.stat)for(var n=0;n<e.length;n++){var i=e[n];i="/"===t?t+i:t+"/"+i,this.cache[i]=!0}return this.cache[t]=e,r(null,e)}},Glob.prototype._readdirError=function(t,e,r){if(!this.aborted){switch(e.code){case"ENOTSUP":case"ENOTDIR":var n=this._makeAbs(t);if(this.cache[n]="FILE",n===this.cwdAbs){var i=new Error(e.code+" invalid cwd "+this.cwd);i.path=this.cwd,i.code=e.code,this.emit("error",i),this.abort()}break;case"ENOENT":case"ELOOP":case"ENAMETOOLONG":case"UNKNOWN":this.cache[this._makeAbs(t)]=!1;break;default:this.cache[this._makeAbs(t)]=!1,this.strict&&(this.emit("error",e),this.abort()),this.silent||console.error("glob error",e)}return r()}},Glob.prototype._processGlobStar=function(t,e,r,n,i,o,s){var a=this;this._readdir(r,o,function(c,u){a._processGlobStar2(t,e,r,n,i,o,u,s)})},Glob.prototype._processGlobStar2=function(t,e,r,n,i,o,s,a){if(!s)return a();var c=n.slice(1),u=t?[t]:[],l=u.concat(c);this._process(l,i,!1,a);var h=this.symlinks[r],p=s.length;if(h&&o)return a();for(var f=0;f<p;f++){if("."!==s[f].charAt(0)||this.dot){var b=u.concat(s[f],c);this._process(b,i,!0,a);var d=u.concat(s[f],n);this._process(d,i,!0,a)}}a()},Glob.prototype._processSimple=function(t,e,r){var n=this;this._stat(t,function(i,o){n._processSimple2(t,e,i,o,r)})},Glob.prototype._processSimple2=function(t,e,r,n,i){if(this.matches[e]||(this.matches[e]=Object.create(null)),!n)return i();if(t&&pathIsAbsolute(t)&&!this.nomount){var o=/[\/\\]$/.test(t);"/"===t.charAt(0)?t=path$1__default.join(this.root,t):(t=path$1__default.resolve(this.root,t),o&&(t+="/"))}"win32"===process.platform&&(t=t.replace(/\\/g,"/")),this._emitMatch(e,t),i()},Glob.prototype._stat=function(t,e){var r=this._makeAbs(t),n="/"===t.slice(-1);if(t.length>this.maxLength)return e();if(!this.stat&&ownProp$2(this.cache,r)){var i=this.cache[r];if(Array.isArray(i)&&(i="DIR"),!n||"DIR"===i)return e(null,i);if(n&&"FILE"===i)return e()}var o=this.statCache[r];if(void 0!==o){if(!1===o)return e(null,o);var s=o.isDirectory()?"DIR":"FILE";return n&&"FILE"===s?e():e(null,s,o)}var a=this,c=inflight_1("stat\0"+r,function(n,i){if(i&&i.isSymbolicLink())return fs.stat(r,function(n,o){n?a._stat2(t,r,null,i,e):a._stat2(t,r,n,o,e)});a._stat2(t,r,n,i,e)});c&&fs.lstat(r,c)},Glob.prototype._stat2=function(t,e,r,n,i){if(r&&("ENOENT"===r.code||"ENOTDIR"===r.code))return this.statCache[e]=!1,i();var o="/"===t.slice(-1);if(this.statCache[e]=n,"/"===e.slice(-1)&&n&&!n.isDirectory())return i(null,!1,n);var s=!0;return n&&(s=n.isDirectory()?"DIR":"FILE"),this.cache[e]=this.cache[e]||s,o&&"FILE"===s?i():i(null,s,n)};var rimraf_1=rimraf;rimraf.sync=rimrafSync;var _0666=parseInt("666",8),defaultGlobOpts={nosort:!0,silent:!0},timeout$1=0,isWindows$2="win32"===process.platform;function defaults(t){["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(function(e){t[e]=t[e]||fs[e],t[e+="Sync"]=t[e]||fs[e]}),t.maxBusyTries=t.maxBusyTries||3,t.emfileWait=t.emfileWait||1e3,!1===t.glob&&(t.disableGlob=!0),t.disableGlob=t.disableGlob||!1,t.glob=t.glob||defaultGlobOpts}function rimraf(t,e,r){"function"==typeof e&&(r=e,e={}),invariant(t,"rimraf: missing path"),invariant.equal(typeof t,"string","rimraf: path should be a string"),invariant.equal(typeof r,"function","rimraf: callback function required"),invariant(e,"rimraf: invalid options argument provided"),invariant.equal(typeof e,"object","rimraf: options should be object"),defaults(e);var n=0,i=null,o=0;if(e.disableGlob||!glob_1.hasMagic(t))return s(null,[t]);function s(t,s){return t?r(t):0===(o=s.length)?r():void s.forEach(function(t){rimraf_(t,e,function s(a){if(a){if(("EBUSY"===a.code||"ENOTEMPTY"===a.code||"EPERM"===a.code)&&n<e.maxBusyTries)return n++,setTimeout(function(){rimraf_(t,e,s)},100*n);if("EMFILE"===a.code&&timeout$1<e.emfileWait)return setTimeout(function(){rimraf_(t,e,s)},timeout$1++);"ENOENT"===a.code&&(a=null)}timeout$1=0,function(t){i=i||t,0==--o&&r(i)}(a)})})}e.lstat(t,function(r,n){if(!r)return s(null,[t]);glob_1(t,e.glob,s)})}function rimraf_(t,e,r){invariant(t),invariant(e),invariant("function"==typeof r),e.lstat(t,function(n,i){return n&&"ENOENT"===n.code?r(null):(n&&"EPERM"===n.code&&isWindows$2&&fixWinEPERM(t,e,n,r),i&&i.isDirectory()?rmdir(t,e,n,r):void e.unlink(t,function(n){if(n){if("ENOENT"===n.code)return r(null);if("EPERM"===n.code)return isWindows$2?fixWinEPERM(t,e,n,r):rmdir(t,e,n,r);if("EISDIR"===n.code)return rmdir(t,e,n,r)}return r(n)}))})}function fixWinEPERM(t,e,r,n){invariant(t),invariant(e),invariant("function"==typeof n),r&&invariant(r instanceof Error),e.chmod(t,_0666,function(i){i?n("ENOENT"===i.code?null:r):e.stat(t,function(i,o){i?n("ENOENT"===i.code?null:r):o.isDirectory()?rmdir(t,e,r,n):e.unlink(t,n)})})}function fixWinEPERMSync(t,e,r){invariant(t),invariant(e),r&&invariant(r instanceof Error);try{e.chmodSync(t,_0666)}catch(t){if("ENOENT"===t.code)return;throw r}try{var n=e.statSync(t)}catch(t){if("ENOENT"===t.code)return;throw r}n.isDirectory()?rmdirSync(t,e,r):e.unlinkSync(t)}function rmdir(t,e,r,n){invariant(t),invariant(e),r&&invariant(r instanceof Error),invariant("function"==typeof n),e.rmdir(t,function(i){!i||"ENOTEMPTY"!==i.code&&"EEXIST"!==i.code&&"EPERM"!==i.code?i&&"ENOTDIR"===i.code?n(r):n(i):rmkids(t,e,n)})}function rmkids(t,e,r){invariant(t),invariant(e),invariant("function"==typeof r),e.readdir(t,function(n,i){if(n)return r(n);var o,s=i.length;if(0===s)return e.rmdir(t,r);i.forEach(function(n){rimraf(path$1__default.join(t,n),e,function(n){if(!o)return n?r(o=n):void(0==--s&&e.rmdir(t,r))})})})}function rimrafSync(t,e){var r;if(defaults(e=e||{}),invariant(t,"rimraf: missing path"),invariant.equal(typeof t,"string","rimraf: path should be a string"),invariant(e,"rimraf: missing options"),invariant.equal(typeof e,"object","rimraf: options should be object"),e.disableGlob||!glob_1.hasMagic(t))r=[t];else try{e.lstatSync(t),r=[t]}catch(n){r=glob_1.sync(t,e.glob)}if(r.length)for(var n=0;n<r.length;n++){t=r[n];try{var i=e.lstatSync(t)}catch(r){if("ENOENT"===r.code)return;"EPERM"===r.code&&isWindows$2&&fixWinEPERMSync(t,e,r)}try{i&&i.isDirectory()?rmdirSync(t,e,null):e.unlinkSync(t)}catch(r){if("ENOENT"===r.code)return;if("EPERM"===r.code)return isWindows$2?fixWinEPERMSync(t,e,r):rmdirSync(t,e,r);if("EISDIR"!==r.code)throw r;rmdirSync(t,e,r)}}}function rmdirSync(t,e,r){invariant(t),invariant(e),r&&invariant(r instanceof Error);try{e.rmdirSync(t)}catch(n){if("ENOENT"===n.code)return;if("ENOTDIR"===n.code)throw r;"ENOTEMPTY"!==n.code&&"EEXIST"!==n.code&&"EPERM"!==n.code||rmkidsSync(t,e)}}function rmkidsSync(t,e){invariant(t),invariant(e),e.readdirSync(t).forEach(function(r){rimrafSync(path$1__default.join(t,r),e)});for(var r=isWindows$2?100:1,n=0;;){var i=!0;try{var o=e.rmdirSync(t,e);return i=!1,o}finally{if(++n<r&&i)continue}}}var fsPlus=createCommonjsModule(function(t){(function(){var e,r,n,i,o,s,a,c,u,l,h,p,f,b,d,m,v,y=[].slice;o=module$1,b=path$1__default,v=underscorePlus,s=async$1,f=mkdirp,d=rimraf_1,c={getHomeDirectory:function(){return"win32"===process.platform?process.env.USERPROFILE:process.env.HOME},absolute:function(t){if(null==t)return null;t=c.resolveHome(t);try{return a.realpathSync(t)}catch(e){return t}},normalize:function(t){return null==t?null:c.resolveHome(b.normalize(t.toString()))},resolveHome:function(t){return"~"===t?c.getHomeDirectory():0===t.indexOf("~"+b.sep)?""+c.getHomeDirectory()+t.substring(1):t},tildify:function(t){var e,r;return"win32"===process.platform?t:(r=c.normalize(t))===(e=c.getHomeDirectory())?"~":r.startsWith(b.join(e,b.sep))?b.join("~",b.sep,r.substring(e.length+1)):t},getAppDataDirectory:function(){switch(process.platform){case"darwin":return c.absolute(b.join("~","Library","Application Support"));case"linux":return"/var/lib";case"win32":return process.env.APPDATA;default:return null}},isAbsolute:function(t){return null==t&&(t=""),"win32"!==process.platform?"/"===t[0]:":"===t[1]||"\\"===t[0]&&"\\"===t[1]},existsSync:function(t){return h(t)&&!1!==m(t)},isDirectorySync:function(t){var e;return!!h(t)&&(!!(e=m(t))&&e.isDirectory())},isDirectory:function(t,e){return h(t)?a.stat(t,function(t,r){return e(null==t&&r.isDirectory())}):e(!1)},isFileSync:function(t){var e;return!!h(t)&&(!!(e=m(t))&&e.isFile())},isSymbolicLinkSync:function(t){var e;return!!h(t)&&(!!(e=p(t))&&e.isSymbolicLink())},isSymbolicLink:function(t,e){return h(t)?a.lstat(t,function(t,r){return"function"==typeof e?e(null!=r&&r.isSymbolicLink()):void 0}):process.nextTick(function(){return"function"==typeof e?e(!1):void 0})},isExecutableSync:function(t){var e;return!!h(t)&&(!!(e=m(t))&&0!=(1&e.mode))},getSizeSync:function(t){var e;return h(t)&&null!=(e=m(t).size)?e:-1},listSync:function(t,e){var r;return c.isDirectorySync(t)?(r=a.readdirSync(t),e&&(r=c.filterExtensions(r,e)),r=(r=r.sort(function(t,e){return t.toLowerCase().localeCompare(e.toLowerCase())})).map(function(e){return b.join(t,e)})):[]},list:function(){var t,e,r,n;return n=arguments[0],(r=2<=arguments.length?y.call(arguments,1):[]).length>1&&(e=r.shift()),t=r.shift(),a.readdir(n,function(r,i){return null!=r?t(r):(e&&(i=c.filterExtensions(i,e)),i=(i=i.sort(function(t,e){return t.toLowerCase().localeCompare(e.toLowerCase())})).map(function(t){return b.join(n,t)}),t(null,i))})},filterExtensions:function(t,e){return e=e.map(function(t){return""===t?t:"."+t.replace(/^\./,"")}),t.filter(function(t){return v.include(e,b.extname(t))})},listTreeSync:function(t){var e,r;return r=[],e=function(t){return r.push(t),!0},c.traverseTreeSync(t,e,e),r},move:function(t,e,r){return u(t,e,function(n,i){var o,s;if(!n)return i?(s=b.dirname(e),a.exists(s,function(n){if(!n)return c.makeTree(s,function(n){if(!n)return a.rename(t,e,r);r(n)});a.rename(t,e,r)})):((o=new Error("'"+e+"' already exists.")).code="EEXIST",void r(o));r(n)})},moveSync:function(t,e){var r,n;if(!l(t,e))throw(r=new Error("'"+e+"' already exists.")).code="EEXIST",r;return n=b.dirname(e),a.existsSync(n)||c.makeTreeSync(n),a.renameSync(t,e)},removeSync:function(t){return d.sync(t)},remove:function(t,e){return d(t,e)},writeFileSync:function(t,e,r){return f.sync(b.dirname(t)),a.writeFileSync(t,e,r)},writeFile:function(t,e,r,n){return n=v.last(arguments),f(b.dirname(t),function(i){return null!=i?"function"==typeof n?n(i):void 0:a.writeFile(t,e,r,n)})},copy:function(t,e,r){return f(b.dirname(e),function(n){var i,o;if(null==n)return(o=a.createReadStream(t)).on("error",function(t){return"function"==typeof r&&r(t),r=null}),(i=a.createWriteStream(e)).on("error",function(t){return"function"==typeof r&&r(t),r=null}),i.on("close",function(){return"function"==typeof r&&r(),r=null}),o.pipe(i);"function"==typeof r&&r(n)})},copySync:function(t,e){var r,n,i,o,s,u,l;for(o=a.readdirSync(t),f.sync(e),l=[],s=0,u=o.length;s<u;s++)n=o[s],i=b.join(t,n),r=b.join(e,n),c.isDirectorySync(i)?l.push(c.copySync(i,r)):l.push(c.copyFileSync(i,r));return l},copyFileSync:function(t,e,r){var n,i,o,s,c,u;null==r&&(r=16384),f.sync(b.dirname(e)),s=null,c=null;try{for(s=a.openSync(t,"r"),c=a.openSync(e,"w"),i=1,o=0,u=[];i>0;)n=new Buffer(r),i=a.readSync(s,n,0,n.length,o),a.writeSync(c,n,0,i,o),u.push(o+=i);return u}finally{null!=s&&a.closeSync(s),null!=c&&a.closeSync(c)}},makeTreeSync:function(t){if(!c.isDirectorySync(t))return f.sync(t)},makeTree:function(t,e){return c.isDirectory(t,function(r){return r?"function"==typeof e?e():void 0:f(t,function(t){return"function"==typeof e?e(t):void 0})})},traverseTreeSync:function(t,e,r){var n;if(null==r&&(r=e),c.isDirectorySync(t))return(n=function(t,e,r){var i,o,s,c,u,l,h;for(u=0,l=(h=a.readdirSync(t)).length;u<l;u++)o=h[u],i=b.join(t,o),(c=a.lstatSync(i)).isSymbolicLink()&&(s=m(i))&&(c=s),c.isDirectory()?r(i)&&n(i,e,r):c.isFile()&&e(i)})(t,e,r)},traverseTree:function(t,e,r,n){return a.readdir(t,function(i,o){var c,u,l,h,p;if(i)return"function"==typeof n?n():void 0;for((u=s.queue(function(t,n){return a.stat(t,function(i,o){return i?n(i):o.isFile()?(e(t),n()):o.isDirectory()&&r(t)?a.readdir(t,function(e,r){var i,o,s;if(e)return n(e);for(o=0,s=r.length;o<s;o++)i=r[o],u.unshift(b.join(t,i));return n()}):n()})})).concurrency=1,u.drain=n,p=[],l=0,h=o.length;l<h;l++)c=o[l],p.push(u.push(b.join(t,c)));return p})},md5ForPath:function(t){var e;return e=a.readFileSync(t),crypto.createHash("md5").update(e).digest("hex")},resolve:function(){var t,e,r,n,i,o,s,a,u,l;if(t=1<=arguments.length?y.call(arguments,0):[],v.isArray(v.last(t))&&(r=t.pop()),o=null!=(l=t.pop())?l.toString():void 0,i=t,o){if(c.isAbsolute(o)){if(r&&(s=c.resolveExtension(o,r)))return s;if(c.existsSync(o))return o}for(a=0,u=i.length;a<u;a++)if(n=i[a],e=b.join(n,o),r){if(s=c.resolveExtension(e,r))return s}else if(c.existsSync(e))return c.absolute(e)}},resolveOnLoadPath:function(){var e,r;return e=1<=arguments.length?y.call(arguments,0):[],r=o.globalPaths.concat(t.paths),c.resolve.apply(c,y.call(r).concat(y.call(e)))},resolveExtension:function(t,e){var r,n,i,o;for(i=0,o=e.length;i<o;i++)if(""===(r=e[i])){if(c.existsSync(t))return c.absolute(t)}else if(n=t+"."+r.replace(/^\./,""),c.existsSync(n))return c.absolute(n)},isCompressedExtension:function(t){return null!=t&&r.hasOwnProperty(t.toLowerCase())},isImageExtension:function(t){return null!=t&&n.hasOwnProperty(t.toLowerCase())},isPdfExtension:function(t){return".pdf"===(null!=t?t.toLowerCase():void 0)},isBinaryExtension:function(t){return null!=t&&e.hasOwnProperty(t.toLowerCase())},isReadmePath:function(t){var e;return e=b.extname(t),"readme"===b.basename(t,e).toLowerCase()&&(""===e||c.isMarkdownExtension(e))},isMarkdownExtension:function(t){return null!=t&&i.hasOwnProperty(t.toLowerCase())},isCaseInsensitive:function(){var t,e;return null==c.caseInsensitiveFs&&(t=m(process.execPath.toLowerCase()),e=m(process.execPath.toUpperCase()),c.caseInsensitiveFs=!(!t||!e)&&(t.dev===e.dev&&t.ino===e.ino)),c.caseInsensitiveFs},isCaseSensitive:function(){return!c.isCaseInsensitive()}},m=(a=fs).statSyncNoException,p=a.lstatSyncNoException,null==m&&(m=function(){var t;t=1<=arguments.length?y.call(arguments,0):[];try{return a.statSync.apply(a,t)}catch(t){return!1}}),null==p&&(p=function(){var t;t=1<=arguments.length?y.call(arguments,0):[];try{return a.lstatSync.apply(a,t)}catch(t){return!1}}),e={".ds_store":!0,".a":!0,".exe":!0,".o":!0,".pyc":!0,".pyo":!0,".so":!0,".woff":!0},r={".bz2":!0,".egg":!0,".epub":!0,".gem":!0,".gz":!0,".jar":!0,".lz":!0,".lzma":!0,".lzo":!0,".rar":!0,".tar":!0,".tgz":!0,".war":!0,".whl":!0,".xpi":!0,".xz":!0,".z":!0,".zip":!0},n={".gif":!0,".ico":!0,".jpeg":!0,".jpg":!0,".png":!0,".tif":!0,".tiff":!0,".webp":!0},i={".markdown":!0,".md":!0,".mdown":!0,".mkd":!0,".mkdown":!0,".rmd":!0,".ron":!0},h=function(t){return null!=t&&"string"==typeof t&&t.length>0},u=function(t,e,r){return a.stat(t,function(n,i){if(!n)return a.stat(e,function(n,o){if(!n||"ENOENT"!==n.code)return r(void 0,t.toLowerCase()===e.toLowerCase()&&i.dev===o.dev&&i.ino===o.ino);r(void 0,!0)});r(n)})},l=function(t,e){var r,n;return n=m(t),r=m(e),!n||!r||t.toLowerCase()===e.toLowerCase()&&n.dev===r.dev&&n.ino===r.ino},t.exports=v.extend({},a,c)}).call(commonjsGlobal)}),temp=createCommonjsModule(function(t,e){var r=rimraf_1.sync,n=constants.O_CREAT|constants.O_TRUNC|constants.O_RDWR|constants.O_EXCL,i=function(t,r){var n=o(t,r),i=new Date,s=[n.prefix,i.getFullYear(),i.getMonth(),i.getDate(),"-",process.pid,"-",(4294967296*Math.random()+1).toString(36),n.suffix].join("");return path$1__default.join(n.dir||e.dir,s)},o=function(t,e){var r={prefix:null,suffix:null};if(t)switch(typeof t){case"string":r.prefix=t;break;case"object":r=t;break;default:throw new Error("Unknown affix declaration: "+r)}else r.prefix=e;return r},s=!1,a=!1,c=[],u=[];function l(t){if(!s)return!1;p(),c.push(t)}function h(t){if(!s)return!1;p(),u.push(t)}function p(){if(!s)return!1;a||(process.addListener("exit",f),a=!0)}function f(){return!!s&&{files:function(){if(!s)return!1;for(var t,e=0;void 0!==(t=c.shift());)r(t),e++;return e}(),dirs:function(){if(!s)return!1;for(var t,e=0;void 0!==(t=u.shift());)r(t),e++;return e}()}}e.dir=path$1__default.resolve(os.tmpdir()),e.track=function(e){return s=!1!==e,t.exports},e.mkdir=function(t,e){var r=i(t,"d-");fs.mkdir(r,parseInt("0700",8),function(t){t||h(r),e&&e(t,r)})},e.mkdirSync=function(t){var e=i(t,"d-");return fs.mkdirSync(e,parseInt("0700",8)),h(e),e},e.open=function(t,e){var r=i(t,"f-");fs.open(r,n,parseInt("0600",8),function(t,n){t||l(r),e&&e(t,{path:r,fd:n})})},e.openSync=function(t){var e=i(t,"f-"),r=fs.openSync(e,n,parseInt("0600",8));return l(e),{path:e,fd:r}},e.path=i,e.cleanup=function(t){s?function(t){if(s){var e=0,r=c.length;if(r)for(var n,i=function(n){if(r){if(n)return t&&t(n),void(r=0);e++,!--r&&t&&t(null,e)}};void 0!==(n=c.shift());)rimraf_1(n,i);else t&&t(null,e)}else t&&t(new Error("not tracking"))}(function(e,r){e?t&&t(e,{files:r}):function(t){if(s){var e=u.length;if(e)for(var r,n=function(r){if(e){if(r)return t&&t(r,0),void(e=0);!--e&&t&&t(null,0)}};void 0!==(r=u.shift());)rimraf_1(r,n);else t&&t(null,0)}else t&&t(new Error("not tracking"))}(function(e,n){t&&t(e,{files:r,dirs:n})})}):t&&t(new Error("not tracking"))},e.cleanupSync=f,e.createWriteStream=function(t){var e=i(t,"s-"),r=fs.createWriteStream(e,{flags:n,mode:parseInt("0600",8)});return l(e),r}}),temp_1=temp.dir,temp_2=temp.track,temp_3=temp.mkdir,temp_4=temp.mkdirSync,temp_5=temp.open,temp_6=temp.openSync,temp_7=temp.path,temp_8=temp.cleanup,temp_9=temp.cleanupSync,temp_10=temp.createWriteStream;function tempdir(t=""){return new Promise((e,r)=>{temp.mkdir(t,(t,n)=>{t?r(t):e(n)})})}function tempfile(t){return new Promise((e,r)=>{temp.open(t,(t,n)=>{t?r(t):fsPlus.close(n.fd,t=>{t?r(t):e(n.path)})})})}async function findNearestFile(t,e){let r=nuclideUri.resolve(e);for(;;){const e=nuclideUri.join(r,t);if(await exists(e))return r;if(nuclideUri.isRoot(r))return null;r=nuclideUri.dirname(r)}}async function findFurthestFile(t,e,r=!1){let n=nuclideUri.resolve(e),i=null;for(;;){const e=nuclideUri.join(n,t),o=await exists(e);if(!o&&r||nuclideUri.isRoot(n))return i;o&&(i=n),n=nuclideUri.dirname(n)}}function getCommonAncestorDirectory(t){let e=nuclideUri.dirname(t[0]);for(;t.some(t=>!t.startsWith(e));)e=nuclideUri.dirname(e);return e}function exists(t){return new Promise((e,r)=>{fsPlus.exists(t,e)})}async function mkdirp$1(t){return!await exists(t)&&new Promise((e,r)=>{mkdirp(t,t=>{t?r(t):e(!0)})})}async function rmdir$1(t){return new Promise((e,r)=>{rimraf_1(t,t=>{t?r(t):e()})})}async function isNfs(t){if("linux"===process.platform||"darwin"===process.platform){const{stdout:e,exitCode:r}=await asyncExecute("stat",["-f","-L","-c","%T",t]);return 0===r&&"nfs"===e.trim()}return!1}function _denodeifyFsMethod(t){return function(...e){const r=fsPlus[t];return new Promise((t,n)=>{r.apply(fsPlus,e.concat([(e,r)=>e?n(e):t(r)]))})}}var fsPromise={tempdir:tempdir,tempfile:tempfile,findNearestFile:findNearestFile,findFurthestFile:findFurthestFile,getCommonAncestorDirectory:getCommonAncestorDirectory,exists:exists,mkdirp:mkdirp$1,rmdir:rmdir$1,isNfs:isNfs,copy:_denodeifyFsMethod("copy"),chmod:_denodeifyFsMethod("chmod"),lstat:_denodeifyFsMethod("lstat"),mkdir:_denodeifyFsMethod("mkdir"),readdir:_denodeifyFsMethod("readdir"),readFile:_denodeifyFsMethod("readFile"),readlink:_denodeifyFsMethod("readlink"),realpath:_denodeifyFsMethod("realpath"),rename:_denodeifyFsMethod("rename"),move:_denodeifyFsMethod("move"),stat:_denodeifyFsMethod("stat"),symlink:_denodeifyFsMethod("symlink"),unlink:_denodeifyFsMethod("unlink"),writeFile:_denodeifyFsMethod("writeFile")},hasOwnProperty=Object.prototype.hasOwnProperty,pseudomap=PseudoMap;function PseudoMap(t){if(!(this instanceof PseudoMap))throw new TypeError("Constructor PseudoMap requires 'new'");if(this.clear(),t)if(t instanceof PseudoMap||"function"==typeof Map&&t instanceof Map)t.forEach(function(t,e){this.set(e,t)},this);else{if(!Array.isArray(t))throw new TypeError("invalid argument");t.forEach(function(t){this.set(t[0],t[1])},this)}}function same(t,e){return t===e||t!=t&&e!=e}function Entry(t,e,r){this.key=t,this.value=e,this._index=r}function find$1(t,e){for(var r=0,n="_"+e,i=n;hasOwnProperty.call(t,i);i=n+r++)if(same(t[i].key,e))return t[i]}function set(t,e,r){for(var n=0,i="_"+e,o=i;hasOwnProperty.call(t,o);o=i+n++)if(same(t[o].key,e))return void(t[o].value=r);t.size++,t[o]=new Entry(e,r,o)}PseudoMap.prototype.forEach=function(t,e){e=e||this,Object.keys(this._data).forEach(function(r){"size"!==r&&t.call(e,this._data[r].value,this._data[r].key)},this)},PseudoMap.prototype.has=function(t){return!!find$1(this._data,t)},PseudoMap.prototype.get=function(t){var e=find$1(this._data,t);return e&&e.value},PseudoMap.prototype.set=function(t,e){set(this._data,t,e)},PseudoMap.prototype.delete=function(t){var e=find$1(this._data,t);e&&(delete this._data[e._index],this._data.size--)},PseudoMap.prototype.clear=function(){var t=Object.create(null);t.size=0,Object.defineProperty(this,"_data",{value:t,enumerable:!1,configurable:!0,writable:!1})},Object.defineProperty(PseudoMap.prototype,"size",{get:function(){return this._data.size},set:function(t){},enumerable:!0,configurable:!0}),PseudoMap.prototype.values=PseudoMap.prototype.keys=PseudoMap.prototype.entries=function(){throw new Error("iterators are not implemented in this version")};var map$1=createCommonjsModule(function(t){"pseudomap"===process.env.npm_package_name&&"test"===process.env.npm_lifecycle_script&&(process.env.TEST_PSEUDOMAP="true"),"function"!=typeof Map||process.env.TEST_PSEUDOMAP?t.exports=pseudomap:t.exports=Map}),yallist=Yallist;function Yallist(t){var e=this;if(e instanceof Yallist||(e=new Yallist),e.tail=null,e.head=null,e.length=0,t&&"function"==typeof t.forEach)t.forEach(function(t){e.push(t)});else if(arguments.length>0)for(var r=0,n=arguments.length;r<n;r++)e.push(arguments[r]);return e}function push(t,e){t.tail=new Node(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function unshift(t,e){t.head=new Node(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function Node(t,e,r,n){if(!(this instanceof Node))return new Node(t,e,r,n);this.list=n,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}Yallist.Node=Node,Yallist.create=Yallist,Yallist.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,r=t.prev;e&&(e.prev=r),r&&(r.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=r),t.list.length--,t.next=null,t.prev=null,t.list=null},Yallist.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}},Yallist.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}},Yallist.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)push(this,arguments[t]);return this.length},Yallist.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)unshift(this,arguments[t]);return this.length},Yallist.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}},Yallist.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}},Yallist.prototype.forEach=function(t,e){e=e||this;for(var r=this.head,n=0;null!==r;n++)t.call(e,r.value,n,this),r=r.next},Yallist.prototype.forEachReverse=function(t,e){e=e||this;for(var r=this.tail,n=this.length-1;null!==r;n--)t.call(e,r.value,n,this),r=r.prev},Yallist.prototype.get=function(t){for(var e=0,r=this.head;null!==r&&e<t;e++)r=r.next;if(e===t&&null!==r)return r.value},Yallist.prototype.getReverse=function(t){for(var e=0,r=this.tail;null!==r&&e<t;e++)r=r.prev;if(e===t&&null!==r)return r.value},Yallist.prototype.map=function(t,e){e=e||this;for(var r=new Yallist,n=this.head;null!==n;)r.push(t.call(e,n.value,this)),n=n.next;return r},Yallist.prototype.mapReverse=function(t,e){e=e||this;for(var r=new Yallist,n=this.tail;null!==n;)r.push(t.call(e,n.value,this)),n=n.prev;return r},Yallist.prototype.reduce=function(t,e){var r,n=this.head;if(arguments.length>1)r=e;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,r=this.head.value}for(var i=0;null!==n;i++)r=t(r,n.value,i),n=n.next;return r},Yallist.prototype.reduceReverse=function(t,e){var r,n=this.tail;if(arguments.length>1)r=e;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,r=this.tail.value}for(var i=this.length-1;null!==n;i--)r=t(r,n.value,i),n=n.prev;return r},Yallist.prototype.toArray=function(){for(var t=new Array(this.length),e=0,r=this.head;null!==r;e++)t[e]=r.value,r=r.next;return t},Yallist.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,r=this.tail;null!==r;e++)t[e]=r.value,r=r.prev;return t},Yallist.prototype.slice=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var r=new Yallist;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var n=0,i=this.head;null!==i&&n<t;n++)i=i.next;for(;null!==i&&n<e;n++,i=i.next)r.push(i.value);return r},Yallist.prototype.sliceReverse=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var r=new Yallist;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var n=this.length,i=this.tail;null!==i&&n>e;n--)i=i.prev;for(;null!==i&&n>t;n--,i=i.prev)r.push(i.value);return r},Yallist.prototype.reverse=function(){for(var t=this.head,e=this.tail,r=t;null!==r;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=e,this.tail=t,this};var makeSymbol,lruCache=LRUCache,symbols={},hasSymbol="function"==typeof Symbol;function priv(t,e,r){var n;return symbols[e]?n=symbols[e]:(n=makeSymbol(e),symbols[e]=n),2===arguments.length?t[n]:(t[n]=r,r)}function naiveLength(){return 1}function LRUCache(t){if(!(this instanceof LRUCache))return new LRUCache(t);"number"==typeof t&&(t={max:t}),t||(t={});var e=priv(this,"max",t.max);(!e||"number"!=typeof e||e<=0)&&priv(this,"max",1/0);var r=t.length||naiveLength;"function"!=typeof r&&(r=naiveLength),priv(this,"lengthCalculator",r),priv(this,"allowStale",t.stale||!1),priv(this,"maxAge",t.maxAge||0),priv(this,"dispose",t.dispose),this.reset()}function forEachStep(t,e,r,n){var i=r.value;isStale(t,i)&&(del(t,r),priv(t,"allowStale")||(i=void 0)),i&&e.call(n,i.value,i.key,t)}function get(t,e,r){var n=priv(t,"cache").get(e);if(n){var i=n.value;isStale(t,i)?(del(t,n),priv(t,"allowStale")||(i=void 0)):r&&priv(t,"lruList").unshiftNode(n),i&&(i=i.value)}return i}function isStale(t,e){if(!e||!e.maxAge&&!priv(t,"maxAge"))return!1;var r=Date.now()-e.now;return e.maxAge?r>e.maxAge:priv(t,"maxAge")&&r>priv(t,"maxAge")}function trim(t){if(priv(t,"length")>priv(t,"max"))for(var e=priv(t,"lruList").tail;priv(t,"length")>priv(t,"max")&&null!==e;){var r=e.prev;del(t,e),e=r}}function del(t,e){if(e){var r=e.value;priv(t,"dispose")&&priv(t,"dispose").call(this,r.key,r.value),priv(t,"length",priv(t,"length")-r.length),priv(t,"cache").delete(r.key),priv(t,"lruList").removeNode(e)}}function Entry$1(t,e,r,n,i){this.key=t,this.value=e,this.length=r,this.now=n,this.maxAge=i||0}function getOutputChannel(){if(global.flowOutputChannel)return global.flowOutputChannel;const t=vscode.window.createOutputChannel("Flow");return vscode.commands.registerCommand("flow.show-output",()=>t.show()),global.flowOutputChannel=t,t}makeSymbol=hasSymbol?function(t){return Symbol.for(t)}:function(t){return"_"+t},Object.defineProperty(LRUCache.prototype,"max",{set:function(t){(!t||"number"!=typeof t||t<=0)&&(t=1/0),priv(this,"max",t),trim(this)},get:function(){return priv(this,"max")},enumerable:!0}),Object.defineProperty(LRUCache.prototype,"allowStale",{set:function(t){priv(this,"allowStale",!!t)},get:function(){return priv(this,"allowStale")},enumerable:!0}),Object.defineProperty(LRUCache.prototype,"maxAge",{set:function(t){(!t||"number"!=typeof t||t<0)&&(t=0),priv(this,"maxAge",t),trim(this)},get:function(){return priv(this,"maxAge")},enumerable:!0}),Object.defineProperty(LRUCache.prototype,"lengthCalculator",{set:function(t){"function"!=typeof t&&(t=naiveLength),t!==priv(this,"lengthCalculator")&&(priv(this,"lengthCalculator",t),priv(this,"length",0),priv(this,"lruList").forEach(function(t){t.length=priv(this,"lengthCalculator").call(this,t.value,t.key),priv(this,"length",priv(this,"length")+t.length)},this)),trim(this)},get:function(){return priv(this,"lengthCalculator")},enumerable:!0}),Object.defineProperty(LRUCache.prototype,"length",{get:function(){return priv(this,"length")},enumerable:!0}),Object.defineProperty(LRUCache.prototype,"itemCount",{get:function(){return priv(this,"lruList").length},enumerable:!0}),LRUCache.prototype.rforEach=function(t,e){e=e||this;for(var r=priv(this,"lruList").tail;null!==r;){var n=r.prev;forEachStep(this,t,r,e),r=n}},LRUCache.prototype.forEach=function(t,e){e=e||this;for(var r=priv(this,"lruList").head;null!==r;){var n=r.next;forEachStep(this,t,r,e),r=n}},LRUCache.prototype.keys=function(){return priv(this,"lruList").toArray().map(function(t){return t.key},this)},LRUCache.prototype.values=function(){return priv(this,"lruList").toArray().map(function(t){return t.value},this)},LRUCache.prototype.reset=function(){priv(this,"dispose")&&priv(this,"lruList")&&priv(this,"lruList").length&&priv(this,"lruList").forEach(function(t){priv(this,"dispose").call(this,t.key,t.value)},this),priv(this,"cache",new map$1),priv(this,"lruList",new yallist),priv(this,"length",0)},LRUCache.prototype.dump=function(){return priv(this,"lruList").map(function(t){if(!isStale(this,t))return{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}},this).toArray().filter(function(t){return t})},LRUCache.prototype.dumpLru=function(){return priv(this,"lruList")},LRUCache.prototype.inspect=function(t,e){var r="LRUCache {",n=!1;priv(this,"allowStale")&&(r+="\n  allowStale: true",n=!0);var i=priv(this,"max");i&&i!==1/0&&(n&&(r+=","),r+="\n  max: "+util.inspect(i,e),n=!0);var o=priv(this,"maxAge");o&&(n&&(r+=","),r+="\n  maxAge: "+util.inspect(o,e),n=!0);var s=priv(this,"lengthCalculator");s&&s!==naiveLength&&(n&&(r+=","),r+="\n  length: "+util.inspect(priv(this,"length"),e),n=!0);var a=!1;return priv(this,"lruList").forEach(function(t){a?r+=",\n  ":(n&&(r+=",\n"),a=!0,r+="\n  ");var i=util.inspect(t.key).split("\n").join("\n  "),c={value:t.value};t.maxAge!==o&&(c.maxAge=t.maxAge),s!==naiveLength&&(c.length=t.length),isStale(this,t)&&(c.stale=!0),c=util.inspect(c,e).split("\n").join("\n  "),r+=i+" => "+c}),(a||n)&&(r+="\n"),r+="}"},LRUCache.prototype.set=function(t,e,r){var n=(r=r||priv(this,"maxAge"))?Date.now():0,i=priv(this,"lengthCalculator").call(this,e,t);if(priv(this,"cache").has(t)){if(i>priv(this,"max"))return del(this,priv(this,"cache").get(t)),!1;var o=priv(this,"cache").get(t).value;return priv(this,"dispose")&&priv(this,"dispose").call(this,t,o.value),o.now=n,o.maxAge=r,o.value=e,priv(this,"length",priv(this,"length")+(i-o.length)),o.length=i,this.get(t),trim(this),!0}var s=new Entry$1(t,e,i,n,r);return s.length>priv(this,"max")?(priv(this,"dispose")&&priv(this,"dispose").call(this,t,e),!1):(priv(this,"length",priv(this,"length")+s.length),priv(this,"lruList").unshift(s),priv(this,"cache").set(t,priv(this,"lruList").head),trim(this),!0)},LRUCache.prototype.has=function(t){return!!priv(this,"cache").has(t)&&!isStale(this,priv(this,"cache").get(t).value)},LRUCache.prototype.get=function(t){return get(this,t,!0)},LRUCache.prototype.peek=function(t){return get(this,t,!1)},LRUCache.prototype.pop=function(){var t=priv(this,"lruList").tail;return t?(del(this,t),t.value):null},LRUCache.prototype.del=function(t){del(this,priv(this,"cache").get(t))},LRUCache.prototype.load=function(t){this.reset();for(var e=Date.now(),r=t.length-1;r>=0;r--){var n=t[r],i=n.e||0;if(0===i)this.set(n.k,n.v);else{var o=i-e;o>0&&this.set(n.k,n.v,o)}}},LRUCache.prototype.prune=function(){var t=this;priv(this,"cache").forEach(function(e,r){get(t,r,!1)})};const LOG_LEVEL=Object.freeze({error:3,warn:2,info:1,trace:0,debug:0}),MAX_LEVEL_LENGTH=Object.keys(LOG_LEVEL).reduce((t,e)=>e.length>t?e.length:t,0);class Logger{constructor(t,e,r){_defineProperty(this,"_outputChannel",void 0),_defineProperty(this,"_level",void 0),_defineProperty(this,"_context",void 0),this._outputChannel=e,this._level=r,this._context=t}error(t,e){this._getLevelVal()<=LOG_LEVEL.error&&this._write("Error",t,e)}warn(t,e){this._getLevelVal()<=LOG_LEVEL.warn&&this._write("Warn",t,e)}info(t,e){this._getLevelVal()<=LOG_LEVEL.info&&this._write("Info",t,e)}debug(t,e){this._getLevelVal()<=LOG_LEVEL.debug&&this._write("Debug",t,e)}trace(t,e){this._getLevelVal()<=LOG_LEVEL.trace&&this._write("Trace",t,e)}_getLevelVal(){return LOG_LEVEL[this._level]}_write(t,e,r){let n=`[${[t.padEnd(MAX_LEVEL_LENGTH),(new Date).toLocaleTimeString(),this._context?this._context:null].filter(Boolean).join(" - ")}] ${e}`;r&&(n+=" ${JSON.stringify(data)"),this._outputChannel.appendLine(n)}}function getLogger(){return console.log(getLogLevel()),new Logger("",getOutputChannel(),getLogLevel())}const logger=getLogger(),flowConfigDirCache=lruCache({max:10,maxAge:3e4}),flowPathCache=lruCache({max:10,maxAge:3e4});function insertAutocompleteToken(t,e,r){const n=t.split("\n");let i=n[e];return i=i.substring(0,r)+"AUTO332"+i.substring(r),n[e]=i,n.join("\n")}function processAutocompleteItem(t,e){let r={description:e.type.length<80?e.type:e.type.substring(0,80)+" ...",displayText:e.name,replacementPrefix:t};const n=e.func_details;if(n){const t=n.params.map(t=>`${t.name}: ${t.type}`),i=getSnippetString(n.params.map(t=>t.name));r={...r,leftLabel:n.return_type,rightLabel:`(${t.join(", ")})`,snippet:`${e.name}(${i})`,type:"function"}}else r={...r,rightLabel:e.type,text:e.name};return r}function getSnippetString(t){return groupParamNames(t).map(t=>t.join(", ")).map((t,e)=>`\${${e+1}:${t}}`).join(", ")}function groupParamNames(t){const[e,r]=t.reduceRight(([t,e],r)=>(isOptional(r)&&0===t.length?e.unshift(r):t.unshift(r),[t,e]),[[],[]]),n=e.map(t=>[t]),i=n[n.length-1];return null!=i?i.push(...r):r.length>0&&n.push(r),n}function isOptional(t){return invariant(t.length>0),"?"===t[t.length-1]}function clearWorkspaceCaches(){flowPathCache.reset(),flowConfigDirCache.reset(),global.cachedPathToFlowBin=void 0}async function isFlowInstalled(){const t=await getPathToFlow();return flowPathCache.has(t)||flowPathCache.set(t,await canFindFlow(t)),flowPathCache.get(t)}async function canFindFlow(t){try{const{command:e,args:r}=buildSearchFlowCommand(t);return await checkOutput(e,r),!0}catch(t){return!1}}async function getFlowAbsolutePath(t){const{command:e,args:r}=buildSearchFlowCommand(t),n=await asyncExecute(e,r,{});if(0!==n.exitCode)return null;const i="win32"===process.platform?"flow.cmd":"flow",o=n.stdout.split(os.EOL).filter(t=>t.endsWith(i));return 0===o.length?null:o[0]}async function getPathToFlow(){if(!global.cachedPathToFlowBin){const t=global.vscode.workspace.rootPath,e=global.vscode.workspace.getConfiguration("flow"),r=e.get("useNPMPackagedFlow"),n=e.get("pathToFlow").replace("${workspaceRoot}",t),i=nodeModuleFlowLocation(t);if(r&&await canFindFlow(i))global.cachedPathToFlowBin=i;else if(await canFindFlow(n))global.cachedPathToFlowBin=await getFlowAbsolutePath(n);else if(await canFindFlow("flow"))global.cachedPathToFlowBin=await getFlowAbsolutePath("flow");else{const t=path$1__default.resolve(__dirname,"../../../../");global.cachedPathToFlowBin=nodeModuleFlowLocation(t)}logger.info("Path to Flow: "+global.cachedPathToFlowBin)}return global.cachedPathToFlowBin}function nodeModuleFlowLocation(t){return"win32"===process.platform?`${t}\\node_modules\\.bin\\flow.cmd`:`${t}/node_modules/.bin/flow`}function buildSearchFlowCommand(t){if("win32"!==process.platform)return{command:"which",args:[t]};{const e=t.lastIndexOf("\\"),r=t.substring(e+1,t.length),n=t.substring(0,e),i=n?["/r",n,r]:[r];return{command:`${process.env.SYSTEMROOT||"C:\\Windows"}\\System32\\where`,args:i}}}function getStopFlowOnExit(){return!global.vscode||global.vscode.workspace.getConfiguration("flow").get("stopFlowOnExit")}function findFlowConfigDir(t){if(!flowConfigDirCache.has(t)){const e=fsPromise.findNearestFile(".flowconfig",nuclideUri.dirname(t));flowConfigDirCache.set(t,e)}return flowConfigDirCache.get(t)}function flowCoordsToAtomCoords(t){return{start:{line:t.start.line-1,column:t.start.column-1},end:{line:t.end.line-1,column:t.end.column}}}const NODE_NOT_FOUND="[Flow] Cannot find node in PATH. The simplest way to resolve it is install node globally",FLOW_NOT_FOUND="[Flow] Cannot find flow in PATH. Try to install it by npm install flow-bin -g";function isFlowEnabled(){return vscode.workspace.getConfiguration("flow").get("enabled")}function isFlowStatusEnabled(){return vscode.workspace.getConfiguration("flow").get("showStatus")}function shouldShowUncoveredCode(){return vscode.workspace.getConfiguration("flow").get("showUncovered")}function isRunOnEditEnabled(){return vscode.workspace.getConfiguration("flow").get("runOnEdit")}function shouldRunOnAllFiles(){return vscode.workspace.getConfiguration("flow").get("runOnAllFiles")}function getFileExtensions(){return vscode.workspace.getConfiguration("flow").get("fileExtensions")}function getLogLevel(){return vscode.workspace.getConfiguration("flow").get("logLevel")}function useCodeSnippetOnFunctionSuggest(){return vscode.workspace.getConfiguration("flow").get("useCodeSnippetOnFunctionSuggest")}function getTryPath(t){return t.asAbsolutePath("./playground/try.js")}function toURI(t){return vscode.Uri.file(t)}function hasFlowPragma(t){return!!shouldRunOnAllFiles()||/^\s*(\/*\*+|\/\/)\s*@flow/m.test(t)}function checkNode(){try{const t=crossSpawn("win32"===process.platform?"where":"which",["node"]);let e="",r="";t.stdout.on("data",function(t){e+=t.toString()}),t.stderr.on("data",function(t){r+=t.toString()}),t.on("exit",function(t){0!=t&&vscode.window.showErrorMessage(NODE_NOT_FOUND)})}catch(t){vscode.window.showErrorMessage(NODE_NOT_FOUND)}}async function checkFlow(){const t=await getPathToFlow();try{const{command:e,args:r}=buildSearchFlowCommand(t),n=crossSpawn(e,r);let i="",o="";n.stdout.on("data",function(t){i+=t.toString()}),n.stderr.on("data",function(t){o+=t.toString()}),n.on("exit",function(t){0!=t&&vscode.window.showErrorMessage(FLOW_NOT_FOUND)})}catch(t){vscode.window.showErrorMessage(FLOW_NOT_FOUND)}}function format(t){try{return runPrettier(`type t = ${t}`).replace("type t = ","")}catch(e){try{return runPrettier(t)}catch(e){return t}}}function runPrettier(t){return prettier.format(t,{parser:"flow",plugins:[parserFlow],semi:!1,printWidth:60})}var scorer=createCommonjsModule(function(t,e){(function(){var t,r;t=path$1__default.sep,e.basenameScore=function(r,n,i){var o,s,a,c,u;for(s=r.length-1;r[s]===t;)s--;for(u=0,a=s,o=null;s>=0;)r[s]===t?(u++,null==o&&(o=r.substring(s+1,a+1))):0===s&&(a<r.length-1?null==o&&(o=r.substring(0,a+1)):null==o&&(o=r)),s--;return o===r?i*=2:o&&(i+=e.score(o,n)),c=u+1,i*=.01*Math.max(1,10-c)},e.score=function(e,n){var i,o,s,a,c,u,l,h,p,f,b,d;if(e===n)return 1;if(r(e,n))return 1;for(f=0,l=n.length,p=e.length,s=0,a=0;s<l;){if(i=n[s++],c=e.indexOf(i.toLowerCase()),b=e.indexOf(i.toUpperCase()),-1===(u=Math.min(c,b))&&(u=Math.max(c,b)),-1===(a=u))return 0;o=.1,e[a]===i&&(o+=.1),0===a||e[a-1]===t?o+=.8:"-"!==(d=e[a-1])&&"_"!==d&&" "!==d||(o+=.7),e=e.substring(a+1,p),f+=o}return((h=f/l)*(l/p)+h)/2},r=function(e,r){if(e[e.length-r.length-1]===t)return e.lastIndexOf(r)===e.length-r.length}}).call(commonjsGlobal)}),scorer_1=scorer.basenameScore,scorer_2=scorer.score,filter$2=createCommonjsModule(function(t){(function(){var e,r,n;r=scorer,e=function(t){return t.candidate},n=function(t,e){return e.score-t.score},t.exports=function(t,i,o,s){var a,c,u,l,h,p,f,b,d;if(c=(d=null!=s?s:{}).key,u=d.maxResults,i){for(h=[],f=0,b=t.length;f<b;f++)a=t[f],(p=null!=c?a[c]:a)&&(l=r.score(p,i,o),o||(l=r.basenameScore(p,i,l)),l>0&&h.push({candidate:a,score:l}));h.sort(n),t=h.map(e)}return null!=u&&(t=t.slice(0,u)),t}}).call(commonjsGlobal)}),matcher=createCommonjsModule(function(t,e){(function(){var t;t=path$1__default.sep,e.basenameMatch=function(r,n){var i,o,s;for(o=r.length-1;r[o]===t;)o--;for(s=o,i=null;o>=0;)r[o]===t?null==i&&(i=r.substring(o+1,s+1)):0===o&&(s<r.length-1?null==i&&(i=r.substring(0,s+1)):null==i&&(i=r)),o--;return e.match(i,n,r.length-i.length)},e.match=function(t,e,r){var n,i,o,s,a,c,u,l,h,p;if(null==r&&(r=0),t===e)return function(){p=[];for(var e=r,n=r+t.length;r<=n?e<n:e>n;r<=n?e++:e--)p.push(e);return p}.apply(this);for(u=e.length,l=t.length,i=0,o=0,a=[];i<u;){if(n=e[i++],s=t.indexOf(n.toLowerCase()),h=t.indexOf(n.toUpperCase()),-1===(c=Math.min(s,h))&&(c=Math.max(s,h)),-1===(o=c))return[];a.push(r+o),r+=o+1,t=t.substring(o+1,l)}return a}}).call(commonjsGlobal)}),matcher_1=matcher.basenameMatch,matcher_2=matcher.match,fuzzaldrin=createCommonjsModule(function(t){(function(){var e,r,n,i,o;o=scorer,n=filter$2,i=matcher,e=path$1__default.sep,r=/\ /g,t.exports={filter:function(t,i,o){var s;return i&&(s=-1!==i.indexOf(e),i=i.replace(r,"")),n(t,i,s,o)},score:function(t,n){var i,s;return t&&n?t===n?2:(i=-1!==n.indexOf(e),n=n.replace(r,""),s=o.score(t,n),i||(s=o.basenameScore(t,n,s)),s):0},match:function(t,n){var o,s,a,c,u,l;if(!t)return[];if(!n)return[];if(t===n)return function(){l=[];for(var e=0,r=t.length;0<=r?e<r:e>r;0<=r?e++:e--)l.push(e);return l}.apply(this);if(c=-1!==n.indexOf(e),n=n.replace(r,""),a=i.match(t,n),!c)for(o=i.basenameMatch(t,n),a=a.concat(o).sort(function(t,e){return t-e}),u=null,s=0;s<a.length;)s&&u===a[s]?a.splice(s,1):(u=a[s],s++);return a}}}).call(commonjsGlobal)}),fuzzaldrin_1=fuzzaldrin.filter,fuzzaldrin_2=fuzzaldrin.score,fuzzaldrin_3=fuzzaldrin.match;const ServerStatus=Object.freeze({FAILED:"failed",UNKNOWN:"unknown",NOT_RUNNING:"not running",NOT_INSTALLED:"not installed",BUSY:"busy",INIT:"init",READY:"ready"}),VERSION_TIMEOUT_MS=6e5,logger$1=getLogger(),FLOW_RETURN_CODES={ok:0,serverInitializing:1,typeError:2,noServerRunning:6,outOfRetries:7,buildIdMismatch:9,unexpectedArgument:64},SERVER_READY_TIMEOUT_MS=1e4,EXEC_FLOW_RETRIES=5;class FlowProcess{constructor(t){_defineProperty(this,"_startedServer",void 0),_defineProperty(this,"_serverStatus",void 0),_defineProperty(this,"_root",void 0),this._serverStatus=new BehaviorSubject$1(ServerStatus.UNKNOWN),this._root=t,this._serverStatus.subscribe(t=>{logger$1.info(`[${t}]: Flow server in ${this._root}`)}),this._serverStatus.filter(t=>t===ServerStatus.NOT_RUNNING).subscribe(()=>{this._startFlowServer(),this._pingServer()}),this._serverStatus.filter(function(t){return t===ServerStatus.BUSY||t===ServerStatus.INIT}).subscribe(()=>{this._pingServer()})}async dispose(){if(this._serverStatus.complete(),this._startedServer&&getStopFlowOnExit()){this._startedServer.kill("SIGKILL"),safeSpawn(await getPathToFlow(),["stop"],this._getFlowExecOptions())}}allowServerRestart(){this._serverStatus.getValue()===ServerStatus.FAILED&&this._serverStatus.next(ServerStatus.UNKNOWN)}getServerStatusUpdates(){return this._serverStatus.asObservable()}async execFlow(t,e,r=!1,n=!1){const i=r?EXEC_FLOW_RETRIES:0;if(this._serverStatus.getValue()===ServerStatus.FAILED)return null;for(let r=0;;r++)try{return await this._rawExecFlow(t,e)}catch(e){const o=-1!==[ServerStatus.NOT_RUNNING,ServerStatus.INIT,ServerStatus.BUSY].indexOf(this._serverStatus.getValue());if(!(r<i&&o)){if(!o&&!n){const r=await getPathToFlow();logger$1.error(`Flow failed: ${r} ${t.join(" ")}. Error: ${JSON.stringify(e)}`)}throw e}await this._serverIsReady()}return null}async _startFlowServer(){const t=await getPathToFlow(),e=await safeSpawn(t,["server","--from","nuclide","--max-workers",this._getMaxWorkers().toString(),this._root],this._getFlowExecOptions()),r=t=>{const r=e.pid;logger$1.debug(`flow server (${r}): ${t}`)};e.stdout.on("data",r),e.stderr.on("data",r),e.on("exit",(t,e)=>{2===t&&null===e&&(logger$1.error("Flow server unexpectedly exited",this._root),this._setServerStatus(ServerStatus.FAILED))}),this._startedServer=e}async _rawExecFlow(t,e={}){if(!await isFlowInstalled())return this._updateServerStatus(null),null;e={...this._getFlowExecOptions(),...e},t=[...t,"--retry-if-init","false","--retries","0","--no-auto-start"];try{const r=await FlowProcess.execFlowClient(t,e);return this._updateServerStatus(r),r}catch(t){if(this._updateServerStatus(t),t.exitCode===FLOW_RETURN_CODES.typeError)return t;throw t}}_updateServerStatus(t){let e;if(null==t)e=ServerStatus.NOT_INSTALLED;else switch(t.exitCode){case FLOW_RETURN_CODES.ok:case FLOW_RETURN_CODES.typeError:e=ServerStatus.READY;break;case FLOW_RETURN_CODES.serverInitializing:e=ServerStatus.INIT;break;case FLOW_RETURN_CODES.noServerRunning:e=ServerStatus.NOT_RUNNING;break;case FLOW_RETURN_CODES.outOfRetries:e=ServerStatus.BUSY;break;case FLOW_RETURN_CODES.buildIdMismatch:logger$1.info("Killed flow server with incorrect version in",this._root),e=ServerStatus.NOT_RUNNING;break;case FLOW_RETURN_CODES.unexpectedArgument:return;default:logger$1.error(`Unknown return code from Flow: ${String(t.exitCode)}`),e=ServerStatus.UNKNOWN}this._setServerStatus(e)}_setServerStatus(t){const e=this._serverStatus.getValue();t!==e&&e!==ServerStatus.FAILED&&this._serverStatus.next(t)}async _pingServer(t=5){const e=this._serverStatus.getValue();let r=!1;this._serverStatus.filter(t=>t!==e).first().subscribe(()=>{r=!0});for(let e=0;!r&&e<t;e++)await this._rawExecFlow(["status"]).catch(()=>null),await Observable$1.of(null).delay(1e3).toPromise()}_serverIsReady(){return this._serverStatus.filter(t=>t===ServerStatus.READY).map(()=>!0).race(Observable$1.of(!1).delay(SERVER_READY_TIMEOUT_MS)).first(null,null,!1).toPromise()}_getFlowExecOptions(){return{cwd:this._root,env:{OCAMLRUNPARAM:"b",...process.env}}}_getMaxWorkers(){return Math.max(os.cpus().length-2,1)}static async execFlowClient(t,e={}){t=[...t,"--from","nuclide"];const r=await getPathToFlow(),n=await asyncExecute(r,t,e);if(0!==n.exitCode)throw n;return n}}class FlowVersion{constructor(t){_defineProperty(this,"_lastVersion",void 0),_defineProperty(this,"_versionFn",void 0),this._versionFn=t,this._lastVersion=null}invalidateVersion(){this._lastVersion=null}async getVersion(){const t=this._lastVersion;return null==t?await this._queryAndSetVersion():Date.now()-t.receivedTime>=VERSION_TIMEOUT_MS?await this._queryAndSetVersion():t.version}async _queryAndSetVersion(){const t=await this._versionFn();return this._lastVersion={version:t,receivedTime:Date.now()},t}}function arrayCompact(t){const e=[];for(const r of t)null!=r&&e.push(r);return e}function keyword(t){return _buildToken("keyword",t)}function className(t){return _buildToken("class-name",t)}function method(t){return _buildToken("method",t)}function param(t){return _buildToken("param",t)}function string(t){return _buildToken("string",t)}function whitespace(t){return _buildToken("whitespace",t)}function plain(t){return _buildToken("plain",t)}function type(t){return _buildToken("type",t)}function _buildToken(t,e){return{kind:t,value:e}}function astToOutline(t){return itemsToTrees(t.body)}function itemsToTrees(t){return arrayCompact(t.map(itemToTree))}function itemToTree(t){if(null==t)return null;const e=getExtent(t);switch(t.type){case"FunctionDeclaration":return{tokenizedText:[keyword("function"),whitespace(" "),method(t.id.name),plain("("),...paramsTokenizedText(t.params),plain(")")],representativeName:t.id.name,children:[],...e};case"ClassDeclaration":return{tokenizedText:[keyword("class"),whitespace(" "),className(t.id.name)],representativeName:t.id.name,children:itemsToTrees(t.body.body),...e};case"ClassProperty":let r=[];return t.value&&"ArrowFunctionExpression"===t.value.type&&(r=[plain("("),...paramsTokenizedText(t.value.params),plain(")")]),{tokenizedText:[method(t.key.name),plain("="),...r],representativeName:t.key.name,children:[],...e};case"MethodDefinition":return{tokenizedText:[method(t.key.name),plain("("),...paramsTokenizedText(t.value.params),plain(")")],representativeName:t.key.name,children:[],...e};case"ExportDeclaration":const n=itemToTree(t.declaration);return null==n?null:{tokenizedText:[keyword("export"),whitespace(" "),...n.tokenizedText],representativeName:n.representativeName,children:n.children,...e};case"ExpressionStatement":return topLevelExpressionOutline(t);case"TypeAlias":return typeAliasOutline(t);default:return null}}function paramsTokenizedText(t){const e=[];return t.forEach((r,n)=>{switch(r.type){case"Identifier":e.push(param(r.name));break;case"ObjectPattern":e.push(plain("{")),e.push(...paramsTokenizedText(r.properties.map(t=>t.key))),e.push(plain("}"));break;case"ArrayPattern":e.push(plain("[")),e.push(...paramsTokenizedText(r.elements)),e.push(plain("]"));break;default:throw new Error(`encountered unexpected argument type ${r.type}`)}n<t.length-1&&(e.push(plain(",")),e.push(whitespace(" ")))}),e}function getExtent(t){return{startPosition:{line:t.loc.start.line-1,column:t.loc.start.column},endPosition:{line:t.loc.end.line-1,column:t.loc.end.column}}}function typeAliasOutline(t){invariant("TypeAlias"===t.type);const e=t.id.name;return{tokenizedText:[keyword("type"),whitespace(" "),type(e)],representativeName:e,children:[],...getExtent(t)}}function topLevelExpressionOutline(t){switch(t.expression.type){case"CallExpression":return specOutline(t,!0);case"AssignmentExpression":return moduleExportsOutline(t.expression);default:return null}}function moduleExportsOutline(t){if(invariant("AssignmentExpression"===t.type),!isModuleExports(t.left))return null;const e=t.right;if("ObjectExpression"!==e.type)return null;const r=e.properties;return{tokenizedText:[plain("module.exports")],children:arrayCompact(r.map(moduleExportsPropertyOutline)),...getExtent(t)}}function isModuleExports(t){return"MemberExpression"===t.type&&"Identifier"===t.object.type&&"module"===t.object.name&&"Identifier"===t.property.type&&"exports"===t.property.name}function moduleExportsPropertyOutline(t){if(invariant("Property"===t.type),"Identifier"!==t.key.type)return null;const e=t.key.name;return t.shorthand?{tokenizedText:[string(e)],representativeName:e,children:[],...getExtent(t)}:"FunctionExpression"===t.value.type||"ArrowFunctionExpression"===t.value.type?{tokenizedText:[method(e),plain("("),...paramsTokenizedText(t.value.params),plain(")")],representativeName:e,children:[],...getExtent(t)}:{tokenizedText:[string(e),plain(":")],representativeName:e,children:[],...getExtent(t)}}function specOutline(t,e=!1){const r=t.expression;if("CallExpression"!==r.type)return null;const n=getFunctionName(r.callee);if(null==n)return null;if(!isDescribe(n)&&(e||!isIt(n)))return null;const i=getStringLiteralValue(r.arguments[0]),o=getFunctionBody(r.arguments[1]);if(null==i||null==o)return null;let s;return s=isIt(n)?[]:arrayCompact(o.filter(t=>"ExpressionStatement"===t.type).map(t=>specOutline(t))),{tokenizedText:[method(n),whitespace(" "),string(i)],representativeName:i,children:s,...getExtent(t)}}function getFunctionName(t){switch(t.type){case"Identifier":return t.name;case"MemberExpression":return"Identifier"!==t.object.type||"Identifier"!==t.property.type?null:`${t.object.name}.${t.property.name}`;default:return null}}function isDescribe(t){switch(t){case"describe":case"fdescribe":case"ddescribe":case"xdescribe":case"describe.only":return!0;default:return!1}}function isIt(t){switch(t){case"it":case"fit":case"iit":case"pit":case"xit":case"it.only":return!0;default:return!1}}function getStringLiteralValue(t){if(null==t)return null;if("Literal"!==t.type)return null;const e=t.value;return"string"!=typeof e?null:e}function getFunctionBody(t){return null==t?null:"ArrowFunctionExpression"!==t.type&&"FunctionExpression"!==t.type?null:t.body.body}function flowStatusOutputToDiagnostics(t,e){return null!=e.flowVersion?newFlowStatusOutputToDiagnostics(t,e):oldFlowStatusOutputToDiagnostics(t,e)}function oldFlowStatusOutputToDiagnostics(t,e){return{flowRoot:t,messages:e.errors.map(t=>{const e=t.message,r=e[0].level,n=e.map(flowMessageComponentToMessageComponent),i=t.operation;if(null!=i){const t=flowMessageComponentToMessageComponent(i);t.descr="See also: "+t.descr,n.push(t)}return{level:r,messageComponents:n}})}}function flowMessageComponentToMessageComponent(t){const e=t.path;let r=null;return null!=e&&""!==e&&(r={file:e,start:{line:t.line,column:t.start},end:{line:t.endline,column:t.end}}),{descr:t.descr,range:r}}function newFlowStatusOutputToDiagnostics(t,e){return{flowRoot:t,messages:e.errors.map(t=>{const e=t.message,r=t.level,n=e.map(newFlowMessageComponentToMessageComponent),i=t.operation;if(null!=i){const t=newFlowMessageComponentToMessageComponent(i);t.descr="See also: "+t.descr,n.push(t)}const o=t.extra;if(null!=o){const t=[].concat(...o.map(({message:t})=>t));n.push(...t.map(newFlowMessageComponentToMessageComponent))}return{level:r,messageComponents:n}})}}function newFlowMessageComponentToMessageComponent(t){return{descr:t.descr,range:maybeFlowLocToRange(t.loc)}}function maybeFlowLocToRange(t){return null==t?null:flowLocToRange(t)}function flowLocToRange(t){return{file:t.source,start:{line:t.start.line,column:t.start.column},end:{line:t.end.line,column:t.end.column}}}const logger$2=getLogger();class FlowRoot{constructor(t){_defineProperty(this,"_root",void 0),_defineProperty(this,"_process",void 0),_defineProperty(this,"_version",void 0),this._root=t,this._process=new FlowProcess(t),this._version=new FlowVersion(()=>this._flowGetVersion()),this._process.getServerStatusUpdates().filter(t=>"not running"===t).subscribe(()=>this._version.invalidateVersion())}dispose(){this._process.dispose()}allowServerRestart(){this._process.allowServerRestart()}getPathToRoot(){return this._root}getServerStatusUpdates(){return this._process.getServerStatusUpdates()}async flowFindDefinition(t,e,r,n){const i={};i.stdin=e;const o=["get-def","--json","--path",t,r,n];try{const t=await this._process.execFlow(o,i);if(!t)return null;const e=parseJSON(o,t.stdout);return e.path?{file:e.path,point:{line:e.line-1,column:e.start-1}}:null}catch(t){return null}}async flowFindDiagnostics(t,e){await this._forceRecheck(t);const r={};let n,i,o;e?(r.stdin=e,n=["check-contents","--json",t]):n=["status","--json",t];try{if(!(i=await this._process.execFlow(n,r,!0)))return null}catch(t){if(void 0===t.exitCode)return logger$2.error(t),null;i=t}try{o=parseJSON(n,i.stdout)}catch(t){return null}return flowStatusOutputToDiagnostics(this._root,o)}async flowGetAutocompleteSuggestions(t,e,r,n,i,o){const s=-1!==i.indexOf("."),a=/^[\s.]*$/.test(i)?"":i;if(!o&&!s&&a.length<1)return[];const c={},u=["autocomplete","--json",t];c.stdin=insertAutocompleteToken(e,r,n);try{const t=await this._process.execFlow(u,c);if(!t)return[];const e=parseJSON(u,t.stdout);let r;const n=(r=Array.isArray(e)?e:e.result).map(t=>processAutocompleteItem(a,t));return fuzzaldrin_1(n,a,{key:"displayText"})}catch(t){return[]}}async flowGetType(t,e,r,n,i){const o={};o.stdin=e;const s=["type-at-pos","--json","--path",t,++r,++n];let a,c;i&&s.push("--raw");try{const t=await this._process.execFlow(s,o);if(!t)return null;""===(a=t.stdout)&&(a=t.stderr)}catch(t){return null}try{c=parseJSON(s,a)}catch(t){return null}const u=c.type,l=c.raw_type;return u&&"(unknown)"!==u&&""!==u?{type:u,rawType:l}:(""===u&&logger$2.error("Received empty type hint from `flow type-at-pos`"),null)}async flowGetCoverage(t){const e=await this._version.getVersion();return null==e||semver.lte(e,"0.27.0")?await this._getCoverageViaDumpTypes(t):await this._getCoverageViaCoverage(t)}async _getCoverageViaDumpTypes(t){const e=["dump-types","--json",t];let r,n;try{r=await this._process.execFlow(e,{})}catch(t){return null}if(null==r)return null;try{n=parseJSON(e,r.stdout)}catch(t){return null}const i=n,o=i.filter(t=>""===t.type||"any"===t.type),s=o.map(t=>flowCoordsToAtomCoords(t.loc)),a=o.length,c=i.length;return{percentage:0===c?100:(c-a)/c*100,uncoveredRanges:s}}async _getCoverageViaCoverage(t){const e=["coverage","--json",t];let r,n;try{r=await this._process.execFlow(e,{})}catch(t){return null}if(null==r)return null;try{n=parseJSON(e,r.stdout)}catch(t){return null}const i=n.expressions,o=i.uncovered_count,s=i.covered_count,a=o+s;return{percentage:0===a?100:s/a*100,uncoveredRanges:i.uncovered_locs.map(flowCoordsToAtomCoords)}}async _forceRecheck(t){try{return await this._process.execFlow(["force-recheck",t],{},!1,!0),!0}catch(t){return!1}}async _flowGetVersion(){const t=["version","--json"];let e;try{const r=await FlowProcess.execFlowClient(t);if(null==r)return null;e=parseJSON(t,r.stdout)}catch(t){return logger$2.warn(t),null}return e.semver}static async flowGetOutline(t){const e={stdin:t},r=["ast"];let n;try{const t=await FlowProcess.execFlowClient(r,e);if(null==t)return null;n=parseJSON(r,t.stdout)}catch(t){return logger$2.warn(t),null}try{return astToOutline(n)}catch(t){return logger$2.error(t),null}}}function parseJSON(t,e){try{return JSON.parse(e)}catch(r){throw logger$2.error(`Invalid JSON result from flow ${t.join(" ")}. JSON:\n'${e}'.`),r}}class FlowRootContainer{constructor(){_defineProperty(this,"_flowRootMap",void 0),_defineProperty(this,"_flowRoot$",void 0),_defineProperty(this,"_disposed",void 0),this._disposed=!1,this._flowRootMap=new Map,this._flowRoot$=new Subject$1,this._flowRoot$.subscribe(t=>{this._flowRootMap.set(t.getPathToRoot(),t)})}async getRootForPath(t){this._checkForDisposal();const e=await findFlowConfigDir(t);if(null==e||this._disposed)return null;let r=this._flowRootMap.get(e);return r||(r=new FlowRoot(e),this._flowRoot$.next(r)),r}async runWithRoot(t,e){this._checkForDisposal();const r=await this.getRootForPath(t);return null==r?null:await e(r)}getAllRoots(){return this._checkForDisposal(),this._flowRootMap.values()}getServerStatusUpdates(){return this._checkForDisposal(),this._flowRoot$.flatMap(t=>{const e=t.getPathToRoot();return t.getServerStatusUpdates().map(t=>({pathToRoot:e,status:t}))})}dispose(){this._checkForDisposal(),this._flowRootMap.forEach(t=>t.dispose()),this._flowRootMap.clear(),this._disposed=!0}_checkForDisposal(){invariant(!this._disposed,"Method called on disposed FlowRootContainer")}}let rootContainer=null;function getRootContainer(){return null==rootContainer&&(rootContainer=new FlowRootContainer),rootContainer}function flowFindDefinition(t,e,r,n){return getRootContainer().runWithRoot(t,i=>i.flowFindDefinition(t,e,r,n))}function flowFindDiagnostics(t,e){return getRootContainer().runWithRoot(t,r=>r.flowFindDiagnostics(t,e))}function flowGetAutocompleteSuggestions(t,e,r,n,i,o){return getRootContainer().runWithRoot(t,s=>s.flowGetAutocompleteSuggestions(t,e,r,n,i,o))}async function flowGetType(t,e,r,n,i){return getRootContainer().runWithRoot(t,o=>o.flowGetType(t,e,r,n,i))}async function flowGetCoverage(t){return getRootContainer().runWithRoot(t,e=>e.flowGetCoverage(t))}class CompletionSupport{async provideCompletionItems(t,e,r){const n=t.uri.fsPath,i=t.getText(),o=e.line,s=e.character,a=await flowGetAutocompleteSuggestions(n,i,o,s,".",!0);return a?a.map(t=>{const e=new vscode.CompletionItem(t.displayText);return t.description&&(e.detail=t.description),e.kind=this.typeToKind(t.type,t.description),e.kind===vscode.CompletionItemKind.Function&&useCodeSnippetOnFunctionSuggest()&&(e.insertText=new vscode.SnippetString(t.snippet)),e}):[]}typeToKind(t,e){return"function"===t?vscode.CompletionItemKind.Function:e&&e.indexOf("[class: ")>=0?vscode.CompletionItemKind.Class:vscode.CompletionItemKind.Variable}}class HoverSupport{async provideHover(t,e){const r=t.uri.fsPath,n=t.getWordRangeAtPosition(e);if(!n)return;const i=t.getText(n),o=t.getText(),s=e.line,a=e.character,c=await flowGetType(r,o,s,a,!1);if(c){const t=format(c.type);return new vscode.Hover(["[Flow]",{language:"javascript",value:`${i}: ${t}`}])}}}function normalizeLineNumber(t){return t<0?0:t}class DeclarationSupport{async provideDefinition(t,e,r){const n=t.uri.fsPath,i=t.getText(),o=t.getWordRangeAtPosition(e);if(o){const t=o.start.line+1,e=o.start.character+1,r=await flowFindDefinition(n,i,t,e);if(r){const t=new vscode.Range(normalizeLineNumber(r.point.line),r.point.column,normalizeLineNumber(r.point.line),r.point.column),e=vscode.Uri.file(r.file);return new vscode.Location(e,t)}}return null}}var frames="win32"===process.platform?["-","\\","|","/"]:["","","","","","","","","",""],elegantSpinner=function(){var t=0;return function(){return frames[t=++t%frames.length]}},frames_1=frames;elegantSpinner.frames=frames_1;class Status{static createStatusBarItem(){const t=vscode.window.createStatusBarItem(vscode.StatusBarAlignment.Left);return t.tooltip="Flow is type checking",t.command="flow.show-output",t}static render(t){return t.render()}constructor(){_defineProperty(this,"statusBarItem",void 0),_defineProperty(this,"state",void 0),this.statusBarItem=Status.createStatusBarItem()}isBusy(){return null!=this.state}idle(){this.update(!1)}busy(){this.update(isFlowStatusEnabled())}update(t){const{state:e}=this;e&&!t&&(clearInterval(e.id),this.state=null),!e&&t&&(this.state={id:setInterval(Status.render,100,this)}),e!=this.state&&this.render()}render(){this.isBusy()?(this.statusBarItem.show(),this.statusBarItem.text=`Flow: ${Status.spin()}`):(this.statusBarItem.hide(),this.statusBarItem.text="")}}_defineProperty(Status,"spin",elegantSpinner());let lastDiagnostics=null;class Coverage{static createStatusBarItem(){const t=vscode.window.createStatusBarItem(vscode.StatusBarAlignment.Left);return t.tooltip="Flow type coverage. Click to toggle uncovered code",t.command="flow.show-coverage",t}constructor(){_defineProperty(this,"coverageStatus",void 0),_defineProperty(this,"state",void 0),this.coverageStatus=Coverage.createStatusBarItem(),this.state={showUncovered:shouldShowUncoveredCode(),uri:null},vscode.commands.registerCommand("flow.show-coverage",()=>{this.setState({showUncovered:!this.state.showUncovered})})}setState(t){this.state=Object.assign({},this.state,t),this.render()}update(t){this.setState({uri:t})}applyDiagnostics(t,e){lastDiagnostics&&lastDiagnostics.dispose(),lastDiagnostics=vscode.languages.createDiagnosticCollection();const{uncoveredRanges:r}=t,n=r.map(t=>{const e=new vscode.Range(t.start.line,t.start.column,t.end.line,t.end.column),r=new vscode.Diagnostic(e,"uncovered code",vscode.DiagnosticSeverity.Information);return r.source="flow coverage",r});this.state.showUncovered&&lastDiagnostics.set(e,n)}async render(){const{uri:t}=this.state;if(!t)return null;this.coverageStatus.show();try{const e=await flowGetCoverage(t.fsPath);if(e){const r="number"==typeof e.percentage&&e.percentage.toFixed(1);this.coverageStatus.text=`Flow: ${r.toString()}%`,this.applyDiagnostics(e,t)}}catch(t){this.coverageStatus.text=""}}}var FUNC_ERROR_TEXT="Expected a function",NAN=NaN,symbolTag="[object Symbol]",reTrim=/^\s+|\s+$/g,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt,freeGlobal="object"==typeof commonjsGlobal&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root$1=freeGlobal||freeSelf||Function("return this")(),objectProto=Object.prototype,objectToString=objectProto.toString,nativeMax=Math.max,nativeMin=Math.min,now=function(){return root$1.Date.now()};function debounce$1(t,e,r){var n,i,o,s,a,c,u=0,l=!1,h=!1,p=!0;if("function"!=typeof t)throw new TypeError(FUNC_ERROR_TEXT);function f(e){var r=n,o=i;return n=i=void 0,u=e,s=t.apply(o,r)}function b(t){var r=t-c;return void 0===c||r>=e||r<0||h&&t-u>=o}function d(){var t=now();if(b(t))return m(t);a=setTimeout(d,function(t){var r=e-(t-c);return h?nativeMin(r,o-(t-u)):r}(t))}function m(t){return a=void 0,p&&n?f(t):(n=i=void 0,s)}function v(){var t=now(),r=b(t);if(n=arguments,i=this,c=t,r){if(void 0===a)return function(t){return u=t,a=setTimeout(d,e),l?f(t):s}(c);if(h)return a=setTimeout(d,e),f(c)}return void 0===a&&(a=setTimeout(d,e)),s}return e=toNumber(e)||0,isObject$1(r)&&(l=!!r.leading,o=(h="maxWait"in r)?nativeMax(toNumber(r.maxWait)||0,e):o,p="trailing"in r?!!r.trailing:p),v.cancel=function(){void 0!==a&&clearTimeout(a),u=0,n=c=i=a=void 0},v.flush=function(){return void 0===a?s:m(now())},v}function isObject$1(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function isObjectLike(t){return!!t&&"object"==typeof t}function isSymbol(t){return"symbol"==typeof t||isObjectLike(t)&&objectToString.call(t)==symbolTag}function toNumber(t){if("number"==typeof t)return t;if(isSymbol(t))return NAN;if(isObject$1(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=isObject$1(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(reTrim,"");var r=reIsBinary.test(t);return r||reIsOctal.test(t)?freeParseInt(t.slice(2),r?2:8):reIsBadHex.test(t)?NAN:+t}var lodash_debounce=debounce$1;const ON_CHANGE_TEXT_TIMEOUT=500,status=new Status,coverage=new Coverage;let lastDiagnostics$1=null;function setupDiagnostics(t){const{subscriptions:e}=t,r=lodash_debounce(updateDiagnostics,ON_CHANGE_TEXT_TIMEOUT);vscode.window.activeTextEditor&&hasFlowPragma(vscode.window.activeTextEditor.document.getText())&&r(t,vscode.window.activeTextEditor.document),e.push(vscode.window.onDidChangeActiveTextEditor(e=>{e&&hasFlowPragma(e.document.getText())&&r(t,e.document)})),e.push(vscode.workspace.onDidSaveTextDocument(e=>{vscode.window.activeTextEditor&&hasFlowPragma(vscode.window.activeTextEditor.document.getText())&&r(t,vscode.window.activeTextEditor.document)})),e.push(vscode.workspace.onDidChangeTextDocument(e=>{const{activeTextEditor:n}=vscode.window;n&&n.document.fileName===e.document.fileName&&isRunOnEditEnabled()&&hasFlowPragma(e.document.getText())&&r(t,e.document)}))}const pendingDiagnostics=new Map;function updateDiagnostics(t,e){const{uri:r,version:n}=e;if("file"!==r.scheme)return;const i=r.toString(),o=pendingDiagnostics.get(i);null==o?requestDiagnostics(t,e):o!==n&&(abortDiagnostics(i),requestDiagnostics(t,e))}function abortDiagnostics(t){pendingDiagnostics.has(t)&&pendingDiagnostics.delete(t),0===pendingDiagnostics.size&&status.idle()}async function requestDiagnostics(t,e){const{uri:r,version:n}=e,i=r.toString();pendingDiagnostics.set(i,n),pendingDiagnostics.size>0&&status.busy();try{let r=await getDocumentDiagnostics(t,e);pendingDiagnostics.get(i)===n&&applyDiagnostics(r)}catch(t){console.error(t)}status.idle(),coverage.update(e.uri),pendingDiagnostics.get(i)===n&&pendingDiagnostics.delete(i),0===pendingDiagnostics.size&&status.idle()}async function getDocumentDiagnostics(t,e){return e.isUntitled?getDraftDocumentDiagnostics(t,e):e.isDirty?getDirtyDocumentDiagnostics(t,e):getSavedDocumentDiagnostics(t,e)}const noDiagnostics=Object.create(null);async function getFileDiagnostics(t,e,r=toURI){if(-1===getFileExtensions().indexOf(path$1.extname(t)))return noDiagnostics;let n=await flowFindDiagnostics(t,e);if(n&&n.messages){const{flowRoot:t,messages:e}=n,i=Object.create(null);return e.forEach(e=>{const{level:n,messageComponents:o}=e;if(!o.length)return;const[s,...a]=o,c=s.range;if(null==c)return;const u=path$1.resolve(t,c.file),l=r(u);let h={severity:n,startLine:c.start.line,startCol:c.start.column,endLine:c.end.line,endCol:c.end.column,msg:""},p=[];a.forEach(t=>{let e=t.descr;e&&"null"!==e&&"undefined"!==e&&p.push(e)});let f=s.descr;p.length&&(f=`${f} (${p.join(" ")})`),h.msg=f,i[u]||(i[u]={uri:l,reports:[]}),i[u].reports.push(h)}),i}return noDiagnostics}const supportedLanguages=new Set(["javascript","javascriptreact"]);async function getDraftDocumentDiagnostics(t,e){if(supportedLanguages.has(e.languageId)){const r=e.getText(),n=getTryPath(t),i=e.uri;return getFileDiagnostics(n,r,t=>i)}return noDiagnostics}async function getDirtyDocumentDiagnostics(t,e){return getFileDiagnostics(e.uri.fsPath,e.getText())}async function getSavedDocumentDiagnostics(t,e){return getFileDiagnostics(e.uri.fsPath,null)}function mapSeverity(t){switch(t){case"error":return vscode.DiagnosticSeverity.Error;case"warning":return vscode.DiagnosticSeverity.Warning;default:return vscode.DiagnosticSeverity.Error}}function applyDiagnostics(t){lastDiagnostics$1&&lastDiagnostics$1.dispose(),lastDiagnostics$1=vscode.languages.createDiagnosticCollection();for(let e in t){const{uri:r,reports:n}=t[e],i=n.map(t=>{const e=Math.max(0,t.startLine-1),n=Math.max(0,t.endLine-1),i=new vscode.Range(e,t.startCol-1,n,t.endCol),o=(new vscode.Location(r,i),new vscode.Diagnostic(i,t.msg,mapSeverity(t.severity)));return o.source="flow",o});lastDiagnostics$1.set(r,i)}}function setupLogging(t){const e=getOutputChannel();t.subscriptions.push(e)}const languages=[{language:"javascript",scheme:"file"},{language:"javascriptreact",scheme:"file"}];function activate(t){isFlowEnabled()&&(global.vscode=vscode,setupLogging(t),checkNode(),checkFlow(),languages.forEach(e=>{t.subscriptions.push(vscode.languages.registerHoverProvider(e,new HoverSupport)),t.subscriptions.push(vscode.languages.registerDefinitionProvider(e,new DeclarationSupport)),t.subscriptions.push(vscode.languages.registerCompletionItemProvider(e,new CompletionSupport,"."))}),setupDiagnostics(t))}vscode.workspace.onDidChangeConfiguration(t=>{clearWorkspaceCaches()}),exports.activate=activate;
//# sourceMappingURL=flowNonLSP.js.map
